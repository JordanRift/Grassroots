/*
 *
 * Wijmo Library 1.5.0
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the Wijmo Commercial or GNU GPL Version 3 licenses.
 * licensing@wijmo.com
 * http://wijmo.com/license
 *
 *
 **/
(function(a){"use strict";a.widget("wijmo.wijpager",{options:{firstPageClass:"ui-icon-seek-first",firstPageText:"First",lastPageClass:"ui-icon-seek-end",lastPageText:"Last",mode:"numeric",nextPageClass:"ui-icon-seek-next",nextPageText:"Next",pageButtonCount:10,previousPageClass:"ui-icon-seek-prev",previousPageText:"Previous",pageCount:1,pageIndex:0,pageIndexChanging:null,pageIndexChanged:null},_create:function(){this.element.addClass("ui-widget wijmo-wijpager ui-helper-clearfix");this.options.disabled&&this.disable();this._refresh()},_init:function(){},destroy:function(){this.element.removeClass("ui-widget wijmo-wijpager ui-helper-clearfix");this.$ul.remove();a.Widget.prototype.destroy.apply(this,arguments)},_setOption:function(){a.Widget.prototype._setOption.apply(this,arguments);this._refresh()},_refresh:function(){this._validate();this.$ul&&this.$ul.remove();this.element.append(this.$ul=a('<ul class="ui-list ui-corner-all ui-widget-content ui-helper-clearfix" role="tablist"></ul>'));switch((this.options.mode||"").toLowerCase()){case"nextprevious":this._createNextPrev(false);break;case"nextpreviousfirstlast":this._createNextPrev(true);break;case"numeric":this._createNumeric(false);break;case"numericfirstlast":this._createNumeric(true)}},_validate:function(){var a=this.options;if(isNaN(a.pageCount)||a.pageCount<1)a.pageCount=1;if(isNaN(a.pageIndex)||a.pageIndex<0)a.pageIndex=0;else if(a.pageIndex>=a.pageCount)a.pageIndex=a.pageCount-1;if(isNaN(a.pageButtonCount)||a.pageButtonCount<1)a.pageButtonCount=1},_createNextPrev:function(b){var a=this.options;b&&a.pageIndex&&this.$ul.append(this._createPagerItem(false,a.firstPageText,1,a.firstPageClass));a.pageIndex&&this.$ul.append(this._createPagerItem(false,a.previousPageText,a.pageIndex,a.previousPageClass));a.pageIndex+1<a.pageCount&&this.$ul.append(this._createPagerItem(false,a.nextPageText,a.pageIndex+2,a.nextPageClass));b&&a.pageIndex+1<a.pageCount&&this.$ul.append(this._createPagerItem(false,a.lastPageText,a.pageCount,a.lastPageClass))},_createNumeric:function(e){var a=this.options,f=a.pageIndex+1,c=1,b=Math.min(a.pageCount,a.pageButtonCount),d;if(f>b){c=Math.floor(a.pageIndex/a.pageButtonCount)*a.pageButtonCount+1;b=c+a.pageButtonCount-1;b=Math.min(b,a.pageCount);if(b-c+1<a.pageButtonCount)c=Math.max(1,b-a.pageButtonCount+1)}if(c!==1){e&&this.$ul.append(this._createPagerItem(false,a.firstPageText,1,a.firstPageClass));this.$ul.append(this._createPagerItem(false,"...",c-1,""))}for(d=c;d<=b;d++)this.$ul.append(this._createPagerItem(d===f,d.toString(),d,""));if(a.pageCount>b){this.$ul.append(this._createPagerItem(false,"...",b+1,""));e&&this.$ul.append(this._createPagerItem(false,a.lastPageText,a.pageCount,a.lastPageClass))}},_createPagerItem:function(f,d,g,e){var b,c=a("<li />").addClass("ui-page ui-corner-all").attr({role:"tab","aria-label":d,title:d});if(f)c.addClass("ui-state-active").attr("aria-selected","true");else c.addClass("ui-state-default").hover(function(){a(this).removeClass("ui-state-default").addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover").addClass("ui-state-default")}).bind("click."+this.widgetName,{newPageIndex:g-1},a.proxy(this._onClick,this));if(f)b=a("<span />");else b=e?a("<span />").addClass("ui-icon "+e):a("<a/>").attr("href","#");b.text(d);c.append(b);return c},_onClick:function(b){if(this.options.disabled)return false;var a={newPageIndex:b.data.newPageIndex,handled:false};if(this._trigger("pageIndexChanging",null,a)!==false)if(this.options.pageIndex!==a.newPageIndex){this.options.pageIndex=a.newPageIndex;!a.handled&&this._refresh();this._trigger("pageIndexChanged",null,{newPageIndex:a.newPageIndex})}return false}})})(jQuery);
(function(a){"use strict";a.fn.extend({wijtextselection:function(){var c,e,g=this[0],d=this.val();if(arguments.length===0){var b,i,f,h;if(a.browser.msie){var k=document.selection;if(g.tagName.toLowerCase()!="textarea"){b=k.createRange().duplicate();b.moveEnd("character",d.length);f=b.text==""?d.length:d.lastIndexOf(b.text);b=k.createRange().duplicate();b.moveStart("character",-d.length);h=b.text.length}else{b=k.createRange();i=b.duplicate();i.moveToElementText(g);i.setEndPoint("EndToEnd",b);f=i.text.length-b.text.length,h=f+b.text.length}}else{f=g.selectionStart;h=g.selectionEnd}var m=d.substring(f,h);return{start:f,end:h,text:m,replace:function(a){return d.substring(0,f)+a+d.substring(h,d.length)}}}else if(arguments.length===1){if(typeof arguments[0]==="object"&&typeof arguments[0].start==="number"&&typeof arguments[0].end==="number"){c=arguments[0].start;e=arguments[0].end}else if(typeof arguments[0]==="string"){if((c=d.indexOf(arguments[0]))>-1)e=c+arguments[0].length}else if(Object.prototype.toString.call(arguments[0])==="[object RegExp]"){var l=arguments[0].exec(d);if(l!=null){c=l.index;e=c+l[0].length}}}else if(arguments.length===2)if(typeof arguments[0]==="number"&&typeof arguments[1]==="number"){c=arguments[0];e=arguments[1]}if(typeof c==="undefined"){c=0;e=d.length}if(a.browser.msie){var j=g.createTextRange();j.collapse(true);j.moveStart("character",c);j.moveEnd("character",e-c);j.select()}else{g.selectionStart=c;g.selectionEnd=e}}})})(jQuery);
(function(a){"use strict";var c,b,d;c=function(b){var a=this;a.data={};a.reader=null;a.proxy=null;a.items=[];a.loading=null;a.loaded=null;a._constructor(b)};window.wijdatasource=c;a.extend(c.prototype,{_constructor:function(b){a.extend(this,b)},load:function(c,e){var b=this,d=b.proxy;a.isFunction(b.loading)&&b.loading(b,c);if(d)d.request(b,b.loaded,c);else{(b.items.length===0||e)&&this.read();a.isFunction(b.loaded)&&b.loaded(b,c)}},read:function(){var a=this,b=a.data;if(b&&a.reader)a.reader.read(a);else a.items=a.data}});b=function(b){if(a.isArray(b))this.fields=b};window.wijarrayreader=b;a.extend(b.prototype,{read:function(b){if(a.isArray(b.data))b.items=this._map(b.data);else b.items=[]},_map:function(d){var c=this,b=[];if(c.fields===undefined||c.fields.length===0){a.extend(true,b,d);return b}else a.each(d,function(f,d){var e={};a.each(c.fields,function(g,b){if(a.isFunction(b.mapping)){e[b.name]=b.mapping(d);return true}var f=b.mapping!==undefined?b.mapping:b.name,c=d[f];if(c===undefined)if(b.defaultValue!==undefined)c=b.defaultValue;else c=d;e[b.name]=c});b.push(e)});return b}});d=function(a){this.options=a};window.wijhttpproxy=d;a.extend(d.prototype,{request:function(d,e,f){var g=this,b=a.extend({},this.options),c=b.success;b.success=function(h){a.isFunction(c)&&c(h);g._complete(h,d,e,b,f)};a.ajax(b)},_complete:function(e,b,c,d,f){b.data=d.key!==undefined?e[d.key]:e;b.read();a.isFunction(c)&&c(b,f)}})})(jQuery);
(function(a){"use strict";var g="wijmo-wijcombobox-input",c="ui-state-hover",d="ui-state-active",b="ui-state-focus",f="ui-corner-left",e="ui-corner-right",h="<div class='wijmo-wijcombobox-trigger ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-s'></span></div>",i="<label class='wijmo-wijcombobox-label ui-widget-content'></label>";a.widget("wijmo.wijcombobox",{options:{data:null,labelText:null,minLength:4,delay:300,showingAnimation:null,hidingAnimation:null,showTrigger:true,triggerPosition:"right",dropdownHeight:300,dropdownWidth:"auto",selectOnItemFocus:false,autoFilter:true,autoComplete:true,highlightMatching:true,dropDownListPosition:{},columns:[],selectionMode:"single",multipleSelectionSeparator:",",forceSelectionText:false,select:null,isEditable:true,selectedIndex:-1,open:null,close:null,selectElementWidthFix:6,search:null,changed:null,listOptions:null},_create:function(){var a=this;a.selectedItem=null;a.selectedItems=[];a._createDOMElements();a._bindInputEvents();a._initDropDownList();a.repaint();a._checkSelectIndex()},_checkSelectIndex:function(){var c=this,b;b=c.options.selectedIndex;!c._usingRemoteData()&&(b>=0||a.isArray(b))&&c.search(null,"checkindex")},repaint:function(){var a=this;if(a.element.is(":visible")||a._comboDiv||a._select!==undefined&&a._input.is(":visible")){a._showTrigger();a.options.disabled&&a.disable();return true}return false},_bindInputEvents:function(){var c=this,e,f,g,d;e=c._input;f=c.options;e.bind("keydown.wijcombobox",function(b){if(f.disabled===true)return;g=b.keyCode;d=a.ui.keyCode;switch(g){case d.UP:c._move("previous",b);b.preventDefault();break;case d.DOWN:c._move("next",b);b.preventDefault();break;case d.ENTER:if(c.menu.active){b.preventDefault();c.menu.select(b)}break;case d.TAB:e.trigger("wijcomboblur");if(!c.menu.active||f.selectionMode==="multiple"&&d.TAB===g)return;c.menu.select(b);var h=e.val().length;c._selectText(h,h,e);break;case d.ESCAPE:c.close(b);break;case d.LEFT:case d.RIGHT:case d.SHIFT:case d.CONTROL:case d.HOME:case d.END:case d.DELETE:case d.PAGE_UP:case d.PAGE_DOWN:break;case 18:e.trigger("wijcomboblur");break;default:window.clearTimeout(c.searching);if(f.isEditable===false){if(c._cacheKey===undefined)c._cacheKey="";c._cacheKey+=String.fromCharCode(g)}c.searching=window.setTimeout(function(){var a;if(f.isEditable===false){a=c._cacheKey;c._cacheKey=undefined}else a=e.val();c.search(a,b)},f.delay)}}).bind("wijcomboblur.wijcombobox",function(a){window.clearTimeout(c.searching);c._addInputFocus(false,b);c.closing=window.setTimeout(function(){c.close(a,true)},150)}).bind("focus.wijcombobox",function(){c._addInputFocus(true,b)}).bind("blur.wijcombobox",function(){!c.menu.element.is(":visible")&&e.trigger("wijcomboblur");c._change()})},_addInputFocus:function(f,e){var c=this,d,b,a;d=c._input.parent();b=f?"addClass":"removeClass";a=c._triggerArrow;d[b](e);a!==undefined&&a[b](e)},_renderColumnsHeader:function(c){var b=a("<ul class='wijmo-wijcombobox-rowheader'></ul>");a.each(this.options.columns,function(e,c){var d=a("<li class='wijmo-wijcombobox-cell ui-widget-header'></li>");d.html(c.name);c.width!==undefined&&d.width(c.width);d.appendTo(b)});c.append(b)},_hasSameValueText:function(a,b){return a.label===b.label&&a.value===b.value},_initDropDownList:function(){var b=this,g,d,c,f,e;g=b.element[0].ownerDocument;if(!b._comboDiv)d=a("<div class='wijmo-wijcombobox-list'></div>");else d=b._oriList;c=b.options;if(c.columns.length>0){d.addClass("wijmo-wijcombobox-multicolumn");f=a("<div class='wijmo-wijsuperpanel-header ui-state-default'></div>");b._renderColumnsHeader(f);d.append(f)}e={keepHightlightOnMouseLeave:true,selectionMode:c.selectionMode,addHoverItemClass:c.columns.length===0,focus:function(e,d){var a=d;c.selectOnItemFocus&&b.menu.select(null,{notCloseAfterSelected:true});if(c.columns.length>0){a.element.prev().addClass("wijmo-wijcombobox-active-prev");a.element.find(".wijmo-wijcombobox-row>.wijmo-wijcombobox-cell").addClass("ui-state-hover")}},selected:function(i,e){window.clearTimeout(b.closing);var j=c.selectionMode,d,f,h,g;d=e.item;if(b._trigger("select",i,d))if(j==="single"){if(!b._usingRemoteData()){if(e.selectedIndex!==undefined)f=e.selectedIndex;else f=a.inArray(d,b.items);if(f!==c.selectedIndex){b._input.val(d.label);g=b.selectedItem;if(g!==null)g.selected=false;b.selectedItem=d;h=c.selectedIndex;c.selectedIndex=f;if(b._select!==undefined){b._select[0].selectedIndex=c.selectedIndex;b._select.trigger("change")}b._trigger("changed",null,{oldItem:g,selectedItem:b.selectedItem,newIndex:c.selectedIndex,oldIndex:h})}}else if(b.selectedItem===null||!b._hasSameValueText(d,b.selectedItem)){b._input.val(d.label);b.selectedItem=d;b._trigger("changed",null,{selectedItem:d})}}else if(!b._usingRemoteData()){b.selectedItems=e.selectedItems;b._selectedItemsToInputVal(b.selectedItems);b._trigger("changed",null,{selectedItem:d,selectedItems:b.selectedItems})}if((e.data===undefined||!e.data.notCloseAfterSelected)&&j==="single"){b.close(i);b._input.focus()}},blur:function(d,b){var a=b.element;if(c.columns.length>0){a.find(".wijmo-wijcombobox-row>.wijmo-wijcombobox-cell").removeClass("ui-state-hover");a.prev().removeClass("wijmo-wijcombobox-active-prev")}},itemRendering:function(g,f){var d=f,e;e="";if(d.isSeparator)e+=" wijmo-wijcombobox-separator";if(d.selected)e+=" wijmo-wijcombobox-selecteditem";e.length>0&&d.element.addClass(e);if(b._keypress&&c.isEditable&&c.columns.length===0&&c.highlightMatching&&a.trim(b._input.val()).length>0)d.text=d.label.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b._escapeRegex(b._input.val())+")(?![^<>]*>)(?![^&;]+;)","gi"),"<span class='ui-priority-primary'>$1</span>");else d.text=undefined},itemRendered:function(f,e){var b=e,c,d;if(b.cells===undefined)return;c=b.element;c.empty();d=a("<ul class='wijmo-wijcombobox-row'></ul>");a.each(b.cells,function(e,c){var b=a("<li class='wijmo-wijcombobox-cell ui-state-default'></li>");b.append(c);b.attr("title",c);d.append(b)});c.append(d)},superPanelOptions:{resized:function(){var d=b.menu,a=d.element;c.dropdownWidth=a.outerWidth();c.dropdownHeight=a.outerHeight();b._positionList();b.menu.refreshSuperPanel()}}};e=a.extend(true,e,c.listOptions);b.menu=d.appendTo("body",g).wijlist(e).zIndex(b._input.zIndex()+1).css({top:0,left:0}).hide().data("wijlist");b._menuUL=b.menu.ul},_getSelectedItemsText:function(e){var b="",c,d;c=this;d=c.options.multipleSelectionSeparator;c.selectedItems=e;a.each(e,function(c,a){b+=a.label+d});if(b.length>0)b=b.substr(0,b.lastIndexOf(d));return b},_selectedItemsToInputVal:function(b){var a=this;a._input.val(a._getSelectedItemsText(b))},_createDOMElements:function(){var b=this,e,d,f,h;h=a("<div class='wijmo-wijcombobox-wrapper ui-state-default ui-corner-all'></div>");d=b.element;if(d.is("select")){e=a("<div role='combobox' class='wijmo-wijcombobox ui-widget ui-helper-clearfix'></div>");e.append(h);b._comboElement=e;b._select=d;d.addClass("ui-widget");f=b._input=a("<input role='textbox' aria-autocomplete='list' aria-haspopup='true' />").insertAfter(d);b.options.data=b._convertSelectOptions()}else if(d.is("div")&&a(d.children()[0]).is("input[type='text']")&&a(d.children()[1]).is("div")){b._comboElement=b._comboDiv=e=d;b._oriList=a(d.children()[1]);f=b._input=a(d.children()[0]);h.prependTo(e).append(f);d.addClass("wijmo-wijcombobox ui-widget ui-helper-clearfix");d.attr("role","combobox")}else{e=a("<div role='combobox' class='wijmo-wijcombobox ui-widget ui-helper-clearfix'></div>");e.append(h);b._comboElement=e;f=b._input=d}if(!b._comboDiv){e.insertBefore(f);e.children(".wijmo-wijcombobox-wrapper").append(f)}f.attr({autocomplete:"off",role:"textbox","aria-wijcombobox":"list","aria-haspopup":"true"}).addClass(g);b._oldWidth=d.css("width");b.options.isEditable===false&&f.attr("readonly","readonly");e.bind("mouseenter",function(){b._addInputFocus(true,c)}).bind("mouseleave",function(){b._addInputFocus(false,c)})},_convertSelectOptions:function(){var d=[],b,c;b=this;c=b._select.get(0).options;a.each(c,function(b,a){d.push({label:a.text,value:a.value})});b.options.selectedIndex=b._select[0].selectedIndex;return d},getComboElement:function(){return this._comboElement},_showTrigger:function(){var g=this,l,j,q,p,r,t=0,b,k,o,m,s,n;l=g.options;j=g._input;q=j.parent();p=g._comboElement;b=g._triggerArrow;k=g._label;if(g._select!==undefined){if(!a.browser.msie)t=g._select.width();else{r=g._select.clone();g._select.after(r);t=r.width();r.remove()}j.width(t+(l.data.length>20?l.selectElementWidthFix:0));g._select.hide()}j.css("margin-left","");j.css("margin-right","");p.width(q[0].offsetWidth);if(l.labelText!==null){k=g._label=a(i);q.append(k.html(l.labelText))}else if(k!==undefined){k.remove();g._label=undefined}if(l.showTrigger){j.removeClass("ui-corner-all");if(b===undefined){b=g._triggerArrow=a(h);p.append(b);b.bind("mouseover.triggerevent",g,function(d){if(l.disabled===true)return;var b=a(d.currentTarget);b.addClass(c)}).bind("mousedown.triggerevent",g,function(c){if(l.disabled===true)return;var b=a(c.currentTarget);b.addClass(d)}).bind("mouseup.triggerevent",g,function(c){var b=a(c.currentTarget);b.removeClass(d)}).bind("click.triggerevent",g,function(){if(l.disabled===true)return;g._triggerClick()})}if(l.triggerPosition==="right"){b.css({left:"",right:"0px"});b.removeClass(f);b.addClass(e)}else{b.css({right:"",left:"0px"});b.removeClass(e);b.addClass(f)}b.setOutHeight(p.innerHeight());o=b.find("span");o.css("margin-left",(b.innerWidth()-o[0].offsetWidth)/2);o.css("margin-top",(b.innerHeight()-o[0].offsetHeight)/2)}else{if(b!==undefined){b.unbind(".triggerevent");b.remove();g._triggerArrow=undefined}j.removeClass("ui-corner-left");j.removeClass("ui-corner-right");j.addClass("ui-corner-all")}m=s=n=0;if(k!==undefined)s+=k[0].offsetWidth;if(b!==undefined)n=b[0].offsetWidth;m=s+n;j.setOutWidth(q.innerWidth()-m);m=m===0?"":m;if(l.triggerPosition==="right"){j.css("margin-left","");j.css("margin-right",m);if(k!==undefined){k.css("left","");k.css("right",n)}}else{j.css("margin-right","");j.css("margin-left",m);if(k!==undefined){k.css("right","");k.css("left",n)}}},_triggerClick:function(c){var a=this,b="";window.clearTimeout(a.closing);if(a.menu.element.is(":visible"))a.close();else{if(a._usingRemoteData())b=a._input.val();a.search(b,c)}},destroy:function(){var b=this,c=b.element;b.options.isEditable===false&&c.removeAttr("readonly");if(b._select!==undefined){b._select.removeClass("ui-widget");b._select.show();b._input.remove()}else if(b._comboDiv){b._comboDiv.removeClass("wijmo-wijcombobox ui-widget ui-helper-clearfix");b._comboDiv.removeAttr("role");b._input.insertBefore(b._comboDiv);b._comboDiv.children(".wijmo-wijcombobox-wrapper").remove()}else{c.css("width",b._oldWidth);c.removeClass(g);c.removeAttr("autocomplete").removeAttr("role").removeAttr("aria-wijcombobox").removeAttr("aria-haspopup");c.insertBefore(b._comboElement);c.css("padding","")}b._comboElement.remove();b.menu.destroy();b.menu.element.remove();a.Widget.prototype.destroy.call(b)},_setOption:function(e,d){var b=this,f,c;f=b._comboElement;c=b.element;a.Widget.prototype._setOption.apply(b,arguments);if(e==="disabled")if(d){f.addClass("wijmo-wijcombobox-disabled ui-state-disabled");c.attr("disabled","disabled");b._comboDiv&&b._input.addClass("wijmo-wijcombobox-disabled ui-state-disabled").attr("disabled","disabled");b.close()}else{f.removeClass("wijmo-wijcombobox-disabled ui-state-disabled");c.removeAttr("disabled");b._comboDiv&&b._input.removeClass("wijmo-wijcombobox-disabled ui-state-disabled").removeAttr("disabled")}else if(e==="isEditable")if(d)c.attr("readonly","readonly");else c.removeAttr("readonly");else if(e==="data"){b.selectedItem=null;b.options.selectedIndex=-1;b._input.val("")}else if(e==="selectedIndex")if(d>-1){if(b.selectedItem!==null)b.selectedItem.selected=false;if(b.items[d]!==null){b.selectedItem=b.items[d];b.selectedItem.selected=true;b._input.val(b.selectedItem.label)}}},search:function(g,d){var b=this,f,c,e;f=b.options;c=f.data;window.clearTimeout(b.closing);e={value:g,e:d,self:b};if(c!==null||b._comboDiv){if(d!=="checkindex")if(b._trigger("search",d,{datasrc:c,term:e})===false)return;if(a.isArray(c)||b._comboDiv){b._hideShowArrow(false);b._onListLoaded(c,e)}else{if(b._usingRemoteData()&&d!==undefined&&g.length<f.minLength)return;b._hideShowArrow(false);c.loaded=b._onListLoaded;c.load(e)}}},_usingRemoteData:function(){var b=this.options.data,c=false;if(!a.isArray(b)&&b!==null&&b.proxy!==null)c=true;return c},_hideShowArrow:function(d){var c=this,b,a;b=c.element;a=c._triggerArrow;a!==undefined&&a[d?"show":"hide"]();b[d?"removeClass":"addClass"]("wijmo-wijcombobox-loading")},_onListLoaded:function(g,h){var c=h.self,k,i,j,d,f,e;k=c._input;i=c.options;j=h.value;if(g===null)d=null;else d=a.isArray(g)?g:g.items;c.items=d;if(h.e==="checkindex"){f=i.selectedIndex;if(i.selectionMode==="multiple"&&a.isArray(f)){a.each(f,function(e,b){var a=d[b];a.selected=true;c.selectedItems.push(a)});c._selectedItemsToInputVal(c.selectedItems)}else{d[f].selected=true;c.selectedItem=d[f];k.val(c.selectedItem.label)}c._hideShowArrow(true);return}if(!c._usingRemoteData()&&d){c._filter(d,j);e=a.grep(d,function(a){return!i.autoFilter||a.match})}else{c._topHit=null;e=d}if(e&&e.length>0||c._comboDiv){c._openlist(e,h);c._trigger("open");c._addInputFocus(true,b)}else c.close(null,true);c._hideShowArrow(true)},close:function(h,g){var e=this,d,c,f;d=e.menu;e._dropDownHeight=d.element.outerHeight();e._dropDownWidth=d.element.outerWidth();window.clearTimeout(e.closing);if(d.element.is(":visible")&&!d.element.is(":animated")&&!d.element.parent().is(":animated")){e._trigger("close",h);d.deactivate();c=e.options.hidingAnimation;if(c&&(c.effect==="size"||c.animated==="size"))c.options=a.extend({to:{width:0,height:0}},c.options);f=d.element.attr("style");if(g!==true&&c)d.element.hide(c.effect||c.animated,c.options,c.speed||c.duration,function(){d.element.removeAttr("style").attr("style",f).hide();c.callback&&c.callback.apply(this,arguments)});else d.element.hide();e._addInputFocus(false,b);a(document).unbind("click",e.closeOnClick)}},_change:function(){var a=this,e,f,d,b,g,c;e=a.options;f=e.forceSelectionText;d=e.selectionMode;b=a._input;g=b.val();c=a.selectedItem;if(f)if(d==="single")if(c!==null)c.label!==g&&b.val(c.label);else b.val("");d==="multiple"&&a._selectedItemsToInputVal(a.selectedItems)},_openlist:function(n,o){var b=o.self,f=o.e,i,h,c,e,m,r=2,j=0,g,p,d,k,l;i=b._keypress=!!f;e=b.options;c=b.menu.element;c.zIndex(b.element.zIndex()+1);if(b._comboDiv)b.menu.setTemplateItems(n);else b.menu.setItems(n);b.menu.renderList();b.menu.element.show();if(e.dropdownWidth==="auto")h=b._comboElement.outerWidth();else h=e.dropdownWidth;m=c.css("padding");c.css("padding","0px");c.setOutWidth(h);c.css("padding",m);g=e.dropdownHeight;if(b._select!==undefined)g=20*b._menuUL.children(".wijmo-wijlist-item:first").outerHeight();if(c.children(".wijmo-wijsuperpanel-header"))j=c.children(".wijmo-wijsuperpanel-header").outerHeight();p=Math.min(b._menuUL.outerHeight()+r+j,g);c.setOutHeight(p);b.menu.refreshSuperPanel();b._positionList();!i&&b.selectedItem!==undefined&&b.menu.activate(null,b.selectedItem,true);if(i&&f.keyCode!==a.ui.keyCode.BACKSPACE)if(e.isEditable)b._runAutoComplete();else b.menu.activate(null,b._topHit,true);else{d=b.options.showingAnimation;if(e.showingAnimation!==null&&!(f!==undefined&&f.keyCode===a.ui.keyCode.BACKSPACE)){b.menu.element.hide();l={from:{width:0,height:0},to:{width:b._dropDownWidth||c.outerWidth(),height:b._dropDownHeight||c.outerHeight()}};if(d&&(d.effect==="size"||d.animated==="size"))d.options=a.extend(l,d.options);k=c.attr("style");c.show(d.effect||d.animated,d.options,d.speed||d.duration,function(){c.removeAttr("style").attr("style",k).show();d.callback&&d.callback.apply(this,arguments);a.browser.msie&&c.css("filter","")})}}if(!b.hasOwnProperty("closeOnClick")){var q=b.closeOnClick;b.closeOnClick=function(a){return q(a)}}a(document).bind("click",b,b.closeOnClick)},closeOnClick:function(c){var b=c.data,d=c.target;if(!a.contains(b._comboElement[0],d)&&!a.contains(b.menu.element[0],d)){b.close();a(".wijmo-wijcombobox-wrapper",b._comboElement[0]).removeClass("ui-state-hover").removeClass("ui-state-focus");a(".wijmo-wijcombobox-trigger",b._comboElement[0]).removeClass("ui-state-hover").removeClass("ui-state-focus")}},_positionList:function(){var c=this,d,b;d=c.options.dropDownListPosition;b={my:"left top",at:"left bottom",of:c._comboElement,collision:"none"};b=a.extend(b,d);c.menu.element.position(b)},_runAutoComplete:function(){var a=this,c,b,e,d,f,g;c=a._input;b=a._topHit;if(!a.options.autoComplete||b===null)return;a.menu.activate(null,b,true);e=c.val();d=b.label;c.val(d);f=e.length;g=d.length;a._selectText(f,g,c)},_selectText:function(d,e,c){var f=c.val(),a=c.get(0),b;if(f.length>0)if(a.setSelectionRange!==undefined)a.setSelectionRange(d,e);else if(a.createTextRange!==undefined){b=a.createTextRange();b.moveStart("character",d);b.moveEnd("character",e-f.length);b.select()}},_move:function(a,b){if(!this.menu.element.is(":visible")){this.search("",b);return}if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a))return;this.menu[a](b)},_escapeRegex:function(a){return a===undefined?a:a.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},_filter:function(c,f){var d=this._escapeRegex(f),e,b=null;if(!c)return null;e=new RegExp(d,"i");a.each(c,function(f,a){if(d===undefined||d.length===0){a.match=true;return}var c=e.exec(a.label);if(c===null)a.match=false;else{if(b===null&&c.index===0)b=a;a.match=c.index>=0}});this._topHit=b;return c}})})(jQuery);
(function(a){"use strict";window.wijinputcore={options:{culture:"",invalidClass:"ui-state-error",nullText:"",showNullText:false,hideEnter:false,disableUserInput:false,buttonAlign:"right",showTrigger:false,showSpinner:false,comboItems:undefined,comboWidth:undefined,comboHeight:undefined,initializing:null,initialized:null,triggerMouseDown:null,triggerMouseUp:null,textChanged:null,invalidInput:null},_create:function(){if(this.element[0].tagName.toLowerCase()!=="input")throw"Target element is not a INPUT";a.effects.save(this.element,["width","height"]);var b=this.element.width();this.element.wrap("<div class='wijmo-wijinput ui-widget ui-helper-clearfix ui-state-default ui-corner-all'><span class='wijmo-wijinput-wrapper'></span></div>");this.element.addClass("wijmo-wijinput-input ui-corner-all").attr({role:"textbox","aria-multiline":false});this.wrapper=this.element.parent();this.outerDiv=this.wrapper.parent();this.outerDiv.width(b);if(this.options.showTrigger){this.triggerBtn=a("<div class='wijmo-wijinput-trigger ui-state-default'><span class='ui-icon ui-icon-triangle-1-s'></span></div>").addClass(this.options.buttonAlign==="left"?"ui-corner-left":"ui-corner-right").attr("role","button").appendTo(this.outerDiv);this.element.attr({role:"combobox","aria-expanded":false})}if(this.options.showSpinner){this.spinner=a("<div class='wijmo-wijinput-spinner wijmo-wijinput-button'></div>");this.spinUp=a("<div class='ui-state-default wijmo-wijinput-spinup'><span class='ui-icon ui-icon-triangle-1-n'></span></div>").attr("role","button");this.spinDown=a("<div class='ui-state-default wijmo-wijinput-spindown'><span class='ui-icon ui-icon-triangle-1-s'></span></div>").attr("role","button");if(!this.options.showTrigger){this.spinUp.addClass(this.options.buttonAlign==="left"?"ui-corner-tl":"ui-corner-tr");this.spinDown.addClass(this.options.buttonAlign==="left"?"ui-corner-bl":"ui-corner-br")}this.spinner.append(this.spinUp).append(this.spinDown).appendTo(this.outerDiv);this.element.attr("role","spinner")}if(this.options.showTrigger&&this.options.showSpinner)this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-spinner-trigger-left":"ui-input-spinner-trigger-right");else{this.options.showTrigger&&this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-trigger-left":"ui-input-trigger-right");this.options.showSpinner&&this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-spinner-left":"ui-input-spinner-right")}this.element.setOutWidth(this.outerDiv.width());this._initialize()},_createTextProvider:function(){return undefined},_beginUpdate:function(){},_endUpdate:function(){},_onTriggerClicked:function(){},_initialize:function(){this.element.data("initializing",true);this._trigger("initializing");this.element.data("preText",this.element.val());this.element.data("elementValue",this.element.val());this.element.data("errorstate",false);this.element.data("breakSpinner",true);this.element.data("prevCursorPos",-1);this.element.data("simulating",false);this._createTextProvider();this._beginUpdate();var c=function(a){return(!a.which?a.button:a.which)===1},d=this.options,b=this;this.triggerBtn&&!d.disabled&&this.triggerBtn.bind({mouseover:function(){b._addState("hover",a(this))},mouseout:function(){b._removeState("hover",a(this))},mousedown:function(d){if(!c(d))return;b._addState("active",a(this));b._trigger("triggerMouseDown")},mouseup:function(d){if(!c(d))return;b._stopEvent(d);b._stopSpin();b._removeState("active",a(this));b._trigger("triggerMouseUp");b._onTriggerClicked();b._trySetFocus()}});var e=function(d){if(!c(d))return;b._trySetFocus();b.element.data("breakSpinner",false);b._addState("active",a(this));b._doSpin(a(d.currentTarget).hasClass("wijmo-wijinput-spinup"),true)},f=function(d){if(!c(d))return;b._stopSpin();b._removeState("active",a(this))};this.spinUp&&!d.disabled&&this.spinUp.bind({mouseover:function(){b._addState("hover",a(this))},mouseout:function(){b._removeState("hover",a(this))},mousedown:e,mouseup:f});this.spinDown&&!d.disabled&&this.spinDown.bind({mouseover:function(){b._addState("hover",a(this))},mouseout:function(){b._removeState("hover",a(this))},mousedown:e,mouseup:f});this.element.bind({"focus.wijinput":a.proxy(this._onFocus,this),"blur.wijinput":a.proxy(this._onBlur,this),"mouseup.wijinput":a.proxy(this._onMouseUp,this),"keypress.wijinput":a.proxy(this._onKeyPress,this),"keydown.wijinput":a.proxy(this._onKeyDown,this),"keyup.wijinput":a.proxy(this._onKeyUp,this),"change.wijinput":a.proxy(this._onChange,this),"paste.wijinput":a.proxy(this._onPaste,this),"drop.wijinput":a.proxy(this._onDrop,this)});this.element.bind("propertychange.wijinput input.wijinput",a.proxy(this._onInput,this));this.element.data("initializing",false);this._resetData();this._endUpdate();this._updateText();this.options.disabled&&this.disable();this._trigger("initialized")},_init:function(){},_setOption:function(c,b){a.Widget.prototype._setOption.apply(this,arguments);switch(c){case"buttonAlign":case"showTrigger":case"showSpinner":this._destroy();this._create();break;case"showNullText":this._updateText();break;case"disabled":this.element.attr("disabled",b);this.element[b?"addClass":"removeClass"](this.namespace+"-state-disabled");this.triggerBtn!==undefined&&this.triggerBtn[b?"addClass":"removeClass"](this.namespace+"-state-disabled");this.spinup!==undefined&&this.spinup[b?"addClass":"removeClass"](this.namespace+"-state-disabled");this.spindown!==undefined&&this.spindown[b?"addClass":"removeClass"](this.namespace+"-state-disabled")}},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments);this._destroy()},_destroy:function(){this.wrapper=undefined;this.outerDiv=undefined;this.element.unbind(".wijinput");this.element.removeData("errorstate").removeData("breakSpinner").removeData("prevCursorPos").removeData("simulating").removeData("isPassword").removeClass("wijmo-wijinput-input").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow").removeAttr("aria-expanded");this.element.parent().replaceWith(this.element);this.element.parent().replaceWith(this.element);a.effects.restore(this.element,["width","height"])},widget:function(){return this.outerDiv},_getCulture:function(a){return Globalize.findClosestCulture(a||this.options.culture)},_addState:function(b,a){a.is(":not(.ui-state-disabled)")&&a.addClass("ui-state-"+b)},_removeState:function(a,b){b.removeClass("ui-state-"+a)},_isInitialized:function(){return!this.element.data("initializing")},_setData:function(a){this.setText(a)},_resetData:function(){},_validateData:function(){},getText:function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,false,false)},setText:function(a){if(!this._isInitialized())this.element.val(a);else{this._textProvider.set(a);this._updateText()}},selectText:function(a,b){if(this.element.is(":disabled"))return;this.element.wijtextselection(a,b)},focus:function(){if(this.element.is(":disabled"))return;this.element.get(0).focus()},isFocused:function(){return this.outerDiv.hasClass("ui-state-focus")},_raiseTextChanged:function(){var a=this.element.val();if(this.element.data("preText")!==a){this._trigger("textChanged",null,{text:a});this.element.data("preText",a)}},_raiseDataChanged:function(){},_allowEdit:function(){return!(this.element.attr("readOnly")&&this.element.is(":disabled"))},_updateText:function(a){if(!this._isInitialized())return;a=!!a;var b=this.element.wijtextselection();this.element.val(this._textProvider.toString());this.options.text=this._textProvider.toString(true,false,false);if(this.element.is(":disabled"))return;a&&this.selectText(b.start,b.end);this.element.data("prevCursorPos",b.start);this._raiseTextChanged();this._raiseDataChanged()},_trySetFocus:function(){if(!this.isFocused())try{!this.options.disableUserInput&&this.element.focus()}catch(a){}},_deleteSelText:function(b){if(!this._allowEdit())return;var a=this.element.wijtextselection();b=!!b;if(b)if(a.end===a.start)if(a.end>=1){a.end=a.end-1;a.start=a.start-1}else return;else a.end=a.end-1;else a.end=a.end-1;if(a.end<a.start)a.end=a.start;var c=new wijInputResult;this._textProvider.removeAt(a.start,a.end,c);this._updateText();this.selectText(c.testPosition,c.testPosition)},_fireIvalidInputEvent:function(c){if(this._trigger("invalidInput",null,c)===true)return;if(!this.element.data("errorstate")){var b=this.options.invalidClass||"ui-state-error";this.element.data("errorstate",true);var a=this;window.setTimeout(function(){a.outerDiv.removeClass(b);a.element.data("errorstate",false)},100);this.outerDiv.addClass(b)}},_onInput:function(){if(!this._isSimulating()||!this.element.data("ime"))return;this._simulate()},_keyDownPreview:function(){return false},_beforeSimulate:function(a){if(!this.element.data("lastSelection")){this.element.data("lastSelection",this.element.wijtextselection());this.element.data("lastValue",this.element.val())}this.element.data("ime",a);this.element.data("simulating",true)},_isSimulating:function(){return this.element.data("simulating")},_simulate:function(d){var a=this,b=null;if(typeof d==="string")b=d;else{var f=this.element.wijtextselection(),c=this.element.data("lastSelection").start,e=f.end;if(e>=c)b=this.element.val().substring(c,e)}b&&window.setTimeout(function(){if(!a.element.data("lastValue"))return;a.element.val(a.element.data("lastValue"));var e=a.element.data("lastSelection");a.element.wijtextselection(e);a.element.data("batchKeyPress",true);a.element.data("simulating",false);var c=jQuery.Event("keypress");c.ctrlKey=c.altKey=false;for(var d=0;d<b.length;d++){c.which=c.charCode=c.keyCode=b.charCodeAt(d);a._onKeyPress(c)}a.element.data("batchKeyPress",false);a._endSimulate()},1)},_endSimulate:function(){this.element.removeData("ime");this.element.removeData("lastSelection");this.element.removeData("lastValue")},_onKeyDown:function(b){this.element.data("prevCursorPos",-1);if(!this._isInitialized())return;var c=this._getKeyCode(b);if(c===229){this._beforeSimulate(true);return}this._endSimulate();if(this.options.disableUserInput){this._stopEvent(b);return}if(this._keyDownPreview(b)){this._stopEvent(b);return}switch(c){case a.ui.keyCode.UP:this._doSpin(true,false);this._stopEvent(b);return;case a.ui.keyCode.DOWN:this._doSpin(false,false);this._stopEvent(b);return}if(b.ctrlKey)switch(c){case a.ui.keyCode.INSERT:case 67:return}if(b.ctrlKey||b.altKey)return;switch(c){case 112:case 113:case 114:case 115:case 116:case 117:case a.ui.keyCode.TAB:case a.ui.keyCode.CAPSLOCK:case a.ui.keyCode.END:case a.ui.keyCode.HOME:case a.ui.keyCode.CTRL:case a.ui.keyCode.SHIFT:return;case a.ui.keyCode.BACKSPACE:this._deleteSelText(true);this._stopEvent(b);return;case a.ui.keyCode.DELETE:this._deleteSelText(false);this._stopEvent(b);return;case a.ui.keyCode.ENTER:if(!this.options.hideEnter)return;break;case a.ui.keyCode.ESCAPE:this._stopEvent(b);window.setTimeout(a.proxy(this._resetData,this),1);return;case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.ALT:this._stopEvent(b);return}},_onKeyUp:function(b){if(this._isSimulating())return;var c=this._getKeyCode(b);if(!this._isInitialized())return;if(c===a.ui.keyCode.ENTER)return;if(c===a.ui.keyCode.ESCAPE)return;if(this.options.disableUserInput){this._raiseTextChanged();this._raiseDataChanged();return}this._stopEvent(b)},_getKeyCode:function(a){var b=window.navigator.userAgent;return(b.indexOf("iPod")!==-1||b.indexOf("iPhone")!==-1)&&a.which===127?8:a.keyCode||a.which},_keyPressPreview:function(){return false},_onKeyPress:function(b){if(this._isSimulating())return;this.element.data("prevCursorPos",-1);if(this.options.disableUserInput)return;if(!this._allowEdit())return;if(b.ctrlKey&&b.keyCode==119){this._onPaste(b);return}if(b.which===0)return;var d=b.keyCode||b.which;if(d===a.ui.keyCode.BACKSPACE){this._stopEvent(b);return}if(b.ctrlKey||b.altKey)if(d!==a.ui.keyCode.SPACE)return;if(d===a.ui.keyCode.ENTER&&!this.options.hideEnter)return true;if(this._keyPressPreview(b))return;var c=this.element.wijtextselection(),f=String.fromCharCode(d);c.start<c.end&&this._textProvider.removeAt(c.start,c.end-1,new wijInputResult);var e=new wijInputResult,g=this._textProvider.insertAt(f,c.start,e);if(g){this._updateText();this.selectText(e.testPosition+1,e.testPosition+1)}else this._fireIvalidInputEvent(f);!this.element.data("batchKeyPress")&&this._stopEvent(b)},_isNullText:function(){return this.options.showNullText&&this.element.val()===this.options.nullText},_doFocus:function(){var c=this.element.wijtextselection(),b=c.start;this._updateText();var d=this.element.val();if(d.length===b)b=0;!a.browser.safari&&this.selectText(b,b)},_afterFocused:function(){this._isNullText()&&this._doFocus()},_onFocus:function(){if(this.options.disableUserInput)return;this._addState("focus",this.outerDiv);if(!this.element.data("breakSpinner"))return;if(!this._isInitialized())return;if(!this._allowEdit())return;!this.element.data("focusNotCalledFirstTime")&&this.element.data("focusNotCalledFirstTime",+new Date);this._afterFocused()},_onBlur:function(){if(this.options.disableUserInput)return;if(this._isComboListVisible())return;var c=this.isFocused();this._removeState("focus",this.outerDiv);if(!this.element.data("breakSpinner")){this.element.get(0).focus();var a=this.element.data("prevCursorPos");a!==undefined&&a!==-1&&this.selectText(a,a);return}if(!this._isInitialized())return;if(!c)return;this.element.data("value",this.element.val());var b=this;window.setTimeout(function(){b._onChange();b._updateText();b._validateData()},100)},_onMouseUp:function(){if(!this._isInitialized())return;if(this.element.is(":disabled"))return;var a=this.element.wijtextselection();this.element.data("prevCursorPos",a.start)},_onChange:function(){if(!this.element)return;var a=this.element.val(),b=this.getText();b!==a&&this.setText(a)},_onPaste:function(){this._beforeSimulate();var a=this;window.setTimeout(function(){a._simulate()},1)},_onDrop:function(a){this._beforeSimulate();if(a.originalEvent&&a.originalEvent.dataTransfer){var b=a.originalEvent.dataTransfer.getData("Text");b&&this._simulate(b)}},_stopEvent:function(a){a.stopPropagation();a.preventDefault()},_calcSpinInterval:function(){this._repeatingCount++;return this._repeatingCount>10?50:this._repeatingCount>4?100:this._repeatingCount>2?200:400},_doSpin:function(){},_stopSpin:function(){this.element.data("breakSpinner",true);this._repeatingCount=0},_hasComboItems:function(){return!!this.options.comboItems&&this.options.comboItems.length},_isComboListVisible:function(){return!this._comboDiv?false:this._comboDiv.wijpopup("isVisible")},_popupComboList:function(){if(!this._hasComboItems())return;if(!this._allowEdit())return;if(this._isComboListVisible()){this._comboDiv.wijpopup("hide");return}var b=this;if(this._comboDiv===undefined){this._comboDiv=a("<div></div>").appendTo(document.body).width(this.element.width()).height(this.options.comboHeight||180).css("position","absolute");var c=this._normalize(this.options.comboItems);this._comboDiv.wijlist({autoSize:true,maxItemsCount:5,selected:function(c,a){b._setData(a.item.value);b._comboDiv.wijpopup("hide");b._trySetFocus()}});this._comboDiv.wijlist("setItems",c);this._comboDiv.wijlist("renderList");this._comboDiv.wijlist("refreshSuperPanel")}this._comboDiv.wijpopup({autoHide:true});this.outerDiv.attr("aria-expanded",true);this._comboDiv.wijpopup("show",{of:this.outerDiv,offset:"0 4",hidden:function(){b.outerDiv.attr("aria-expanded",false)}})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b==="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})}};window.wijInputResult=function(){this.alphanumericCharacterExpected=-2;this.asciiCharacterExpected=-1;this.digitExpected=-3;this.invalidInput=-51;this.letterExpected=-4;this.nonEditPosition=-54;this.positionOutOfRange=-55;this.promptCharNotAllowed=-52;this.signedDigitExpected=-5;this.unavailableEditPosition=-53;this.testPosition=-1};window.wijInputResult.prototype={characterEscaped:1,noEffect:2,sideEffect:3,success:4,unknown:0,hint:0,clone:function(){var a=new wijInputResult;a.hint=this.hint;a.testPosition=this.testPosition;return a}}})(jQuery);
(function(b){"use strict";var A={useDefault:-2,asIs:-1,zero:0,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8};b.widget("wijmo.wijinputdate",b.extend(true,{},wijinputcore,{options:{date:null,dateFormat:"d",startYear:1950,smartInputMode:true,activeField:0,keyDelay:800,autoNextField:true,calendar:"default",popupPosition:{offset:"0 4"},dateChanged:null},_createTextProvider:function(){this._textProvider=new z(this,this.options.dateFormat)},_beginUpdate:function(){var a=this.options,b;if(!a.date){a.date=new Date;if(!this.element.data("elementValue"))this.element.data("nullDate",true);else b=this.element.data("elementValue")}else if(typeof a.date==="string")b=a.date;if(b){b=b.replace(/-/g,"/");try{a.date=new Date(b);if(isNaN(a.date))a.date=new Date}catch(c){a.date=new Date}}this.element.data({defaultDate:new Date(a.date.getTime()),preDate:new Date(a.date.getTime())});this._resetTimeStamp();a.showTrigger&&!this._hasComboItems()&&this._initCalendar();this.element.addClass("wijmo-wijinput-date").attr({"aria-valuemin":new Date(1900,1,1),"aria-valuemax":new Date(2099,1,1),"aria-valuenow":a.date})},_endUpdate:function(){var a=this;this.element.click(function(){a.highLightCursor()});this.element.mousewheel(function(c,b){a._doSpin(b>0,false)})},_onTriggerClicked:function(){if(this._hasComboItems())this._popupComboList();else this._popupOrHideCalendar()},_setOption:function(c,a){b.Widget.prototype._setOption.apply(this,arguments);wijinputcore._setOption.apply(this,arguments);switch(c){case"date":if(!a){this.options.date=new Date;!this.isFocused()&&this.element.data("nullDate",true)}else{if(typeof a==="string")a=a.replace(/-/g,"/");this.options.date=new Date(a);if(isNaN(this.options.date))this.options.date=new Date}this._updateText();this.highLightField();break;case"dateFormat":case"culture":this._textProvider._setFormat(this.options.dateFormat);this._updateText();break;case"activeField":a=Math.min(a,this._textProvider.getFieldCount()-1);a=Math.max(a,0);this.options.activeField=a;this.highLightField();this._resetTimeStamp()}},_setData:function(a){this.option("date",a)},_resetData:function(){var b=this.options,a=this.element.data("defaultDate");if(a===undefined||a===null){a=this.element.data("elementValue");if(a!==undefined&&a!==null&&a!==""){this.element.val(a);this._onChange()}else this._setData(new Date)}else this._setData(a)},_resetTimeStamp:function(){this.element.data("cursorPos",0);this.element.data("timeStamp",new Date("1900/1/1"))},highLightField:function(a){if(a===undefined)a=this.options.activeField;if(this.isFocused()){var b=this._textProvider.getFieldRange(a);b&&this.element.wijtextselection(b)}},highLightCursor:function(a){if(this._isNullText())return;if(a===undefined)a=Math.max(0,this.element.wijtextselection().start);var b=this._textProvider.getCursorField(a);if(b<0)return;this._setOption("activeField",b)},toNextField:function(){this._setOption("activeField",this.options.activeField+1)},toPrevField:function(){this._setOption("activeField",this.options.activeField-1)},toFirstField:function(){this._setOption("activeField",0)},toLastField:function(){this._setOption("activeField",this._textProvider.getFieldCount())},clearField:function(a){if(a===undefined)a=this.options.activeField;var b=this._textProvider.getFieldRange(a);if(b){var d=new wijInputResult;this._textProvider.removeAt(b.start,b.end,d);this._updateText();var c=this;window.setTimeout(function(){c.highLightField()},1)}},_doSpin:function(c,a){c=!!c;a=!!a;if(!this._allowEdit())return;if(a&&this.element.data("breakSpinner"))return;if(this._textProvider[c?"incEnumPart":"decEnumPart"]()){this._updateText();this.highLightField()}a&&!this.element.data("breakSpinner")&&window.setTimeout(b.proxy(function(){this._doSpin(c,true)},this),this._calcSpinInterval())},_afterFocused:function(){if(this._isNullText()){this._doFocus();this.element.data("nullDate",false)}var a=this,b=function(){a.highLightCursor();a._resetTimeStamp()};window.setTimeout(b,10)},_keyDownPreview:function(a){var c=a.keyCode||a.which;switch(c){case b.ui.keyCode.LEFT:this.toPrevField();return true;break;case b.ui.keyCode.RIGHT:this.toNextField();return true;break;case b.ui.keyCode.TAB:case b.ui.keyCode.SPACE:case 188:case 190:case 110:case 191:if(a.shiftKey){if(this.options.activeField>0){this.toPrevField();return true}}else if(this.options.activeField<this._textProvider.getFieldCount()-1){this.toNextField();return true}break;case b.ui.keyCode.HOME:if(a.ctrlKey)this._setOption("date",new Date);else this.toFirstField();return true;break;case b.ui.keyCode.END:if(a.ctrlKey)this._setOption("date",new Date("1970/1/1"));else this.toLastField();return true;break;case b.ui.keyCode.DELETE:this.clearField();return}return false},_autoMoveToNextField:function(a,b){if(!this.options.autoNextField)return;this._textProvider.needToMove(this.options.activeField,a,b)&&this.toNextField()},_keyPressPreview:function(a){var g=this._textProvider.getFieldRange(this.options.activeField);if(g){var d=a.keyCode||a.which;if(d===b.ui.keyCode.TAB)return true;if(d===b.ui.keyCode.SPACE){this._stopEvent(a);return true}var e=String.fromCharCode(d),i=this._textProvider.isFieldSep(e,this.options.activeField);if(i){this.toNextField();this._stopEvent(a);return true}var c=this.element.data("cursorPos"),h=new Date,j=this.element.data("timeStamp");this.element.data("timeStamp",h);var f=h.getTime()-j.getTime()>this.options.keyDelay;if(f)c=0;var k=g.start+c;this.element.data("cursorPos",++c);var l=this._textProvider.addToField(e,this.options.activeField,k,!f);if(l){this._updateText();this._autoMoveToNextField(c,e);this.highLightField()}else this._fireIvalidInputEvent();this._stopEvent(a);return true}return false},_raiseDataChanged:function(){var a=this.options.date,b=this.element.data("preDate");this.element.data("preDate",new Date(a.getTime()));if(!b&&a||b&&!a||b&&a&&b.getTime()!==a.getTime()){this._syncCalendar();this.element.attr("aria-valuenow",a);this._trigger("dateChanged",null,{date:a})}},isDateNull:function(){return this.element.data("nullDate")},_isMinDate:function(a){return a.getFullYear()===1&&a.getMonth()===0&&a.getDate()===1},_initCalendar:function(){var a=this.options.calendar;if(a===undefined||a===null)return;if(typeof a==="boolean"||a==="default"){a=b("<div/>");a.appendTo(document.body)}var c=b(a);if(c.length!=1)return;this.element.data("calendar",c);c.wijcalendar({popupMode:true});this._syncCalendar();var d=this;c.bind("wijcalendarselecteddateschanged",function(){var a=b(this).wijcalendar("getSelectedDate");b(this).wijcalendar("close");!!a&&d.option("date",a);d._trySetFocus()})},_syncCalendar:function(){var a=this.element.data("calendar");if(!a)return;var b=this.options.date;if(this._isMinDate(b))b=new Date;a.wijcalendar("option","displayDate",b);a.wijcalendar("unSelectAll");a.wijcalendar("selectDate",b);a.wijcalendar("refresh")},_popupOrHideCalendar:function(){if(!this._allowEdit())return;var a=this.element.data("calendar");if(!a)return;if(a.wijcalendar("isPopupShowing")){a.wijcalendar("hide");return}this._syncCalendar();a.wijcalendar("popup",b.extend({},this.options.popupPosition,{of:this.outerDiv}))}}));var z=function(b,a){this.inputWidget=b;this.descriptors=new Array(0);this.desPostions=new Array(0);this.fields=new Array(0);this._setFormat(a)};z.prototype={descriptors:undefined,desPostions:undefined,maskPartsCount:0,pattern:"M/d/yyyy",initialize:function(){},getFieldCount:function(){return this.fields.length},getFieldRange:function(b){var a=this.fields[b];return{start:a.startIndex,end:a.startIndex+a.getText().length}},getCursorField:function(a){a=Math.min(a,this.desPostions.length-1);a=Math.max(a,0);var c=this.desPostions[a].desc;if(c.type===-1){var d=b.inArray(c,this.descriptors);if(d>0&&this.descriptors[d-1].type!=-1)c=this.descriptors[d-1];else return-1}return b.inArray(c,this.fields)},needToMove:function(c,d,e){var b=this.fields[c];if(d===b.maxLen)return true;var a=e*1;if(isNaN(a))return false;switch(b.type){case 20:case 25:case 45:case 46:return a>1;break;case 47:case 48:return a>2;break;case 30:case 31:return a>3;break;case 50:case 51:case 60:case 61:return a>6}return false},_getCulture:function(){return this.inputWidget._getCulture()},_isDigitString:function(a){a=a.trim();if(a.length===0)return true;var b=a.charAt(0);if(b==="+"||b==="-"){a=a.substr(1);a=a.trim()}if(a.length===0)return true;try{var c=parseFloat(a),d=c.toString();return d===a}catch(e){return false}},_setFormat:function(h){this.descriptors=[];var a="",d="",e=false,g=false;this.pattern=this._parseFormatToPattern(h);for(var f=0;f<this.pattern.length;f++){var c=this.pattern.charAt(f);if(g){this.descriptors.push(this.createDescriptor(-1,c));a="";g=false;continue}if(c==="\\"){g=true;if(a.length>0){!this.handlePattern(a)&&this.descriptors.push(this.createDescriptor(-1,d));a=""}continue}if(c==="'"){if(e){e=false;a=""}else{e=true;if(a.length>0){!this.handlePattern(a)&&this.descriptors.push(this.createDescriptor(-1,d));a=""}}continue}if(e){this.descriptors.push(this.createDescriptor(-1,c));a="";continue}if(!f)d=c;if(d!==c&&a.length>0){!this.handlePattern(a)&&this.descriptors.push(this.createDescriptor(-1,d));a=""}a+=c;d=c}if(a.length>0)!this.handlePattern(a)&&this.descriptors.push(this.createDescriptor(-1,d));this.fields=b.grep(this.descriptors,function(a){return a.type!==-1})},_parseFormatToPattern:function(c){var a=this.inputWidget._getCulture().calendars.standard,b=a.patterns.d;if(c.length<=1)switch(c){case"":case"d":b=a.patterns.d;break;case"D":b=a.patterns.D;break;case"f":b=a.patterns.D+" "+a.patterns.t;break;case"F":b=a.patterns.D+" "+a.patterns.T;break;case"g":b=a.patterns.d+" "+a.patterns.t;break;case"G":b=a.patterns.d+" "+a.patterns.T;break;case"m":b=a.patterns.M;break;case"M":b=a.patterns.M;break;case"s":b=a.patterns.S;break;case"t":b=a.patterns.t;break;case"T":b=a.patterns.T;break;case"u":b=a.patterns.S;break;case"U":b=a.patterns.D+" "+a.patterns.T;break;case"y":b=a.patterns.Y;break;case"Y":b=a.patterns.Y}else b=c;return b},getDate:function(){return!!this.inputWidget?this.inputWidget.options.date:undefined},setDate:function(a){this.inputWidget&&this.inputWidget._setData(a)},_internalSetDate:function(a){if(this.inputWidget)this.inputWidget.options.date=a},daysInMonth:function(a,c){a=a-1;var b=new Date(c,++a,1,-1).getDate();return b},setYear:function(b,f,d){try{if(d&&d.isfullreset){d.offset=1;b="1970"}if(b instanceof String)if(!this._isDigitString(b))return false;b=b*1;if(b<0)if(d&&d.isreset)b=1;else return false;var c=this.getDate(),a=new Date(c.getTime());a.setFullYear(b);if(this._isValidDate(a)){var e=this.daysInMonth(this.getMonth(),this.getYear());if(e===c.getDate()){a=new Date(c.getTime());a.setDate(1);a.setFullYear(b);e=this.daysInMonth(a.getMonth()+1,a.getFullYear());a.setDate(e);if(this._isValidDate(a)){this._internalSetDate(a);return true}else return false}c.setFullYear(b);this._internalSetDate(c);return true}else{if(d&&d.isreset){c.setFullYear(1);this._internalSetDate(c);return true}return false}}catch(g){return false}},getYear:function(){try{var a=this.getDate().getFullYear();a=""+a+"";while(a.length<4)a="0"+a;return""+a+""}catch(b){alert("getYear() failed")}return""},setMonth:function(b,e,c){try{if(c&&c.isfullreset)b="1";b=b*1;var f=this.getDate();if(typeof e!=="undefined"&&!e)if(b>12||b<1)if(c&&c.isreset)b=1;else return false;var d=this.daysInMonth(this.getMonth(),this.getYear()),a;if(d===this.getDate().getDate()){a=new Date(f.getTime());a.setDate(1);a.setMonth(b-1);d=this.daysInMonth(a.getMonth()+1,a.getFullYear());a.setDate(d);if(this._isValidDate(a)){this._internalSetDate(a);return true}else return false}else{a=new Date(f.getTime());a.setMonth(b-1);if(this._isValidDate(a)){this._internalSetDate(a);return true}else return false}}catch(g){return false}},getMonth:function(){return this.getDate().getMonth()+1},setDayOfMonth:function(b,c,a){try{if(a&&a.isfullreset)return this.setDayOfMonth(1,c);var e=this.getDate();b=b*1;if(typeof c!=="undefined"&&!c){var f=this.daysInMonth(this.getMonth(),this.getYear());if(b>f||b<1)return a&&a.isreset?this.setDayOfMonth(1,c,a):false}var d=new Date(e.getTime());d.setDate(b);if(this._isValidDate(d)){this._internalSetDate(d);return true}else return false}catch(g){return false}},getDayOfMonth:function(){return this.getDate().getDate()},setHours:function(a,c){try{a=a*1;if(typeof c!=="undefined"&&!c)if(a>24)return false;var b=new Date(this.getDate().getTime());b.setHours(a);if(this._isValidDate(b)){this._internalSetDate(b);return true}else return false}catch(d){return false}},getHours:function(){return this.getDate().getHours()},setMinutes:function(a,c){try{a=a*1;if(typeof c!=="undefined"&&!c)if(a>60)return false;var b=new Date(this.getDate().getTime());b.setMinutes(a);if(this._isValidDate(b)){this._internalSetDate(b);return true}else return false}catch(d){return false}},getMinutes:function(){return this.getDate().getMinutes()},setSeconds:function(a,c){try{a=a*1;if(typeof c!=="undefined"&&!c)if(a>60)return false;var b=new Date(this.getDate().getTime());b.setSeconds(a);if(this._isValidDate(b)){this._internalSetDate(b);return true}else return false}catch(d){return false}},getSeconds:function(){return this.getDate().getSeconds()},setDayOfWeek:function(a){try{a=a*1;var b=a-this.getDayOfWeek()*1;return this.setDayOfMonth(this.getDayOfMonth()*1+b*1,true)}catch(c){return false}},getDayOfWeek:function(){return this.getDate().getDay()+1},handlePattern:function(c){var a=new RegExp("y{3,4}"),b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(10));return true}a=new RegExp("y{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(2));return true}a=new RegExp("y{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(1));return true}a=new RegExp("d{4,4}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(101));return true}a=new RegExp("d{3,3}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(100));return true}a=new RegExp("d{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(30));return true}a=new RegExp("d{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(31));return true}a=new RegExp("M{4,4}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(27));return true}a=new RegExp("M{3,3}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(26));return true}a=new RegExp("M{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(20));return true}a=new RegExp("M{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(25));return true}a=new RegExp("h{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(46));return true}a=new RegExp("h{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(45));return true}a=new RegExp("H{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(48));return true}a=new RegExp("H{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(47));return true}a=new RegExp("m{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(50));return true}a=new RegExp("m{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(51));return true}a=new RegExp("s{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(60));return true}a=new RegExp("s{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(61));return true}a=new RegExp("t{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(251));return true}a=new RegExp("t{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(250));return true}return false},createDescriptor:function(z,c){var a=null,b=this.maskPartsCount++;switch(z){case-1:a=new y(this,b);a.liternal=c;break;case 20:a=new i(this,b);break;case 25:a=new j(this,b);break;case 26:a=new k(this,b);break;case 27:a=new l(this,b);break;case 30:a=new m(this,b);break;case 31:a=new n(this,b);break;case 100:a=new d(this,b);break;case 101:a=new e(this,b);break;case 10:a=new h(this,b);break;case 1:a=new w(this,b);break;case 2:a=new x(this,b);break;case 45:a=new o(this,b);break;case 46:a=new p(this,b);break;case 47:a=new q(this,b);break;case 48:a=new r(this,b);break;case 250:a=new f(this,b);break;case 251:a=new g(this,b);break;case 50:a=new s(this,b);break;case 51:a=new t(this,b);break;case 60:a=new u(this,b);break;case 61:a=new v(this,b)}return a},toString:function(){if(this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&this.inputWidget.isDateNull())return this.inputWidget.options.nullText;var e="",f=0;this.desPostions=new Array(0);for(var b=0;b<this.descriptors.length;b++){this.descriptors[b].startIndex=e.length;var c=""||this.descriptors[b].getText();e+=c;for(var d=0;d<c.length;d++){var a={};a.desc=this.descriptors[b];a.pos=d;a.text=c;a.length=c.length;this.desPostions.push(a);f++;if(this.desPostions.length!==f)throw"Fatal Error !!!!!!!!!!!!!!!";}}return e},"set":function(a){if(this.pattern==="dddd"||this.pattern==="ddd")return false;if(typeof a=="object"){this._internalSetDate(new Date(a));return true}var b=this.getDateFromFormat(a,this.pattern);if(!b)b=this._parseDate(a,this.pattern);if(!!b){this._internalSetDate(new Date(b));return true}return false},haveEnumParts:function(){return false},removeLiterals:function(a){a=""+a+"";a=a.replace(new RegExp("\\s","g"),"");a=a.replace(new RegExp("[+]","g"),"");a=a.replace(new RegExp("[.]","g"),"");a=a.replace(new RegExp("[:]","g"),"");a=a.replace(new RegExp("[-]","g"),"");a=a.replace(new RegExp("[()=]","g"),"");return a},getFirstDelimiterPos:function(b,d){var c=0,a=0;while(c<d.length&&a<b.length){var e=d.charAt(c),f=b.charAt(a);if(e===f)a++;else return a-1;c++}return b.length-1},findAlikeArrayItemIndex:function(d,f){for(var c=-1,e=99999,a=0;a<d.length;a++){var b=d[a].toLowerCase().indexOf(f.toLowerCase());if(b!==-1&&b<e){e=b;c=a}}return c},_isValidDate:function(a){return a===undefined?false:isNaN(a)?false:a.getFullYear()<1||a.getFullYear()>9999?false:true},isFieldSep:function(d,c){var a=c++;if(a<this.descriptors.length){var b=this.descriptors[a];return b.type!=-1?false:d===b.text}return false},getPositionType:function(b){var a=this.desPostions[b];return a.desc.type},addToField:function(a,c,f,e){var b=this.fields[c];if(b.type==10)return this.insertAt(a,f);var g=e?b.getText()+a:a,d={val:a,pos:0,offset:0,isreset:false};return b.setText(g,a.length===1?false:true,d)},insertAt:function(c,i,b){if(!b)b=new wijInputResult;b.testPosition=-1;var a;if(c.length===1){a=this.desPostions[i];if(a&&a.desc.type===-1)if(a.text===c){b.testPosition=i;b.hint=b.characterEscaped;return true}}var r=c,d=i;c=this.removeLiterals(c);var f=c,m=false,p=false;if(d>0&&f.length===1){d--;i=d;a=this.desPostions[d];m=true;if(a&&(a.desc.type===-1||a.desc.getText().length!==1)){i++;d++;m=false}}var j=false,e,g;while(f.length>0&&d<this.desPostions.length){a=this.desPostions[d];if(a.desc.type===-1){d=d+a.length;continue}if(a.desc.needAdjustInsertPos()){e=f.substr(0,a.length-a.pos);e=a.text.slice(0,a.pos)+e+a.text.slice(a.pos+e.length,a.length);if(m)e=a.text+e;if(p)e=e+a.text;var o=a.desc.getText().length,k="";try{if(c.length===1)if(!a.pos)k=c;else if(a.pos>0)k=e.substring(0,a.pos+1)}catch(t){}if(o===1&&e.length>1&&c.length===1)if(a.desc.type===31||a.desc.type===25)this._disableSmartInputMode=true;g={val:c,pos:a.pos,offset:0,isreset:false};j=a.desc.setText(e,c.length===1?false:true,g);this._disableSmartInputMode=false;if(!j&&typeof k!=="undefined"&&k.length>0&&(a.desc.type===26||a.desc.type===27||a.desc.type===100||a.desc.type===101||a.desc.type===250||a.desc.type===251))j=a.desc.setText(k,c.length===1?false:true,g);if(j){b.hint=b.success;b.testPosition=d+g.offset;if(c.length===1){var l=a.desc.getText().length,n=a.pos;if(a.pos>l-1)n=l;var s=l-o;if(s>0&&a.pos===o-1)n=l-1;var u=this.toString();b.testPosition=a.desc.startIndex+n+g.offset}f=f.slice(a.length-a.pos,f.length)}else{b.hint=b.invalidInput;if(b.testPosition!==-1)b.testPosition=i;if(a.desc.type!==-1&&c.length===1)return false}d=d+a.length}else{var h=this.getFirstDelimiterPos(f,r);if(h<0)h=0;e=f.substring(0,h+1);g={val:c,pos:a.pos,offset:0,isreset:false};j=a.desc.setText(e,c.length===1?false:true,g);if(j){b.hint=b.success;b.testPosition=d+g.offset;f=f.slice(h+1,f.length)}else{b.hint=b.invalidInput;if(b.testPosition!==-1)b.testPosition=i}if(h<0)h=0;var q=h+1;d=d+q}}return j},removeAt:function(b,e,c){try{var a=this.desPostions[b];if(a.desc.needAdjustInsertPos()){var d="0",g=b;a.text=a.desc.getText();d=a.text.slice(0,a.pos)+d+a.text.slice(a.pos+d.length,a.length);var f={val:d,pos:a.pos,offset:0,isreset:true,isfullreset:false};if(e-b+1>=a.length){f.isfullreset=true;b=b+a.length;g=b}var h=a.desc.setText(d,false,f);if(h){c.hint=c.success;c.testPosition=g}else{c.hint=c.invalidInput;if(c.testPosition===-1)c.testPosition=b}}b<e&&this.removeAt(b+1,e,c);return true}catch(i){return false}},incEnumPart:function(){var a=this.fields[this.inputWidget.options.activeField];a&&a.inc();return true},decEnumPart:function(){var a=this.fields[this.inputWidget.options.activeField];a&&a.dec();return true},setValue:function(a){this.setDate(new Date(a instanceof Date?a.getTime():a));return true},getValue:function(){return this.getDate()},_disableSmartInputMode:false,_isSmartInputMode:function(){return this._disableSmartInputMode?false:this.inputWidget?this.inputWidget.options.smartInputMode:true},_getInt:function(g,e,d,f){for(var c=f;c>=d;c--){var a=g.substring(e,e+c);if(a.length<d)return null;if(b.wij.charValidator.isDigit(a))return a}return null},getDateFromFormat:function(e,l){var h=this._getCulture().calendars.standard,v=b.merge(b.merge([],h.months.names),h.months.namesAbbr),w=b.merge(b.merge([],h.days.names),h.days.namesShort);e=e+"";l=l+"";var c=0,o=0,z="",a="",q=0,r=0,i,y=new Date,g=y.getFullYear(),f=y.getMonth()+1,j=1,d=0,m=0,n=0,k="",u=false,p=false;while(o<l.length){z=l.charAt(o);a="";while(l.charAt(o)===z&&o<l.length){a+=l.charAt(o++);if(p)break}if(p){c+=a.length;p=false}else if(a==="\\")p=true;else if(a==="'")u=!u;else if(u)c+=a.length;else if(a==="yyyy"||a==="yy"||a==="y"){if(a==="yyyy"){q=4;r=4}if(a==="yy"){q=2;r=2}if(a==="y"){q=2;r=4}g=this._getInt(e,c,q,r);if(!g)return 0;c+=g.length;if(g.length===2)if(g>70)g=1900+ +g;else g=2e3+ +g}else if(a==="MMMM"||a==="MMM"||a==="NNN"){f=0;for(i=0;i<v.length;i++){var s=v[i];if(e.substring(c,c+s.length).toLowerCase()===s.toLowerCase())if(a==="MMM"||a==="MMMM"||a==="NNN"&&i>11){f=i+1;if(f>12)f=f-12;c+=s.length;break}}if(f<1||f>12)return 0}else if(a==="dddd"||a==="ddd"||a==="EE"||a==="E")for(i=0;i<w.length;i++){var t=w[i];if(e.substring(c,c+t.length).toLowerCase()===t.toLowerCase()){c+=t.length;break}}else if(a==="MM"||a==="M"){f=this._getInt(e,c,a.length,2);if(!f||f<1||f>12)return 0;c+=f.length}else if(a==="dd"||a==="d"){j=this._getInt(e,c,a.length,2);if(!j||j<1||j>31)return 0;c+=j.length}else if(a==="hh"||a==="h"){d=this._getInt(e,c,a.length,2);if(!d||d<1||d>12)return 0;c+=d.length}else if(a==="HH"||a==="H"){d=this._getInt(e,c,a.length,2);if(!d||d<0||d>23)return 0;c+=d.length}else if(a==="KK"||a==="K"){d=this._getInt(e,c,a.length,2);if(!d||d<0||d>11)return 0;c+=d.length}else if(a==="kk"||a==="k"){d=this._getInt(e,c,a.length,2);if(!d||d<1||d>24)return 0;c+=d.length;d=d-1}else if(a==="mm"||a==="m"){m=this._getInt(e,c,a.length,2);if(!m||m<0||m>59)return 0;c+=m.length}else if(a==="ss"||a==="s"){n=this._getInt(e,c,a.length,2);if(!n||n<0||n>59)return 0;c+=n.length}else if(a==="tt"||a==="t"||a==="a"){if(e.substring(c,c+2).toLowerCase()==="am"){k="AM";c+=2}else if(e.substring(c,c+2).toLowerCase()==="pm"){k="PM";c+=2}else if(e.substring(c,c+1).toLowerCase()==="a"){k="AM";c+=1}else if(e.substring(c,c+1).toLowerCase()==="p"){k="PM";c+=1}else if(e.substring(c,c+h.AM[0].length).toLowerCase()===h.AM[0].toLowerCase()){k="AM";c+=h.AM[0].length}else if(e.substring(c,c+h.PM[0].length).toLowerCase()===h.PM[0].toLowerCase()){k="PM";c+=h.AM[0].length}else if(e.substring(c,c+1).toLowerCase()===" ")c+=1}else{var A=e.substring(c,c+a.length);if(A!==a)return 0;else c+=a.length}}if(c!==e.length)return 0;if(f===2)if(!g%4&&g%100||!g%400){if(j>29)return 0}else if(j>28)return 0;if(f===4||f===6||f===9||f===11)if(j>30)return 0;if(d<12&&k==="PM")d=+d+12;else if(d>11&&k==="AM")d=d-12;var x=new Date(g,f-1,j,d,m,n);x.setFullYear(g);return x.getTime()},_parseDate:function(h,a){if(a){if(a.indexOf("MMM")===-1&&a.indexOf("MMMM")===-1)a=a.replace("MM","M");a=a.replace("dd","d");a=a.replace("tt","a")}var e=false;window.generalFormats=[!a?"y/M/d":a,"y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"];window.monthFirst=["M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"];window.dateFirst=["d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"];for(var f=["generalFormats",e?"dateFirst":"monthFirst",e?"monthFirst":"dateFirst"],b,c=0;c<f.length;c++)for(var g=window[f[c]],d=0;d<g.length;d++){b=this.getDateFromFormat(h,g[d]);if(b)return b}return 0},paddingZero:function(c,b){var a=""+c+"";while(a.length<b)a="0"+a;return a},_formatDate:function(a,e,c){if(!a.valueOf())return"&nbsp;";var b=this,d=e.replace(new RegExp("yyyy|MMMM|MMM|MM|M|mm|m|dddd|ddd|dd|d|hh|h|HH|H|ss|s|tt|t|a/p","gi"),function(e){var d;switch(e){case"yyyy":return a.getFullYear();case"MMMM":return c.dateTimeFormat.monthNames[a.getMonth()];case"MMM":return c.dateTimeFormat.abbreviatedMonthNames[a.getMonth()];case"MM":return b.paddingZero(a.getMonth()+1,2);case"M":return b.paddingZero(a.getMonth()+1,1);case"mm":return b.paddingZero(a.getMinutes(),2);case"m":return b.paddingZero(a.getMinutes(),1);case"dddd":return c.dateTimeFormat.dayNames[a.getDay()];case"ddd":return c.dateTimeFormat.abbreviatedDayNames[a.getDay()];case"dd":return b.paddingZero(a.getDate(),2);case"d":return b.paddingZero(a.getDate(),1);case"hh":d=a.getHours()%12;return b.paddingZero(d?d:12,2);case"h":d=a.getHours()%12;return b.paddingZero(d?d:12,1);case"HH":return b.paddingZero(a.getHours(),2);case"H":return b.paddingZero(a.getHours(),1);case"ss":return b.paddingZero(a.getSeconds(),2);case"s":return b.paddingZero(a.getSeconds(),1);case"tt":return a.getHours()<12?cf.AM[0]:cf.PM[0];case"t":return a.getHours()<12?cf.AM[0].length>0?cf.AM[0].charAt(0):"":cf.PM[0].length>0?cf.PM[0].charAt(0):"";case"a/p":return a.getHours()<12?"a":"p"}return"N"});return d}};var a=function(d,c,a,b){this._txtProvider=d;this.id=c;this.type=a;this.startIndex=0;this.maxLen=b||2};a.prototype={_txtProvider:null,id:0,type:0,name:null,startIndex:0,maxLen:2,getText:function(){return null},setText:function(){return false},inc:function(){},dec:function(){},needAdjustInsertPos:function(){return true},reachMaxLen:function(){var a=this.getText();do if(a.charAt(0)==="0")a=a.slice(1);else break;while(a.length>0);return a.length>=this.maxLen}};var c=function(c,b){for(var a in b.prototype)if(!c.prototype[a])c.prototype[a]=b.prototype[a]},y=function(b,d){c(y,a);a.apply(this,[b,d,-1,100])};y.prototype={liternal:"",getText:function(){return this.liternal}};var i=function(b,d){c(i,a);a.apply(this,[b,d,20]);this.name="Two-digit month"};i.prototype={getText:function(){var a=""+this._txtProvider.getMonth()+"";return a.length===1?"0"+a:a},setText:function(c,a,b){return this._txtProvider.setMonth(c,a,b)},inc:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1+1,true)},dec:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1-1,true)}};var j=function(b,d){c(j,a);a.apply(this,[b,d,25]);this.name="month"};j.prototype={getText:function(){return""+this._txtProvider.getMonth()+""},setText:function(c,a,b){return this._txtProvider.setMonth(c,a,b)},inc:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1+1,true)},dec:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1-1,true)}};var k=function(b,d){c(k,a);a.apply(this,[b,d,26,100]);this.name="AbbreviatedMonthNames"};k.prototype={getText:function(){var b=this._txtProvider.getMonth(),a=this._txtProvider._getCulture();return a.calendars.standard.months.namesAbbr[b-1]},setText:function(d,b,c){var a=-1;a=this._txtProvider.findAlikeArrayItemIndex(cf.months.namesAbbr,d);return a===-1?false:this._txtProvider.setMonth(a+1,b,c)},inc:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1+1,true)},dec:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1-1,true)}};var l=function(b,d){c(l,a);a.apply(this,[b,d,27,100]);this.name="MonthNames"};l.prototype={getText:function(){var b=this._txtProvider.getMonth(),a=this._txtProvider._getCulture();return a.calendars.standard.months.names[b-1]},setText:function(e,c,b){var a=-1;if(b&&b.isfullreset)a=1;else{var d=this._txtProvider._getCulture();a=this._txtProvider.findAlikeArrayItemIndex(d.calendars.standard.months.names,e);if(a===-1)return false}return this._txtProvider.setMonth(a+1,c,b)},inc:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1+1,true)},dec:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1-1,true)}};var m=function(b,d){c(m,a);a.apply(this,[b,d,30]);this.name="Two-digit day of month"};m.prototype={getText:function(){var a=this._txtProvider.getDayOfMonth();if(a<10)a="0"+a;return""+a+""},setText:function(c,a,b){return this._txtProvider.setDayOfMonth(c,a,b)},inc:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1+1,true)},dec:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1-1,true)}};var n=function(b,d){c(n,a);a.apply(this,[b,d,31]);this.name="Day of month"};n.prototype={getText:function(){var a=this._txtProvider.getDayOfMonth();return""+a+""},setText:function(c,a,b){return this._txtProvider.setDayOfMonth(c,a,b)},inc:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1+1,true)},dec:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1-1,true)}};var d=function(b,e){c(d,a);a.apply(this,[b,e,100,100]);this.name="AbbreviatedDayNames"};d.prototype={getText:function(){var b=this._txtProvider.getDayOfWeek(),a=this._txtProvider._getCulture();return a.calendars.standard.days.namesShort[b-1]},setText:function(c){var a=-1,b=this._txtProvider._getCulture();a=this._txtProvider.findAlikeArrayItemIndex(b.calendars.standard.days.namesShort,c);return a===-1?false:this._txtProvider.setDayOfWeek(a+1)},inc:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1+1,true)},dec:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1-1,true)},needAdjustInsertPos:function(){return false}};var e=function(b,d){c(e,a);a.apply(this,[b,d,101,100]);this.name="DayNames"};e.prototype={getText:function(){var b=this._txtProvider.getDayOfWeek(),a=this._txtProvider._getCulture();return a.calendars.standard.days.names[b-1]},setText:function(c){var a=-1,b=this._txtProvider._getCulture();a=this._txtProvider.findAlikeArrayItemIndex(b.calendars.standard.days.names,c);return a===-1?false:this._txtProvider.setDayOfWeek(a+1)},inc:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1+1,true)},dec:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1-1,true)},needAdjustInsertPos:function(){return false}};var h=function(b,d){c(h,a);a.apply(this,[b,d,10,4]);this.name="Four-digit year"};h.prototype={getText:function(){return this._txtProvider.getYear()},setText:function(i,f,a){if(this._txtProvider._isSmartInputMode()&&a){var b=2e3;if(this._txtProvider.inputWidget.options.startYear)b=this._txtProvider.inputWidget.options.startYear;var e=b+100-1;b=this._txtProvider.paddingZero(b,4);e=this._txtProvider.paddingZero(e,4);if(a.pos===0||a.pos===1){var k=new Date,c=this._txtProvider.paddingZero(this._txtProvider.getYear(),4);if(c.charAt(0)==="0"&&c.charAt(1)==="0"&&a.pos<=1){var g=a.val*1,d="00";if(g>=5)d=b.slice(0,2);else d=e.slice(0,2);var h=a.val+c.slice(3,4),j=d+h;a.offset=2-a.pos;this._txtProvider.setYear(j,f,a);return true}}}return this._txtProvider.setYear(i,f,a)},inc:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1+1,true)},dec:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1-1,true)}};var w=function(b,d){c(w,a);a.apply(this,[b,d,1]);this.name="One-digit year"};w.prototype={getText:function(){var a=this._txtProvider.getYear();a=""+a+"";if(a.length===4)a=a.charAt(2)+a.charAt(3);if(a.charAt(0)==="0")a=a.charAt(1);return a},setText:function(a,c,e){a=a+"";while(a.length<2)a="0"+a;var b=this._txtProvider.getYear();b=""+b+"";if(a==="00"){var h=this._txtProvider.getMonth(),d=this._txtProvider.getDayOfMonth(),g=this._txtProvider.getHours(),f=this._txtProvider.getMinutes(),i=this._txtProvider.getSeconds();if(h===1&&d===1&&!g&&!f&&!i){b="0001";a="01"}}if(b.length>=2)b=b.charAt(0)+b.charAt(1)+a.charAt(0)+a.charAt(1);return this._txtProvider.setYear(b,c,e)},inc:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1+1,true)},dec:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1-1,true)}};var x=function(b,d){c(x,a);a.apply(this,[b,d,2]);this.name="Two-digit year"};x.prototype={getText:function(){var a=this._txtProvider.getYear();a=""+a+"";if(a.length===4)a=a.charAt(2)+a.charAt(3);return a},setText:function(a,c,e){a=a+"";while(a.length<2)a="0"+a;var b=this._txtProvider.getYear();b=""+b+"";if(a==="00"){var i=this._txtProvider.getMonth(),d=this._txtProvider.getDayOfMonth(),h=this._txtProvider.getHours(),g=this._txtProvider.getMinutes(),j=this._txtProvider.getSeconds();if(i===1&&d===1&&!h&&!g&&!j){b="0001";a="01"}}if(b.length>=2)b=b.charAt(0)+b.charAt(1)+a.charAt(0)+a.charAt(1);var f=this._txtProvider.setYear(b,c,e);return f},inc:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1+1,true)},dec:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1-1,true)}};var o=function(b,d){c(o,a);a.apply(this,[b,d,45]);this.name="h"};o.prototype={getText:function(){var a=this._txtProvider.getHours();if(a>12)a=a-12;if(!a)a=12;return""+a+""},setText:function(a,b){var c=this._txtProvider.getHours();if(c>12)a=a*1+12;return this._txtProvider.setHours(a,b)},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+1,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-1,true)}};var p=function(b,d){c(p,a);a.apply(this,[b,d,46]);this.name="hh"};p.prototype={getText:function(){var a=this._txtProvider.getHours();if(a>12)a=a-12;if(!a)a=12;if(a<10)a="0"+a;return""+a+""},setText:function(a,b){var c=this._txtProvider.getHours();if(c>12)a=a*1+12;return this._txtProvider.setHours(a,b)},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+1,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-1,true)}};var q=function(b,d){c(q,a);a.apply(this,[b,d,47]);this.name="H"};q.prototype={getText:function(){var a=this._txtProvider.getHours();return""+a+""},setText:function(b,a){return this._txtProvider.setHours(b,a)},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+1,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-1,true)}};var r=function(b,d){c(r,a);a.apply(this,[b,d,48]);this.name="HH"};r.prototype={getText:function(){var a=this._txtProvider.getHours();if(a<10)a="0"+a;return""+a+""},setText:function(b,a){return this._txtProvider.setHours(b,a)},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+1,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-1,true)}};var f=function(b,d){c(f,a);a.apply(this,[b,d,250]);this.name="t"};f.prototype={getText:function(){var c=this._txtProvider.getHours(),a="",b=this._txtProvider._getCulture();if(c<12)a=b.calendars.standard.AM[0];else a=b.calendars.standard.PM[0];if(a.length<=0)a=" ";return a.charAt(0)},setText:function(a){if(a.toLowerCase().indexOf("a")>=0){var b=this._txtProvider.getHours()*1%12;this._txtProvider.setHours(b,true)}else if(a.toLowerCase().indexOf("p")>=0){var b=this._txtProvider.getHours()*1%12+12;this._txtProvider.setHours(b,true)}},inc:function(){var a=(this._txtProvider.getHours()*1+12)%24;this._txtProvider.setHours(a,true)},dec:function(){var a=(this._txtProvider.getHours()*1+12)%24;this._txtProvider.setHours(a,true)}};var g=function(b,d){c(g,a);a.apply(this,[b,d,251]);this.name="tt"};g.prototype={getText:function(){var c=this._txtProvider.getHours(),a="",b=this._txtProvider._getCulture();if(c<12)a=b.calendars.standard.AM[0];else a=b.calendars.standard.PM[0];if(a.length<=0)a=" ";return a},setText:function(a){if(a.toLowerCase().indexOf("a")>=0){var b=this._txtProvider.getHours()*1%12;this._txtProvider.setHours(b,true)}else if(a.toLowerCase().indexOf("p")>=0){var b=this._txtProvider.getHours()*1%12+12;this._txtProvider.setHours(b,true)}return true},inc:function(){var a=(this._txtProvider.getHours()*1+12)%24;this._txtProvider.setHours(a,true)},dec:function(){var a=(this._txtProvider.getHours()*1+12)%24;this._txtProvider.setHours(a,true)}};var s=function(b,d){c(s,a);a.apply(this,[b,d,50]);this.name="mm"};s.prototype={getText:function(){var a=this._txtProvider.getMinutes();if(a<10)a="0"+a;return""+a+""},setText:function(b,a){return this._txtProvider.setMinutes(b,a)},inc:function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()*1+1,true)},dec:function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()*1-1,true)}};var t=function(b,d){c(t,a);a.apply(this,[b,d,51]);this.name="m"};t.prototype={getText:function(){var a=this._txtProvider.getMinutes();return""+a+""},setText:function(b,a){return this._txtProvider.setMinutes(b,a)},inc:function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()*1+12,true)},dec:function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()*1-12,true)}};var u=function(b,d){c(u,a);a.apply(this,[b,d,60]);this.name="ss"};u.prototype={getText:function(){var a=this._txtProvider.getSeconds();if(a<10)a="0"+a;return""+a+""},setText:function(b,a){return this._txtProvider.setSeconds(b,a)},inc:function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()*1+12,true)},dec:function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()*1-12,true)}};var v=function(b,d){c(v,a);a.apply(this,[b,d,61]);this.name="s"};v.prototype={getText:function(){var a=this._txtProvider.getSeconds();return""+a+""},setText:function(b,a){return this._txtProvider.setSeconds(b,a)},inc:function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()*1+12,true)},dec:function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()*1-12,true)}}})(jQuery);
(function(b){"use strict";var a={editOptional:1,editRequired:2,separator:4,literal:8};b.widget("wijmo.wijinputmask",b.extend(true,{},wijinputcore,{options:{text:null,mask:"",promptChar:"_",hidePromptOnLeave:false,resetOnPrompt:true,allowPromptAsInput:false,passwordChar:"",resetOnSpace:true,skipLiterals:true},_createTextProvider:function(){this._textProvider=new c(this,this.options.mask,false)},_beginUpdate:function(){this.element.addClass("wijmo-wijinput-mask");this.element.data("isPassword",this.options.passwordChar.length>0&&this.element.attr("type")!=="password");this.element.data("defaultText",this.options.text)},_onTriggerClicked:function(){this._popupComboList()},_setOption:function(d,a){b.Widget.prototype._setOption.apply(this,arguments);wijinputcore._setOption.apply(this,arguments);switch(d){case"text":this.setText(a);break;case"mask":case"culture":if(typeof a==="undefined"||a.length<=0)return;var c=this.getText();this._textProvider.mask=a;this._textProvider.initialMask=a;this._textProvider.initialize();this._textProvider.set(c);this._updateText();break;case"promptChar":if(!!this._textProvider){this._textProvider.updatePromptChar();this._updateText()}break;case"hidePromptOnLeave":case"resetOnPrompt":this._updateText();break;case"passwordChar":this.element.data("isPassword",(a+"").length>0);this._updateText()}},_resetData:function(){var b=this.options,a=this.element.data("defaultText");if(a===undefined||a===null)a=this.element.data("elementValue");if(a===undefined||a===null)a="";this.setText(a)},_isPassword:function(){return!!this.element.data("isPassword")},_getTextWithPrompts:function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,true,false)},_getTextWithLiterals:function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,false,true)},_getTextWithPromptAndLiterals:function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,true,true)},_onChange:function(){if(!this.element)return;var b=this.element.val(),a=this.getText();if(a!==b){a=this._getTextWithPrompts();if(a!==b){a=this._getTextWithPromptAndLiterals();a!==b&&this.setText(b)}}},_afterFocused:function(){(this._isNullText()||!!this.options.hidePromptOnLeave)&&this._doFocus()}}));var c=function(c,b,a){this.inputWidget=c;this.mask=b;this.asciiOnly=a;this.descriptors=[];this.noMask=false;this.initialize()};c.prototype={inputWidget:undefined,noMask:false,mask:"",testString:"",assignedCharCount:0,requiredCharCount:0,asciiOnly:false,initialize:function(){this.noMask=!this.mask||this.mask.length<=0;if(this.noMask)return;this.testString="";this.assignedCharCount=0;this.requiredCharCount=0;this.descriptors=new Array(0);for(var i="none",k=false,n=0,c=a.literal,e="",h=this.inputWidget._getCulture(),j=0;j<this.mask.length;j++){var b=false,g=this.mask.charAt(j);if(k){k=false;b=true}if(!b){var f=g;if(f<="C"){switch(f){case"#":case"9":case"?":case"C":g=this.getPromtChar();c=a.editOptional;b=true;break;case"$":e=h.numberFormat.currency.symbol;c=a.separator;b=true;break;case"%":case"-":case";":case"=":case"@":case"B":c=a.literal;b=true;break;case"&":case"0":case"A":g=this.getPromtChar();c=a.editRequired;b=true;break;case",":e=h.numberFormat[","];c=a.separator;b=true;break;case".":e=h.numberFormat["."];c=a.separator;b=true;break;case"/":e=h.calendars.standard["/"];c=a.separator;b=true;break;case":":e=h.calendars.standard[":"];c=a.separator;b=true;break;case"<":i="lower";continue;case">":i="upper";continue}if(!b){c=a.literal;b=true}}if(!b){if(f<="\\"){switch(f){case"L":g=this.getPromtChar();c=a.editRequired;b=true;break;case"\\":k=true;c=a.literal;continue}if(!b){c=a.literal;b=true}}if(!b){if(f==="a"){g=this.getPromtChar();c=a.editOptional;b=true}if(!b){if(f!=="|"){c=a.literal;b=true}if(!b){i="none";continue}}}}}if(b){var l=new d(j,c);if(this.isEditDesc(l))l.caseConversion=i;if(c!==a.separator)e=g;for(var m=0;m<e.length;m++){var o=e.charAt(m);this.testString=this.testString+o;this.descriptors[this.descriptors.length]=l;n++}}}this.testString.Capacity=this.testString.length},getAllowPromptAsInput:function(){return!!this.inputWidget?this.inputWidget.options.allowPromptAsInput:false},getPasswordChar:function(){return!!this.inputWidget?this.inputWidget.options.passwordChar:"*"},isPassword:function(){return!!this.inputWidget?this.inputWidget._isPassword():false},getResetOnPrompt:function(){return!!this.inputWidget?this.inputWidget.options.resetOnPrompt:true},getResetOnSpace:function(){return!!this.inputWidget?this.inputWidget.options.resetOnSpace:true},getSkipLiterals:function(){return!!this.inputWidget?this.inputWidget.options.skipLiterals:true},getHidePromptOnLeave:function(){return!!this.inputWidget?this.inputWidget.options.hidePromptOnLeave:false},_trueOR:function(a,b){return(a>>>1|b>>>1)*2+(a&1|b&1)},setValue:function(){return false},getValue:function(){return null},getPromtChar:function(){return!!this.inputWidget?this.inputWidget.options.promptChar:"_"},updatePromptChar:function(){if(this.noMask)return;for(var c=0;c<this.descriptors.length;c++){var d=this.descriptors[c];if(d.charType===a.editOptional||d.charType===a.editRequired)if(!d.isAssigned)this.testString=b.wij.charValidator.setChar(this.testString,this.getPromtChar(),c)}},resetChar:function(c){var d=this.descriptors[c];if(this.isEditPos(c)&&d.isAssigned){d.isAssigned=false;this.testString=b.wij.charValidator.setChar(this.testString,this.getPromtChar(),c);this.assignedCharCount--;if(d.charType===a.editRequired)this.requiredCharCount--}},getAdjustedPos:function(a){if(this.noMask){if(a>=this.testString.length)a=this.testString.length-1}else if(a>=this.descriptors.length)a=a-1;return Math.max(0,a)},incEnumPart:function(){return!this.noMask},decEnumPart:function(){return!this.noMask},findNonEditPositionInRange:function(c,d,b){return this.findPositionInRange(c,d,b,this._trueOR(a.literal,a.separator))},findPositionInRange:function(a,b,e,f){a=Math.max(0,a);b=Math.min(b,this.testString.length-1);if(a<=b)while(a<=b){var c=e?a++:b--,d=this.descriptors[c];if((d.charType&4294967295&f&4294967295)===d.charType)return c}return-1},findAssignedEditPositionInRange:function(c,d,b){return this.assignedCharCount===0?-1:this.findEditPositionInRange(c,d,b,a.editRequired)},findEditPositionInRange:function(c,d,e,g){do{var b=this.findPositionInRange(c,d,e,this._trueOR(a.editRequired,a.editOptional));if(b===-1)break;var f=this.descriptors[b];switch(g){case a.editOptional:if(!f.isAssigned)return b;break;case a.editRequired:if(f.isAssigned)return b;break;default:return b}if(e)c++;else d--}while(c<=d);return-1},findAssignedEditPositionFrom:function(d,c){if(!this.assignedCharCount)return-1;var a,b;if(c){a=d;b=this.testString.length-1}else{a=0;b=d}return this.findAssignedEditPositionInRange(a,b,c)},findEditPositionFrom:function(d,c){var a,b;if(c){a=d;b=this.testString.length-1}else{a=0;b=d}return this.findEditPositionInRange(a,b,c,0)},setChar:function(c,e,d){e=e<0?0:e;if(!d)d=this.descriptors[e];if(this.testEscapeChar(c,e,d))this.resetChar(e);else{if(b.wij.charValidator.isLetter(c))if(b.wij.charValidator.isUpper(c)){if(d.caseConversion==="lower")c=c.toLowerCase()}else if(d.caseConversion==="upper")c=c.toUpperCase();this.testString=b.wij.charValidator.setChar(this.testString,c,e);if(!d.isAssigned){d.isAssigned=true;this.assignedCharCount++;if(d.charType===a.editRequired)this.requiredCharCount++}}},internalInsertAt:function(h,e,a,j){if(h.length===0){a.testPosition=e;a.hint=a.noEffect;return true}if(!this._testString(h,e,a))return false;var b=this.findEditPositionFrom(e,true),g=this.findAssignedEditPositionInRange(b,a.testPosition,true)!==-1,k=this.findAssignedEditPositionFrom(this.testString.length-1,false);if(g&&a.testPosition===this.testString.length-1){a.hint=a.unavailableEditPosition;a.testPosition=this.testString.length;return false}var c=this.findEditPositionFrom(a.testPosition+1,true);if(g){var d=new wijInputResult;d.hint=d.unknown;var f=true;while(f){f=false;if(c===-1){a.hint=a.unavailableEditPosition;a.testPosition=this.testString.length;return false}var l=this.descriptors[b];if(l.isAssigned&&!this.testChar(this.testString.charAt(b),c,d)){a.hint=d.hint;a.testPosition=c;return false}if(b!==k){b=this.findEditPositionFrom(b+1,true);c=this.findEditPositionFrom(c+1,true);f=true;continue}}if(d.hint>a.hint)a.hint=d.hint}if(!j){if(g)while(b>=e){var i=this.descriptors[b];if(i.isAssigned)this.setChar(this.testString.charAt(b),c);else this.resetChar(c);c=this.findEditPositionFrom(c-1,false);b=this.findEditPositionFrom(b-1,false)}this.setString(h,e)}return true},insertAt:function(c,a,b){if(b===undefined)b=new wijInputResult;if(c===undefined)throw"InsertAt: input";if(this.noMask){this.testString=this.testString.substring(0,a)+c+this.testString.substring(a,this.testString.length);b.testPosition=a+c.length-1;return true}if(a>=0&&a<this.testString.length)return this.internalInsertAt(c,a,b,false);b.testPosition=a;b.hint=b.positionOutOfRange;return false},clear:function(a){if(this.noMask){this.testString="";a.hint=a.success;return}if(!this.assignedCharCount)a.hint=a.noEffect;else{a.hint=a.success;for(var b=0;b<this.testString.length;b++)this.resetChar(b)}},isLiteral:function(b){return!b?false:b.charType!==a.literal?b.charType===a.separator:true},testEscapeChar:function(b,a,c){a=a<0?0:a;if(!c)c=this.descriptors[a];return this.isLiteral(c)?this.getSkipLiterals()?b===this.testString.charAt(a):false:(!this.getResetOnPrompt()||b!==this.getPromtChar())&&(!this.getResetOnSpace()||b!==" ")?false:true},testChar:function(c,e,a){if(!b.wij.charValidator.isPrintableChar(c)){a.hint=a.invalidInput;return false}var d=this.descriptors[e];if(!d)return false;if(this.isLiteral(d)){if(this.getSkipLiterals()&&c===this.testString.charAt(e)){a.hint=a.characterEscaped;return true}a.hint=a.nonEditPosition;return false}if(c===this.getPromtChar()){if(this.getResetOnPrompt()){if(this.isEditDesc(d)&&d.isAssigned)a.hint=a.sideEffect;else a.hint=a.characterEscaped;return true}if(!this.getAllowPromptAsInput()){a.hint=a.promptCharNotAllowed;return false}}if(c===" "&&this.getResetOnSpace()){if(this.isEditDesc(d)&&d.isAssigned)a.hint=a.sideEffect;else a.hint=a.characterEscaped;return true}switch(this.mask.charAt(d.maskPosition)){case"L":if(!b.wij.charValidator.isLetter(c)){a.hint=a.letterExpected;return false}if(!b.wij.charValidator.isAsciiLetter(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"a":if(!b.wij.charValidator.isAlphanumeric(c)&&c!==" "){a.hint=a.alphanumericCharacterExpected;return false}if(!b.wij.charValidator.isAciiAlphanumeric(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"?":if(!b.wij.charValidator.isLetter(c)&&c!==" "){a.hint=a.letterExpected;return false}if(b.wij.charValidator.isAsciiLetter(c)||!this.asciiOnly)break;a.hint=a.asciiCharacterExpected;return false;case"A":if(!b.wij.charValidator.isAlphanumeric(c)){a.hint=a.alphanumericCharacterExpected;return false}if(b.wij.charValidator.isAciiAlphanumeric(c)||!this.asciiOnly)break;a.hint=a.asciiCharacterExpected;return false;case"C":if(!b.wij.charValidator.isAscii(c)&&this.asciiOnly&&c!==" "){a.hint=a.asciiCharacterExpected;return false}break;case"9":if(!b.wij.charValidator.isDigit(c)&&c!==" "){a.hint=a.digitExpected;return false}break;case"#":if(!b.wij.charValidator.isDigit(c)&&c!=="-"&&c!=="+"&&c!==" "){a.hint=a.digitExpected;return false}break;case"&":if(!b.wij.charValidator.isAscii(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"0":if(!b.wij.charValidator.isDigit(c)){a.hint=a.digitExpected;return false}}if(c===this.testString.charAt(e)&&d.isAssigned)a.hint=a.noEffect;else a.hint=a.success;return true},_testString:function(c,f,a){a.hint=a.unknown;a.testPosition=f;if(c.length){var b=new wijInputResult;b.testPosition=a.testPosition;b.hint=a.hint;for(var d=0;d<c.length;d++){var e=c.charAt(d);if(a.testPosition>this.testString.length){a.hint=a.unavailableEditPosition;return false}if(!this.testEscapeChar(e,a.testPosition)){a.testPosition=this.findEditPositionFrom(a.testPosition,true);if(a.testPosition===-1){a.testPosition=this.testString.length;a.hint=a.unavailableEditPosition;return false}}if(!this.testChar(e,a.testPosition,b)){a.hint=b.hint;return false}if(b.hint>a.hint)a.hint=b.hint;a.testPosition+=1;if(a.testPosition==this.testString.length)break}a.testPosition-=1}return true},"set":function(b,a){if(a===undefined)a=new wijInputResult;if(b===undefined)throw"SetFromPos: input parameter is null or undefined.";a.hint=a.unknown;a.testPosition=0;if(!b.length){this.clear(a);return true}if(this.noMask){this.testString=b;return true}if(!this.testSetString(b,a.testPosition,a))return false;var c=this.findAssignedEditPositionFrom(a.testPosition+1,true);c!==-1&&this.resetString(c,this.testString.length-1);return true},resetString:function(a,b){if(this.noMask){this.testString="";return}a=this.findAssignedEditPositionFrom(a,true);if(a!==-1){b=this.findAssignedEditPositionFrom(b,false);while(a<=b){a=this.findAssignedEditPositionFrom(a,true);this.resetChar(a);a++}}},setString:function(c,a){for(var b=0;b<c.length;b++){var d=c.charAt(b);if(!this.testEscapeChar(d,a))a=this.findEditPositionFrom(a,true);if(a<0||a>=this.testString.length)return;this.setChar(d,a);a++}},testSetString:function(a,b,c){if(a.length>this.testString.length)a=a.substring(0,this.testString.length);if(this._testString(a,b,c)){this.setString(a,b);return true}return false},toString:function(e,g,f,c,d){e=e===undefined?!this.isPassword():e;g=g===undefined?this.getHidePromptOnLeave()?this.inputWidget.isFocused():true:g;f=f===undefined?true:f;if(this.noMask){if(!e){for(var m="",l=0;l<this.testString.length;l++)m+=this.getPasswordChar();return m}return this.testString}c=c===undefined?0:c;d=d===undefined?this.testString.length:d;if(d<=0)return"";if(c<0)c=0;if(c>=this.testString.length)return"";var j=this.testString.length-c;if(d>j)d=j;if((!this.isPassword()||e)&&g&&f)return this.testString.substring(c,d-c);for(var b="",o=c+d-1,i=c;i<=o;i++){var h=this.testString.charAt(i),k=this.descriptors[i];switch(k.charType){case a.editOptional:case a.editRequired:if(!k.isAssigned)break;if(!this.isPassword()||e){b=b+h;continue}b=b+this.getPasswordChar();continue;case a.editRequired|a.editOptional:b=b+h;continue;case a.separator:case a.literal:if(!f)continue;b=b+h;continue;default:b=b+h;continue}if(g){b=b+h;continue}b=b+" ";continue}return b},isEditDesc:function(b){return this.noMask?true:b.charType!==a.editRequired?b.charType===a.editOptional:true},isEditPos:function(a){if(this.noMask)return true;if(a<0||a>=this.testString.length)return false;var b=this.descriptors[a];return this.isEditDesc(b)},internalRemoveAt:function(d,e,b,m){if(this.noMask){try{this.testString=this.testString.substring(0,d)+this.testString.substring(e+1,this.testString.length);b.testPosition=d}catch(q){}return true}var k=new wijInputResult,j,i,f=this.findAssignedEditPositionFrom(this.testString.length-1,false),c=this.findEditPositionInRange(d,e,true,0);b.hint=b.noEffect;if(c===-1||c>f){b.testPosition=d;return true}b.testPosition=d;var n=e<f;if(this.findAssignedEditPositionInRange(d,e,true)!==-1)b.hint=b.success;if(n){var a=this.findEditPositionFrom(e+1,true),o=a;d=c;var h=true;while(h){h=false;j=this.testString.charAt(a);var p=this.descriptors[a];if((j!==this.getPromtChar()||p.isAssigned)&&!this.testChar(j,c,k)){b.hint=k.hint;b.testPosition=c;return false}if(a!==f){a=this.findEditPositionFrom(a+1,true);c=this.findEditPositionFrom(c+1,true);h=true;continue}}if(b.sideEffect>b.hint)b.hint=b.sideEffect;if(m)return true;a=o;c=d;var g=true;while(g){g=false;i=this.testString.charAt(a);var l=this.descriptors[a];if(i===this.getPromtChar()&&!l.isAssigned)this.resetChar(c);else{this.setChar(i,c);this.resetChar(a)}if(a!==f){a=this.findEditPositionFrom(a+1,true);c=this.findEditPositionFrom(c+1,true);g=true;continue}}d=c+1}d<=e&&this.resetString(d,e);return true},removeAt:function(c,b,a){if(typeof b==="undefined")b=c;if(!a)a=new wijInputResult;if(b>=this.testString.length){a.testPosition=b;a.hint=a.positionOutOfRange;return false}if(c>=0&&c<=b)return this.internalRemoveAt(c,b,a,false);a.testPosition=c;a.hint=a.positionOutOfRange;return false}};var d=function(b,a){this.caseConversion="none";this.maskPosition=b;this.charType=a};d.prototype={isAssigned:false,maskPosition:0}})(jQuery);
(function(a){"use strict";a.widget("wijmo.wijinputnumber",a.extend(true,{},wijinputcore,{options:{type:"numeric",value:null,minValue:-1e9,maxValue:1e9,showGroup:false,decimalPlaces:2,increment:1,valueChanged:null,valueBoundsExceeded:null},_createTextProvider:function(){this._textProvider=new c(this,this.options.type)},_beginUpdate:function(){var a=this.options;this.element.addClass("wijmo-wijinput-numeric");this.element.data({defaultValue:a.value,preValue:a.value}).attr({"aria-valuemin":a.minValue,"aria-valuemax":a.maxValue,"aria-valuenow":a.value||0})},_onTriggerClicked:function(){this._popupComboList()},_setOption:function(c,b){a.Widget.prototype._setOption.apply(this,arguments);wijinputcore._setOption.apply(this,arguments);switch(c){case"minValue":this.element.attr("aria-valuemin",b);this._updateText();break;case"maxValue":this.element.attr("aria-valuemax",b);this._updateText();break;case"value":this.setValue(b);this._updateText();break;case"showGroup":case"decimalPlaces":case"culture":this._textProvider.updateStringFormat();this._updateText()}},_setData:function(a){this.setValue(a)},_resetData:function(){var a=this.element.data("defaultValue");if(a===undefined||a===null){a=this.element.data("elementValue");if(a===undefined||a===null&&a==="")a=0}this.setValue(a)},_validateData:function(){this._textProvider.checkAndRepairBounds(true,false)&&this._updateText()},_raiseDataChanged:function(){var a=this.options.value,b=this.element.data("preValue");this.element.data("preValue",a);if(b!==a){this.element.attr("aria-valuenow",a);this._trigger("valueChanged",null,{value:a})}},getValue:function(){var a=this._textProvider.getValue();if(a===undefined||a===null)a=this.getText();return a},setValue:function(a,b){try{b=!!b;if(typeof a==="boolean")a=a?"1":"0";else if(typeof a==="string")a=this._textProvider.tryParseValue(a);if(this._textProvider.setValue(a))this._updateText();else if(b){var c="";c=this.getText();this.setText(a);a=a.trim();var d=this.getText().trim();d!==a&&this.setText(c)}else this.setText(a);return true}catch(e){return false}},isValueNull:function(){try{return this._textProvider.isValueNull()}catch(a){return true}},_updateText:function(){if(!this._isInitialized())return;this.options.value=this._textProvider.getValue();wijinputcore._updateText.apply(this,arguments);!this._textProvider.checkAndRepairBounds(false,false)&&this._trigger("valueBoundsExceeded")},_doSpin:function(e,c){e=!!e;c=!!c;if(!this._allowEdit())return;if(c&&this.element.data("breakSpinner"))return;var d=this.element.wijtextselection(),b=new wijInputResult;if(this.element.data("focusNotCalledFirstTime")!==-9&&+new Date-this.element.data("focusNotCalledFirstTime")<600){this.element.data("focusNotCalledFirstTime",-9);this.element.data("prevCursorPos",0)}if(this.element.data("prevCursorPos")===-1)this.element.data("prevCursorPos",d.start);else d.start=this.element.data("prevCursorPos");b.testPosition=d.start;this._textProvider[e?"incEnumPart":"decEnumPart"](d.start,b,this.options.increment);this._updateText();this.element.data("prevCursorPos",b.testPosition);this.selectText(b.testPosition,b.testPosition);c&&!this.element.data("breakSpinner")&&window.setTimeout(a.proxy(function(){this._doSpin(e,true)},this),this._calcSpinInterval())}}));var c=function(a,c){this.inputWidget=a;this._type=c;this._stringFormat=new b(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture());this._stringFormat._setValueFromJSFloat(this.getValue())};c.prototype={_type:"numeric",_stringFormat:null,_getCulture:function(){return this.inputWidget._getCulture()},getDecimalSeparator:function(){return this._getCulture().numberFormat["."]},tryParseValue:function(a){return this._stringFormat.tryParseValue(a)},toString:function(){return this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&this.isValueNull()?this.inputWidget.options.nullText:this._stringFormat.getFormattedValue()},isValueNull:function(){var a=this.inputWidget.options,b=Math.max(0,a.minValue);return null===a.value||undefined===a.value||b===a.value},"set":function(a,b){this.clear();this.insertAt(a,0,b);return true},clear:function(){this._stringFormat.clear()},checkAndRepairBounds:function(a,c){var b=true;if(typeof a==="undefined")a=false;var d=this.inputWidget.options.minValue,e=this.inputWidget.options.maxValue;if(typeof c!=="undefined"&&c)return this._stringFormat.checkMinValue(d,false,true);if(!this._stringFormat.checkMinValue(d,a,false))b=false;if(!this._stringFormat.checkMaxValue(e,a))b=false;this.inputWidget.options.decimalPlaces>=0&&this._stringFormat.checkDigitsLimits(this.inputWidget.options.decimalPlaces);return b},countSubstring:function(c,b){var d=0,a=c.indexOf(b);while(a!==-1){d++;a=c.indexOf(b,a+1)}return d},getAdjustedPositionFromLeft:function(b){for(var e=this._stringFormat._currentText,c=0;c<e.length;c++){var d=e.charAt(c);if(!a.wij.charValidator.isDigit(d)&&d!==","&&d!=="."||d==="0"){if(this._stringFormat.isZero()){if(b<c)b++}else if(b<=c)b++}else break}return b},getDecimalSeparatorPos:function(){var a=this._stringFormat._currentText;return a.indexOf(this.getDecimalSeparator())},insertAt:function(b,d,c){var h=this._getCulture().numberFormat;if(b===h["."])b=h["."];if(!c)c=new wijInputResult;if(b.length===1){if(b==="+"){this._stringFormat.setPositiveSign();this.checkAndRepairBounds(true,false);return true}if(b==="-"||b===")"||b==="("){this._stringFormat.invertSign();this.checkAndRepairBounds(true,false);c.testPosition=d;if(this._stringFormat.isNegative())c.testPosition=d;else c.testPosition=d-2;return true}if(!a.wij.charValidator.isDigit(b)){if(b==="."){var j=this.getDecimalSeparatorPos();if(j>=0){c.testPosition=j;return true}}if(b!==","&&b!=="."&&b!==")"&&b!=="+"&&b!=="-"&&b!=="("&&b!==this.getDecimalSeparator())if(this._type==="percent"&&b===h.percent.symbol){c.testPosition=d;return true}else if(this._type==="currency"&&b===h.currency.symbol){c.testPosition=d;return true}else return false}}d=this.getAdjustedPositionFromLeft(d);var g=d,e=this._stringFormat._currentText;if(g>e.length)g=e.length-1;if(b.length===1)if(e.charAt(g)===b){c.testPosition=g;return true}var f=e.substring(0,g),i=e.substring(g,e.length);if(this._stringFormat.isZero())i=i.replace(new RegExp("[0]"),"");c.testPosition=f.length+b.length-1;this._stringFormat.deFormatValue(f+b+i);this.checkAndRepairBounds(true,false);try{if(b.length===1)if(this.inputWidget.options.showGroup){var l=this._stringFormat._currentText.substring(0,f.length);if(this.countSubstring(l,this._stringFormat._groupSeparator)!==this.countSubstring(f,this._stringFormat._groupSeparator))c.testPosition=c.testPosition+1}else{var k=f.charAt(f.length-1),m=this._stringFormat._currentText.charAt(c.testPosition-1);if(m!==k)c.testPosition=c.testPosition-1}}catch(n){}return true},removeAt:function(b,e,a){var f=this._getCulture().numberFormat;if(!a)a=new wijInputResult;a.testPosition=b;try{var c=this._stringFormat._currentText;if(b===e&&c.substring(b,e+1)===this.getDecimalSeparator())return false;var d=c.slice(0,b)+c.slice(e+1);if(d==="")d="0";this._stringFormat.deFormatValue(d);if(b===e&&this.inputWidget.options.showGroup)try{var g=this._stringFormat._currentText.substring(0,b);if(this.countSubstring(g,this._stringFormat._groupSeparator)!==this.countSubstring(d,this._stringFormat._groupSeparator)){a.testPosition=a.testPosition-1;if(c.indexOf(f.currency.symbol)===a.testPosition||c.indexOf(f.percent.symbol)===a.testPosition)a.testPosition=a.testPosition+1}}catch(h){}this.checkAndRepairBounds(true,false);return true}catch(i){}this.checkAndRepairBounds(true,false);return true},incEnumPart:function(c,a,b){if(!a)a=new wijInputResult;this._stringFormat.increment(b);return this.checkAndRepairBounds(true,false)},decEnumPart:function(c,a,b){if(!a)a=new wijInputResult;this._stringFormat.decrement(b);return this.checkAndRepairBounds(true,false)},getValue:function(){return this._stringFormat.getJSFloatValue()},setValue:function(a){try{this._stringFormat._setValueFromJSFloat(a);this.checkAndRepairBounds(true,false);return true}catch(b){return false}},updateStringFormat:function(){var a="0";if(typeof this._stringFormat!=="undefined")a=this._stringFormat._currentValueInString;this._stringFormat=new b(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture());this._stringFormat._currentValueInString=a}};var b=function(d,a,c,b){this.type=d;this.digitsPlaces=a;this.showGroup=c;this.culture=b};b.prototype={_currentValueInString:"0",_currentText:"0",_groupSeparator:" ",type:"numeric",digitsPlaces:0,showGroup:false,culture:null,isNegtive:function(a){return a.indexOf("-")!==-1||a.indexOf("(")!==-1},stripValue:function(a){var b=this.culture.numberFormat,g=this.isNegtive(a);a=a.replace("(","");a=a.replace(")","");a=a.replace("-","");a=a.replace(b.percent.symbol,"");a=a.replace(b.currency.symbol,"");var d=b[","],e=b["."];switch(this.type){case"percent":d=b.percent[","];e=b.percent["."];break;case"currency":d=b.currency[","];e=b.currency["."]}this._groupSeparator=d;var c=new RegExp("["+d+"]","g");a=a.replace(c,"");c=new RegExp("["+e+"]","g");a=a.replace(c,".");c=new RegExp("[ ]","g");a=a.replace(c,"");try{var h=new RegExp("([\\d\\.])+"),f=h.exec(a);if(f)a=f[0];if(g)a="-"+a;return a}catch(i){}return null},tryParseValue:function(a){a=this.stripValue(a);if(a===null)return 0;try{a=parseFloat(a);if(isNaN(a))a=0}catch(b){a=0}return a},deFormatValue:function(a){a=this.stripValue(a);if(a===null)return;this._currentValueInString=a;this._currentText=this.formatValue(a)},formatValue:function(c){var a=this.culture.numberFormat;c=""+c+"";var j=this.digitsPlaces,g=" ",e=".",f=2,i=this.isNegtive(c),d=new Array(3);d.push(3);var h="n";switch(this.type){case"numeric":h=i?a.pattern[0]:"n";g=a[","];e=a["."];f=a.decimals;d=a.groupSizes;break;case"percent":h=a.percent.pattern[i?0:1];g=a.percent[","];e=a.percent["."];f=a.percent.decimals;d=a.percent.groupSizes;break;case"currency":h=a.currency.pattern[i?0:1];g=a.currency[","];e=a.currency["."];f=a.currency.decimals;d=a.currency.groupSizes}if(j!==-2)f=j;if(!this.showGroup)d=[0];c=c.replace(new RegExp("^[0]+"),"");var b=this.formatDigit(c,g,e,f,d);b=b.replace(new RegExp("^[0]+"),"");if(b.indexOf(e)===0)b="0"+b;if(b==="")b="0";this._currentValueInString=c;this._currentText=this.applyFormatPattern(h,b,a.percent.symbol,a.currency.symbol);return this._currentText},getFormattedValue:function(){return this.formatValue(this._currentValueInString)},getJSFloatValue:function(){try{return this._currentValueInString===""?0:parseFloat(this._currentValueInString)}catch(a){return Number.NaN}},clear:function(){this._currentValueInString="0";this._currentText="0"},_setValueFromJSFloat:function(a){try{this._currentValueInString=""+a+"";this.formatValue(a);return true}catch(b){return false}},isZero:function(b){try{if(b===undefined)b=this._currentValueInString;var a=b.replace("-","");a=a.replace("(","");a=a.replace(")","");if(!a.length)a="0";var c=parseFloat(a);if(!isNaN(c)&&!c)return true}catch(d){}return false},setPositiveSign:function(){this._currentValueInString=this._currentValueInString.replace("-","");this._currentValueInString=this._currentValueInString.replace("(","");this._currentValueInString=this._currentValueInString.replace(")","")},isNegative:function(){return this._currentValueInString.indexOf("-")!==-1||this._currentValueInString.indexOf("(")!==-1},invertSign:function(){var a=this.isNegative();if(a)this.setPositiveSign();else this._currentValueInString=!this._currentValueInString.length?"0":"-"+this._currentValueInString;if(this.isZero())this._currentValueInString=a?"0":"-0";this.formatValue(this._currentValueInString)},increment:function(b){if(b===undefined)b=1;try{var a=this._currentValueInString.split(".");this._currentValueInString=a[0]*1+b+""+(a.length>1?"."+a[1]:"")}catch(c){}},decrement:function(b){if(b===undefined)b=1;try{var a=this._currentValueInString.split(".");this._currentValueInString=a[0]*1-b+""+(a.length>1?"."+a[1]:"")}catch(c){}},checkDigitsLimits:function(f){try{var a=this._currentValueInString.split(".");if(!a.length||a.length===1&&a[0]==="")return;var d="";if(a.length>1)d=a[1];for(var b="",c=0;c<f;c++){var e="0";if(d.length>c)e=d.charAt(c);b=b+e}if(b.length>0)this._currentValueInString=a[0]+"."+b;else this._currentValueInString=a[0]}catch(g){}},checkMinValue:function(g,i,h){if(typeof h==="undefined")h=false;var d=true;try{var a=this._currentValueInString.split("."),b=parseFloat(a[0]===""||a[0]==="-"?"0":a[0]),c=0;if(a.length>1&&parseFloat(a[1])>0)c=parseFloat("1."+a[1]);if(b<0||a[0]==="-")c=c*-1;g=""+g+"";a=g.split(".");var e=parseFloat(a[0]),f=0;if(a.length>1&&parseFloat(a[1])>0)f=parseFloat("1."+a[1]);if(b>e)return true;if(b<e||h&&b===e&&c<=f)d=false;else if(b===e&&b<0&&c>f)d=false;else if(b===e&&b>=0&&c<f)d=false;if(!d&&i)this._currentValueInString=""+g+""}catch(j){}return d},checkMaxValue:function(f,h){var c=true;try{var a=this._currentValueInString.split("."),b=parseFloat(a[0]===""||a[0]==="-"?"0":a[0]),d=0;if(a.length>1&&parseFloat(a[1])>0)d=parseFloat("1."+a[1]);if(b<0||a[0]==="-")d=d*-1;f=""+f+"";a=f.split(".");var e=parseFloat(a[0]),g=0;if(a.length>1&&parseFloat(a[1])>0)g=parseFloat("1."+a[1]);if(b<e)return true;if(b>e)c=false;if(b===e&&b>=0&&d>g)c=false;if(b===e&&b<0&&d<g)c=false;if(!c&&h)this._currentValueInString=""+f+""}catch(i){}return c},applyFormatPattern:function(f,e,d,c){var a=f,b=new RegExp("[n]","g");a=a.replace(b,e);b=new RegExp("[%]","g");a=a.replace(b,d);b=new RegExp("[$]","g");a=a.replace(b,c);return a},formatDigit:function(l,k,g,j,i){var a=""+l+"";a=a.replace("-","");a=a.replace("(","");a=a.replace(")","");var c=a.indexOf(g);if(c===-1)c=a.indexOf(".");if(c===-1)c=a.indexOf(",");if(c===-1)c=a.length;for(var b="",f=0,h=0,e,d=a.length-1;d>=0;d--){e=a.charAt(d);if(d<c){b=e+b;h++;if(h===i[f]*1&&i[f]*1&&d){b=k+b;h=0;if(i.length-1>f)f++}}}if(j>0){b=b+g;for(d=0;d<j;d++){e="0";if(d+c+1<a.length)e=a.charAt(d+c+1);b=b+e}}if(j===-1)if(c<a.length-1){b=b+g;b=b+a.substr(c+1)}return b}}})(jQuery);
(function(a){"use strict";a.widget("wijmo.wijgrid",{options:{allowColSizing:false,allowColMoving:false,allowKeyboardNavigation:false,allowPaging:false,allowSorting:false,allowEditing:false,alwaysParseData:true,columnsAutogenerationMode:"merge",cellStyleFormatter:undefined,columns:[],culture:"",customFilterOperators:[],data:null,ensureColumnsPxWidth:false,filterOperatorsSortMode:"alphabeticalCustomFirst",groupAreaCaption:"Drag a column here to group by that column.",groupIndent:10,nullString:undefined,pageIndex:0,pageSize:10,pagerSettings:{mode:"numeric",pageButtonCount:10,position:"bottom"},readAttributesFromData:false,rowStyleFormatter:undefined,scrollMode:"none",selectionMode:"singleRow",showFilter:false,showFooter:false,showGroupArea:false,showRowHeader:false,staticRowIndex:-1,afterCellEdit:null,afterCellUpdate:null,beforeCellEdit:null,beforeCellUpdate:null,columnDragging:null,columnDragged:null,columnDropping:null,columnDropped:null,columnGrouping:null,columnGrouped:null,columnResizing:null,columnResized:null,columnUngrouping:null,columnUngrouped:null,currentCellChanging:null,currentCellChanged:null,filterOperatorsListShowing:null,filtering:null,filtered:null,groupAggregate:null,groupText:null,invalidCellValue:null,pageIndexChanging:null,pageIndexChanged:null,selectionChanged:null,sorting:null,sorted:null,ajaxError:null,dataLoading:null,dataLoaded:null,loading:null,loaded:null,rendering:null,rendered:null},_staticColumnIndex:-1,_data$prefix:"wijgrid",_customSortOrder:1e3,_reverseKey:false,_pageSizeKey:10,_ajaxError:function(b,a,c){this._trigger("ajaxError",null,{XMLHttpRequest:b,textStatus:a,errorThrown:c});this.outerDiv.removeClass("wijmo-wijgrid-loading")},_dataLoading:function(){this._trigger("dataLoading");this.outerDiv.addClass("wijmo-wijgrid-loading")},_dataLoaded:function(a){this._trigger("dataLoaded");this.outerDiv.removeClass("wijmo-wijgrid-loading");this.doRefresh(a);this._trigger("loaded")},ensureControl:function(c,b){this._trigger("loading");if(!a.isPlainObject(b))b={data:null,afterRefresh:null,beforeRefresh:null};if(this._initialized){this._ownerise(false);this._widgetsToOptions()}else this._prepareColumnOptions(false);this._ownerise(true);if(c===true)this._dataStore.load(b);else{this.doRefresh(b);this._trigger("loaded")}},doRefresh:function(g){if(!this._initialized)try{this._prepareColumnOptions(true)}catch(n){throw n;}finally{this._ownerise(true);this._initialized=true}else g&&a.isFunction(g.beforeRefresh)&&g.beforeRefresh.apply(this);this._rebuildLeaves();var f=this._dataStore.getDataSlice(),m=f.data,k,c,h,d,b,e,j,i,l;a.each(this._field("leaves"),function(){this._totalsValue=f.totals?f.totals[this.dataKey]:undefined});this._setPageCount(f);k=this._field("leaves");this.dataTable=[];if(h=m.length)for(c=0;c<h;c++){d=m[c];b=[];for(e=0,j=k.length;e<j;e++){i=k[e];if(a.wijmo.wijgrid.validDataKey(i.dataKey)){b.push({value:d.values[i.dataKey],__attr:d.attributes?d.attributes.cellsAttributes[i.dataKey]:{},__style:{}});b.originalRowIndex=d.originalRowIndex}}b.rowType=a.wijmo.wijgrid.rowType.data;if(c%2!==0)b.rowType|=a.wijmo.wijgrid.rowType.dataAlt;b.__style={};b.__attr=d.attributes?d.attributes.rowAttributes:{};this.dataTable.push(b)}else if(f.emptyData&&(h=f.emptyData.length))for(c=0;c<h;c++){d=f.emptyData[c];b=[];l=this._field("visibleLeaves").length;for(e=0,j=d.length;e<j;e++)b.push({html:d[e],__attr:{colSpan:l>0&&c===h-1?l-c:1},__style:{}});b.rowType=a.wijmo.wijgrid.rowType.emptyDataRow;b.__style={};b.__attr={};this.dataTable.push(b)}this._trigger("rendering");this._refresh();this._trigger("rendered");g&&a.isFunction(g.afterRefresh)&&g.afterRefresh.apply(this)},_prepareColumnOptions:function(g){a.wijmo.wijgrid.traverse(this.options.columns,function(b){b.isBand=a.isArray(b.columns)||b.clientType==="c1band"});(new a.wijmo.wijgrid.bandProcessor)._getVisibleHeight(this.options.columns,true);var f=[],c,e=this._originalHeaderRowData(),d=this._originalFooterRowData(),b=(this.options.columnsAutogenerationMode||"").toLowerCase();if(g){c=this._dataStore.dataMode()===a.wijmo.wijgrid.dataMode.dom;b!=="none"&&new a.wijmo.wijgrid.columnsGenerator(this).generate(b,this._dataStore,this.options.columns)}a.wijmo.wijgrid.setTraverseIndex(this.options.columns);a.wijmo.wijgrid.traverse(this.options.columns,function(b){b.isBand=a.isArray(b.columns)||b.clientType==="c1band";a.wijmo.wijgrid.shallowMerge(b,a.wijmo.c1basefield.prototype.options);if(!b.isBand){a.wijmo.wijgrid.shallowMerge(b,a.wijmo.c1field.prototype.options);if(!b.clientType)b.clientType="c1field"}else b.clientType="c1band";b.isLeaf&&!b.isBand&&f.push(b)});this._field("leaves",f);g&&a.each(f,function(h,f){var g=typeof f.dataKey==="number"?f.dataKey:h;if(b==="merge"||f.dynamic===true)if(f.headerText===undefined)if(c&&e&&g<e.length)f.headerText=a.trim(e[g]);else if(a.wijmo.wijgrid.validDataKey(f.dataKey))f.headerText=""+f.dataKey;if(c&&d&&g<d.length)f._footerTextDOM=a.trim(d[g])})},_rebuildLeaves:function(){var b=[],d=[],c;if(this.options.showRowHeader){c=a.wijmo.wijgrid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:true,allowMoving:false,allowSizing:false,allowSort:false});c.owner=this;b.push(c)}a.each(this.options.columns,function(c,a){b.push(a)});this._field("spanTable",(new a.wijmo.wijgrid.bandProcessor).generateSpanTable(b,d));this._field("leaves",d);this._onLeavesCreated()},_onLeavesCreated:function(){var d=this._field("leaves"),c=0,b=0,e=this;this._field("visibleLeaves",a.grep(d,function(d,f){d.leavesIdx=f;if(a.wijmo.wijgrid.validDataKey(d.dataKey))d.dataIndex=c++;else d.dataIndex=-1;if(!d.isBand){e._ensureDataParser(d);if(a.isFunction(d.dataParser))d.dataParser=new d.dataParser}if(d.parentVis){d.visLeavesIdx=b++;return true}return false}))},_create:function(){if(!this.element.is("table"))throw"invalid markup";var b=this.element[0].style.height,c=this.element[0].style.width;this.rendered=false;this._dataStore=new a.wijmo.wijgrid.dataStore(this);this.element.addClass("wijmo-wijgrid-root");this.element.wrap('<div class="ui-widget wijmo-wijgrid ui-widget-content ui-corner-all"></div>');this.outerDiv=this.element.parent();b&&this.outerDiv.css("height",this.element[0].style.height);if(b!==""&&b!=="auto")this._autoHeight=false;else this._autoHeight=true;c&&this.outerDiv.css("width",this.element[0].style.width);if(c!==""&&c!=="auto")this._autoWidth=false;else this._autoWidth=true;this.element.css({height:"",width:""});this.filterOperatorsCache=new a.wijmo.wijgrid.filterOperatorsCache;this._registerFilterOperator(a.wijmo.wijgrid.embeddedFilters);this.options.disabled&&this.disable();this.cellFormatter=new a.wijmo.wijgrid.cellFormatterHelper;this.rowStyleFormatter=new a.wijmo.wijgrid.rowStyleFormatterHelper(this);this.cellStyleFormatter=new a.wijmo.wijgrid.cellStyleFormatterHelper(this)},_init:function(){this.$superPanelHeader=null;this.$topPagerDiv=null;this.$bottomPagerDiv=null;this.$groupArea=null;this.filterOperatorsCache.removeCustom();a.each(this.options.customFilterOperators,function(b,a){a.custom=true});this._registerFilterOperator(this.options.customFilterOperators);this._field("closestCulture",Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"));if(!this.options.data){!this._field("thead")&&this._field("thead",a.wijmo.wijgrid.readTableSection(this.element,1));!this._field("tfoot")&&this._field("tfoot",a.wijmo.wijgrid.readTableSection(this.element,3))}this._initialized=this._initialized||false;this.ensureControl(true)},_setOption:function(c,b){var g=this["_preset_"+c],e=this.options[c],f,d;if(g!==undefined)b=g.apply(this,[b,e]);f=b!==e;a.Widget.prototype._setOption.apply(this,[c,b]);if(f){d=this["_postset_"+c];d!==undefined&&d.apply(this,[b,e])}},destroy:function(){var b,c=this;this._view().dispose();this._detachEvents(true);(b=this._field("resizer"))&&b.dispose();a.wijmo.wijgrid.iterateChildrenWidgets(this.outerDiv,function(b,a){a!==c&&a.destroy()});this.element.insertBefore(this.outerDiv);this.outerDiv.remove();(b=this._field("selectionui"))&&b.dispose();(b=this._field("dragndrop"))&&b.dispose();a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix);a.Widget.prototype.destroy.apply(this,arguments)},columns:function(){return this._field("columns")||[]},currentCell:function(c,d){var b;if(arguments.length===0){b=this._field("currentCell");!b&&this._field("currentCell",b=a.wijmo.wijgrid.cellInfo.prototype.outsideValue);return b}else{b=arguments.length===1?c._clone():new a.wijmo.wijgrid.cellInfo(c,d);if(!b.isEqual(a.wijmo.wijgrid.cellInfo.prototype.outsideValue)){if(!b._isValid())throw"invalid arguments";b._clip(this._getDataCellsRange());if(b.rowIndex()>=0&&!(this.dataTable[b.rowIndex()].rowType&a.wijmo.wijgrid.rowType.data))return}b._setGridView(this);this._changeCurrentCell(b);return this._field("currentCell")}},data:function(){return this._dataStore.dataSource().items},selection:function(){var b=this._field("selection");!b&&this._field("selection",b=new a.wijmo.wijgrid.selection(this));return b},beginEdit:function(){return this._beginEditInternal(null)},endEdit:function(){return this._endEditInternal(null)},pageCount:function(){return this.options.allowPaging?this._field("pageCount")||1:1},_dragndrop:function(){var b=this._field("dragndrop");!b&&this._field("dragndrop",b=new a.wijmo.wijgrid.dragAndDropHelper(this));return b},_headerRows:function(){var b=this._field("headerRowsAccessor"),c;if(!b){c=this.options.showFilter?1:0;this._field("headerRowsAccessor",b=new a.wijmo.wijgrid.rowAccessor(this._view(),1,0,c))}return b},_filterRow:function(){if(this.options.showFilter){var b=new a.wijmo.wijgrid.rowAccessor(this._view(),1,0,0);return b.item(b.length()-1)}return null},_rows:function(){var b=this._field("rowsAccessor");!b&&this._field("rowsAccessor",b=new a.wijmo.wijgrid.rowAccessor(this._view(),2,0,0));return b},_selectionui:function(){var b=this._field("selectionui");!b&&this._field("selectionui",b=new a.wijmo.wijgrid.selectionui(this));return b},_setPageCount:function(a){this._field("pageCount",Math.ceil(a.totalRows/this.options.pageSize)||1)},_registerFilterOperator:function(c){var b,d;if(c&&a.isArray(c))for(b=0,d=c.length;b<d;b++)this.filterOperatorsCache.add(c[b]);else for(b=0,d=arguments.length;b<d;b++)this.filterOperatorsCache.add(arguments[b])},_postset_allowColMoving:function(c){var b=this;a.each(this.columns(),function(d,a){if(c)b._dragndrop().attach(a);else b._dragndrop().detach(a)});a.each(this._field("groupedWidgets"),function(d,a){if(c)b._dragndrop().attach(a);else b._dragndrop().detach(a)})},_postset_allowSorting:function(){this.ensureControl(false)},_postset_columns:function(){throw"read-only";},_postset_allowPaging:function(){this.ensureControl(true)},_postset_culture:function(){throw"read-only";},_postset_customFilterOperators:function(b){this.filterOperatorsCache.removeCustom();a.each(this.options.customFilterOperators,function(b,a){a.custom=true});this._registerFilterOperator(b)},_postset_data:function(){throw"read-only";},_postset_disabled:function(b){var c=this;a.wijmo.wijgrid.iterateChildrenWidgets(this.outerDiv,function(d,a){a!==c&&a.option("disabled",b)})},_postset_groupIndent:function(){this.ensureControl(false)},_postset_groupAreaCaption:function(b){var a=this._field("groupedColumns");this.$groupArea&&(!a||!a.length)&&this.$groupArea.html(b||"&nbsp;")},_preset_pageIndex:function(a,c){if(isNaN(a))throw"out of range";var b=this.pageCount();if(a>b-1)a=b-1;if(a<0)a=0;if(this.options.allowPaging&&a!==c)if(!this._onPageIndexChanging({newPageIndex:a}))a=c;return a},_postset_pageIndex:function(){this.options.allowPaging&&this.ensureControl(true,{afterRefresh:function(){this._onPageIndexChanged()}})},_preset_pageSize:function(a){if(isNaN(a))throw"out of range";if(a<=0)a=1;return a},_postset_pageSize:function(){this.options.pageIndex=0;this.options.allowPaging&&this.ensureControl(true)},_postset_pagerSettings:function(){this.ensureControl(false)},_postset_scrollMode:function(b,a){if(b==="none"||a==="none")this.ensureControl(false);else this._view().refreshPanel()},_postset_selectionMode:function(d){var c=this.selection(),b=this.currentCell();c.beginUpdate();c.clear();b&&b._isValid()&&c._selectRange(new a.wijmo.wijgrid.cellInfoRange(b,b),false,false,0,null);c.endUpdate();this._view().toggleDOMSelection(d==="none")},_postset_showFilter:function(){this.ensureControl(false)},_postset_showGroupArea:function(){this.ensureControl(false)},_postset_showRowHeader:function(){this.ensureControl(false)},_postset_staticRowIndex:function(){this.options.scrollMode!=="none"&&this.ensureControl(false)},_columnWidgetsFactory:function(e,b){var c,d=b.clientType;if(!d&&b.isBand)d="c1band";b=a.extend({owner:this},b,{disabled:this.options.disabled});switch(d){case"c1basefield":c=e.c1basefield(b);break;case"c1band":c=e.c1band(b);break;default:c=e.c1field(b)}return c},_field:function(c,b){return a.wijmo.wijgrid.dataPrefix(this.element[0],this._data$prefix,c,b)},_removeField:function(b){var a=this._data$prefix+b;this.element.removeData(a)},_changeRenderState:function(c,b,f){var d=a.wijmo.wijgrid.dataPrefix,e=d(c,this._data$prefix,"renderState");if(f){b=e|b;d(c,this._data$prefix,"renderState",b)}else{b=e&~b;d(c,this._data$prefix,"renderState",b)}return b},_prepareFilterRequest:function(d){var b=this._field("leaves"),c;if(!b)return[];c=a.map(b,a.proxy(function(b){if(!b.isBand&&a.wijmo.wijgrid.validDataKey(b.dataKey)&&b.filterOperator){var e=b.filterOperator.toLowerCase(),c;if(e!=="nofilter"&&(c=this.filterOperatorsCache.getByName(e)))if(a.inArray(b.dataType||"string",c.applicableTo)>=0)if(c.arity===1||c.arity>1&&b.filterValue!==undefined)return d?[{column:b,operator:c}]:[{dataKey:b.dataKey,filterOperator:b.filterOperator,filterValue:b.filterValue}]}return null},this));return c},_preparePageRequest:function(){return this.options.allowPaging?{pageIndex:this.options.pageIndex,pageSize:this.options.pageSize}:null},_prepareSortRequest:function(){var c=this._field("leaves"),b;if(!c||!this.options.allowSorting)return[];b=a.map(c,function(b){var c=null;if(!b.isBand&&b.allowSort&&a.wijmo.wijgrid.validDataKey(b.dataKey)){if(b.groupInfo&&b.groupInfo.position!=="none"&&b.sortDirection==="none")b.sortDirection="ascending";c=b.sortDirection==="ascending"||b.sortDirection==="descending"?[{dataKey:b.dataKey,sortDirection:b.sortDirection,sortOrder:b.sortOrder||0}]:null}return c});b.sort(function(a,b){return a.sortOrder-b.sortOrder});a.each(b,function(b,a){delete a.sortOrder});return b},_prepareTotalsRequest:function(d){var b=this._field("leaves"),c;if(!b||!this.options.showFooter)return[];c=a.map(b,function(b){return!b.isBand&&a.wijmo.wijgrid.validDataKey(b.dataKey)&&b.aggregate&&b.aggregate!=="none"?d?[{column:b,aggregate:b.aggregate}]:[{dataKey:b.dataKey,aggregate:b.aggregate}]:null});return c},_widgetsToOptions:function(){var b=a.wijmo.wijgrid.flatten(this.options.columns);a.each(this.columns(),function(e,c){delete c.options.columns;var d=b[c.options.travIdx];a.extend(true,d,c.options)})},_recreateColumnWidgets:function(){a.each(this.columns(),function(b,a){a.destroy()});var h=[],f=this._headerRows(),b,d,i,c,g,j,e;if(f&&f.length()){b=[];a.wijmo.wijgrid.traverse(this.options.columns,function(a){a.parentVis&&b.push(a)});for(d=0,i=b.length;d<i;d++){c=b[d];g=f.item(c.thY);j=(new a.wijmo.wijgrid.rowAccessor).getCell(g,c.thX);e=this._columnWidgetsFactory(a(j),c);h.push(e.data(e.data(a.wijmo.c1basefield.prototype._data$prefix+"widgetName")))}}this._field("columns",h)},_ownerise:function(b){if(b){var c=this;a.wijmo.wijgrid.traverse(this.options.columns,function(d){d.owner=c;var a,b,e;if(a=d.groupInfo){a.owner=d;if(a.expandInfo)for(b=0,e=a.expandInfo.length;b<e;b++)a.expandInfo[b].owner=a}})}else a.wijmo.wijgrid.traverse(this.options.columns,function(c){delete c.owner;var a,b,d;if(a=c.groupInfo){delete a.owner;if(a.expandInfo)for(b=0,d=a.expandInfo.length;b<d;b++)delete a.expandInfo[b].owner}})},_updateSplits:function(a){this._view().updateSplits!==null&&this._view().updateSplits(a)},_refresh:function(){var d,b,c,f={type:"",hScrollValue:null,vScrollValue:null},e=[];if(this._view())f=this._view().getScrollValue();this._detachEvents(false);this.element.detach();this.element.empty();this.outerDiv.empty();this.outerDiv.append(this.element);if(this._field("selectionui")){this._field("selectionui").dispose();this._field("selectionui",null)}this._field("headerRowsAccessor")&&this._field("headerRowsAccessor",null);this._field("rowsAccessor")&&this._field("rowsAccessor",null);this._field("resizer")&&this._field("resizer").dispose();(new a.wijmo.wijgrid.grouper).group(this,this.dataTable,this._field("leaves"));(new a.wijmo.wijgrid.merger).merge(this.dataTable,this._field("visibleLeaves"));if(this.options.scrollMode!=="none"&&(this._staticColumnIndex>=0||this.options.staticRowIndex>=0))this._field("view",d=new a.wijmo.wijgrid.fixedView(this));else this._field("view",d=new a.wijmo.wijgrid.flatView(this));this._render();this._ownerise(false);this._recreateColumnWidgets();this._ownerise(true);if(this.options.allowPaging){this.$topPagerDiv&&this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings());this.$bottomPagerDiv&&this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings())}this._attachEvents();d.focusableElement().attr("tabIndex",0);if(this.currentCell()._isValid()&&this.currentCell(this.currentCell()))this.currentCell()._isEdit(false);else this.currentCell(this._getFirstDataRowCell(0));this._field("selection",null);b=this.currentCell();if(b._isValid()){this.selection()._startNewTransaction(b);this.selection()._selectRange(new a.wijmo.wijgrid.cellInfoRange(b,b),false,false,0,null)}this._selectionui();c=new a.wijmo.wijgrid.resizer(this);a.each(this.columns(),function(d,b){var a=b.options;a.visible&&a.parentVis&&a.isLeaf&&c.addElement(b)});this._field("resizer",c);this.rendered=true;this._updateSplits(f);a.each(this.columns(),function(c,a){if(!a.options.isBand&&a.options.showFilter===true){var b=a._getFilterEditorWidth();b!==undefined&&e.push({widget:a,width:b})}});a.each(e,function(b,a){a.widget._setFilterEditorWidth(a.width)})},_render:function(){var c=this._view(),b;c.render();b=this.outerDiv;if(this.options.scrollMode!=="none")if(this.options.staticRowIndex>=0)b=this.outerDiv.find("div.wijmo-wijgrid-scroller:first");else b=this.outerDiv.find(".wijmo-wijgrid-content-area");this.$superPanelHeader=null;if(this.$topPagerDiv){this.$topPagerDiv.data("wijpager")&&this.$topPagerDiv.wijpager("destroy");this.$topPagerDiv.remove()}this.$topPagerDiv=null;if(this.options.allowPaging&&(this.options.pagerSettings.position==="top"||this.options.pagerSettings.position==="topAndBottom"))if(!this.$topPagerDiv){b.prepend(this.$superPanelHeader=a('<div class="wijmo-wijsuperpanel-header"></div>'));this.$superPanelHeader.prepend(this.$topPagerDiv=a('<div class="wijmo-wijgrid-header ui-widget-header ui-corner-top"></div>'))}if(this.options.showGroupArea)this._processGroupArea(b);else this.$groupArea=null;if(this.$bottomPagerDiv){this.$bottomPagerDiv.data("wijpager")&&this.$bottomPagerDiv.wijpager("destroy");this.$bottomPagerDiv.remove()}this.$bottomPagerDiv=null;if(this.options.allowPaging&&(this.options.pagerSettings.position==="bottom"||this.options.pagerSettings.position==="topAndBottom"))!this.$bottomPagerDiv&&b.append(this.$bottomPagerDiv=a('<div class="wijmo-wijgrid-footer wijmo-wijsuperpanel-footer ui-state-default ui-corner-bottom"></div>'))},_processGroupArea:function(e){var b=this,d=this._field("groupedColumns"),c=[];this.$groupArea=a('<div class="ui-widget-content ui-helper-clearfix"></div>');if(d.length>0)a.each(d,function(f,d){var e=a('<a href="#"></a>').appendTo(b.$groupArea);e.c1groupedfield(a.extend({owner:b},{allowMoving:d.allowMoving,allowSort:d.allowSort,dataIndex:d.dataIndex,headerText:d.headerText,isBand:d.isBand,isLeaf:d.isLeaf,linearIdx:d.linearIdx,parentIdx:d.parentIdx,sortDirection:d.sortDirection,travIdx:d.travIdx,groupedIndex:d.groupedIndex},{disabled:b.options.disabled}));c.push(e.data("c1groupedfield"))});else this.$groupArea.addClass("wijmo-wijgrid-group-area").html(this.options.groupAreaCaption||"&nbsp;");this._field("groupedWidgets",c);!this.$superPanelHeader&&e.prepend(this.$superPanelHeader=a('<div class="wijmo-wijsuperpanel-header"></div>'));this.$superPanelHeader.prepend(this.$groupArea);this._dragndrop().attachGroupArea(this.$groupArea)},_attachEvents:function(){var b=this._view(),c=b.focusableElement();c.bind("keydown."+this.widgetName,a.proxy(this._onKeyDown,this));c.bind("keypress."+this.widgetName,a.proxy(this._onKeyPress,this));a.each(b.subTables(),a.proxy(function(d,c){var b=c.element();if(b){b.tHead&&a(b.tHead).bind("click."+this.widgetName,a.proxy(this._onClick,this));b.tBodies.length&&a(b.tBodies[0]).bind("click."+this.widgetName,a.proxy(this._onClick,this)).bind("dblclick."+this.widgetName,a.proxy(this._onDblClick,this)).bind("mousemove."+this.widgetName,a.proxy(this._onMouseMove,this)).bind("mouseout."+this.widgetName,a.proxy(this._onMouseOut,this))}},this));a.each(b.getJoinedTables(true,0),a.proxy(function(d,b){if(b&&typeof b!=="number"){var c=b.element();a(c).find("> tbody").find("> tr.wijmo-wijgrid-groupheaderrow > td .wijmo-wijgrid-grouptogglebtn").bind("click."+this.widgetName,a.proxy(this._onGroupBtnClick,this))}},this))},_detachEvents:function(e){var b=this._view(),c=this,d;if(b){d=b.focusableElement();d.unbind("keydown."+this.widgetName);d.unbind("keypress."+this.widgetName);a.each(b.subTables(),function(){var b=this.element();if(b){b.tHead&&a(b.tHead).unbind("."+c.widgetName);b.tBodies.length&&a(b.tBodies[0]).unbind("."+c.widgetName)}});e&&a.each(b.getJoinedTables(true,0),function(d,b){b&&typeof b!=="number"&&a(b.element()).find("> tbody").find("> tr.wijmo-wijgrid-groupheaderrow > td .wijmo-wijgrid-grouptogglebtn").unbind("."+c.widgetName)})}},_handleSort:function(c,f){var g=this.options.columns,e=c.travIdx,d,b;if(c&&this.options.allowSorting){d=c.sortDirection==="none"?"ascending":c.sortDirection==="ascending"?"descending":"ascending";b={column:c,sortDirection:d};if(this._onColumnSorting(b)){b.column.sortDirection=b.sortDirection;if(f)b.column.sortOrder=this._customSortOrder++;else{this._customSortOrder=1e3;a.each(this.columns(),function(b,a){a.options.sortOrder=0;if(a.options.travIdx!==e&&!(a.options.groupInfo&&a.options.groupInfo.position!=="none"))a.options.sortDirection="none"});a.wijmo.wijgrid.traverse(g,function(a){a.sortOrder=0;if(a.travIdx!==e&&!(a.groupInfo&&a.groupInfo.position!=="none"))a.sortDirection="none"})}this.ensureControl(true,{afterRefresh:function(){this._onColumnSorted({column:b.column})}})}}},_pagerSettings2PagerWidgetSettings:function(){return a.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:a.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:a.proxy(this._onPagerWidgetPageIndexChanged,this)})},_handleDragnDrop:function(i,j,d,e,f){var c=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,i),b=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,j),g=e?"groupArea":"columns",h=f?"groupArea":"columns";if(f)this._onColumnGrouping({drag:c.found,drop:b?b.found:null,dragSource:g,dropSource:h,at:d})&&this.ensureControl(true,{beforeRefresh:function(){if(!b)c.found.groupedIndex=0;else switch(d){case"left":c.found.groupedIndex=b.found.groupedIndex-.5;break;case"right":c.found.groupedIndex=b.found.groupedIndex+.5}!e&&a.extend(true,c.found,{groupInfo:{position:"header"}})},afterRefresh:function(){this._onColumnGrouped({drag:c.found,drop:b?b.found:null,dragSource:g,dropSource:h,at:d})}});else this._onColumnDropping({drag:c.found,drop:b.found,at:d})&&this.ensureControl(false,{beforeRefresh:function(){c.at.splice(c.found.linearIdx,1);switch(d){case"left":if(c.at===b.at&&c.found.linearIdx<b.found.linearIdx)b.at.splice(b.found.linearIdx-1,0,c.found);else b.at.splice(b.found.linearIdx,0,c.found);break;case"right":if(c.at===b.at&&c.found.linearIdx<b.found.linearIdx)b.at.splice(b.found.linearIdx,0,c.found);else b.at.splice(b.found.linearIdx+1,0,c.found);break;case"center":b.found.columns.push(c.found)}a.wijmo.wijgrid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:c.found,drop:b.found,at:d})}})},_handleFilter:function(a,f,g){var c=this.filterOperatorsCache.getByName(f),b,e;if(c){if(c.arity>1){b=this._parse(a.options,g);e=b!==null&&(a.options.dataType==="string"||!isNaN(b))}else e=true;if(e){var d={column:a.options,operator:c.name,value:b};if(this._onColumnFiltering(d)){a.options.filterValue=d.value;a.options.filterOperator=d.operator;this.options.pageIndex=0;this.ensureControl(true,{afterRefresh:function(){this._onColumnFiltered({column:a.options})}})}}}},_handleUngroup:function(c){var b=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,c);if(b&&b.found){b=b.found;this._onColumnUngrouping({column:b})&&this.ensureControl(false,{beforeRefresh:function(){delete b.groupedIndex;a.extend(true,b,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:b})}})}},_onColumnDropping:function(a){return this._trigger("columnDropping",null,a)},_onColumnDropped:function(a){this._trigger("columnDropped",null,a)},_onColumnGrouping:function(a){return this._trigger("columnGrouping",null,a)},_onColumnGrouped:function(a){this._trigger("columnGrouped",null,a)},_onColumnUngrouping:function(a){return this._trigger("columnUngrouping",null,a)},_onColumnUngrouped:function(a){this._trigger("columnUngrouped",null,a)},_onColumnFiltering:function(a){return this._trigger("filtering",null,a)},_onColumnFiltered:function(a){this._trigger("filtered",null,a)},_onColumnSorting:function(a){return this._trigger("sorting",null,a)},_onColumnSorted:function(a){this._trigger("sorted",null,a)},_onCurrentCellChanged:function(){if(this.options.allowKeyboardNavigation){var a=this._field("currentCell");a&&!a.isEqual(a.outsideValue)&&this._view().scrollTo(a)}this._trigger("currentCellChanged")},_onPageIndexChanging:function(a){return this._trigger("pageIndexChanging",null,a)},_onPageIndexChanged:function(){this._trigger("pageIndexChanged")},_onPagerWidgetPageIndexChanging:function(b,a){a.handled=true},_onPagerWidgetPageIndexChanged:function(b,a){this._setOption("pageIndex",a.newPageIndex)},_onClick:function(d){if(!this._canInteract()||!d.target)return;var j=this._view(),i=this._getParentSubTable(d.target,["td","th"],j.subTables()),h,g,b,f=0,e,c;if(i){h=i[0];g=a(h).closest("tr");if(!(g.is(".wijmo-wijgrid-datarow")||g.is(".wijmo-wijgrid-headerrow")))return;if(!g.length)return;b=j.getAbsoluteCellInfo(h)._dataToAbs(this._getDataToAbsOffset());if(b.cellIndex()<0||b.rowIndex()<0)if(b.rowIndex()>=0){b=new a.wijmo.wijgrid.cellInfo(0,b.rowIndex());f=2}else{b=this._getFirstDataRowCell(b.cellIndex());f=1}this._changeCurrentCell(b);e=this.currentCell();c=this.selection();(!d.shiftKey||!c._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")&&c._startNewTransaction(e);c.beginUpdate();if(d.shiftKey&&d.ctrlKey)c._clearRange(new a.wijmo.wijgrid.cellInfoRange(e,e),f);else c._selectRange(new a.wijmo.wijgrid.cellInfoRange(c._anchorCell(),e),d.ctrlKey,d.shiftKey,f,null);c.endUpdate()}},_onDblClick:function(a){this._beginEditInternal(a)},_onGroupBtnClick:function(e){var g=a(e.target).closest("tr"),f=new a.wijmo.wijgrid.groupHelper,c=f.getGroupInfo(g[0]),d,b;if(c){d=f.getColumnByGroupLevel(this._field("leaves"),c.level);if(d){b=d.groupInfo.expandInfo[c.index];if(b.isExpanded)b.collapse(e.shiftKey);else b.expand(e.shiftKey);this._view().ensureWidth()}}},_onKeyDown:function(b){if(!this._canInteract)return true;var d=b.target.tagName.toLowerCase(),g=false,f,h,e,c;if((d==="input"||d==="option"||d==="select"||d==="textarea")&&a(b.target).closest("tr.wijmo-wijgrid-datarow").length===0)return true;if(this.options.allowEditing)if(b.which===113){this._beginEditInternal(b);return false}else if(b.which===a.ui.keyCode.ESCAPE&&this.currentCell()._isValid()&&this.currentCell()._isEdit()){this._endEditInternal(b);return false}if(!this.options.allowKeyboardNavigation)return true;switch(b.which){case a.ui.keyCode.LEFT:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.TAB:f=this._getNextCurrencyPos(this._getDataCellsRange(),this.currentCell(),b.keyCode,b.shiftKey);g=this._canMoveToAnotherCell(b.target,b.which)}if(g){h=this._changeCurrentCell(new a.wijmo.wijgrid.cellInfo(f.cellIndex,f.rowIndex));e=this.currentCell();c=this.selection();(!b.shiftKey||!c._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")&&c._startNewTransaction(e);c.beginUpdate();c._selectRange(new a.wijmo.wijgrid.cellInfoRange(c._anchorCell(),e),false,b.shiftKey,0,null);c.endUpdate();return false}return true},_onKeyPress:function(c){if(this._canInteract()&&this.options.allowEditing){var g=c.which,f=this.currentCell(),b,d,e;if(g&&f._isValid()&&!f._isEdit()){b=c.target.tagName.toLowerCase();if(b!=="input"&&b!=="option"&&b!=="select"&&b!=="textarea"){d=a(c.target).closest(".wijmo-wijgrid-table");if(d.length){e=a.map(this._view().subTables(),function(a){return a.element()});if(a.inArray(d[0],e)>=0)if(a.wij.charValidator.isPrintableChar(String.fromCharCode(g))){this._beginEditInternal(c);return false}}}}}},_onMouseMove:function(k){if(!this._canInteract())return;var i=this._view(),h=this._getParentSubTable(k.target,["td","th"],i.subTables()),g,e,f,b,d,c,j=a.wijmo.wijgrid.renderState;if(h){g=h[0];e=a(g).closest("tr");if(!e.length||e.is(".wijmo-wijgrid-foorow")||!(e.is(".wijmo-wijgrid-datarow")||e.is(".wijmo-wijgrid-headerrow")))return;f=i.getAbsoluteCellInfo(g)._dataToAbs(this._getDataToAbsOffset());b=this._field("hoveredRow");if(b!==undefined&&f.rowIndex()!==b){d=this._rows().item(b);if(d){c=this._createRowInfo(d);c.state=this._changeRenderState(c.$rows,j.hovered,false);this.rowStyleFormatter.format(c)}}b=f.rowIndex();this._field("hoveredRow",b);if(b>=0){d=this._rows().item(b);if(d){c=this._createRowInfo(d);c.state=this._changeRenderState(c.$rows,j.hovered,true);this.rowStyleFormatter.format(c)}}}},_onMouseOut:function(e){if(a(e.relatedTarget).closest(".wijmo-wijgrid-data").length===0){var d=this._field("hoveredRow"),c,b;if(d>=0){c=this._rows().item(d);if(c){b=this._createRowInfo(c);b.state=this._changeRenderState(b.$rows,a.wijmo.wijgrid.renderState.hovered,false);this.rowStyleFormatter.format(b)}}}},_fieldResized:function(b,c,a){if(c<0)c=0;if(a<=0)a=1;if(this._trigger("columnResizing",null,{column:b.options,oldWidth:c,newWidth:a})!==false){b.option("width",a);this._trigger("columnResized",null,{column:b.options})}},_changeCurrentCell:function(b){var d=null,a=this.currentCell(),c=this._getDataCellsRange(),f,e;if(c._isValid()&&c._containsCellInfo(b)||b.isEqual(b.outsideValue))if(a.cellIndex()!==b.cellIndex()||a.rowIndex()!==b.rowIndex()){f={cellIndex:b.cellIndex(),rowIndex:b.rowIndex(),oldCellIndex:a.cellIndex(),oldRowIndex:a.rowIndex()};if(this._trigger("currentCellChanging",null,f)){e=false;if(!this.options.allowEditing||!a._isEdit()||(e=this._endEditInternal(null))){c._containsCellInfo(a)&&this._changeCurrentCellUI(a,false);a=b._clone();a._setGridView(this);d=this._changeCurrentCellUI(a,true);this._field("currentCell",a);this._onCurrentCellChanged()}}}else d=this._changeCurrentCellUI(a,true);return d},_changeCurrentCellUI:function(b,l){if(b&&!b.isEqual(b.outsideValue)){var h=this._view(),o=this._field("visibleLeaves"),n=this._getDataToAbsOffset(),c=b.cellIndex()+n.x,i=b.rowIndex()+n.y,e,d,j,f,m,k=a.wijmo.wijgrid.renderState,g;if(i>=0){j=h.getJoinedRows(i,0);if(j){f=this._createRowInfo(j);f.state=this._changeRenderState(f.$rows,k.current,l);this.rowStyleFormatter.format(f)}if(c>=0&&c<o.length){e=h.getHeaderCell(c);if(e){m=this._createRowInfo(this._headerRows().item(b.column().thY));d=a(e);g=this._changeRenderState(d,k.current,l);this.cellStyleFormatter.format(d,c,b.column(),m,g)}e=h.getCell(c,i);if(e){d=a(e);g=this._changeRenderState(d,k.current,l);this.cellStyleFormatter.format(d,c,b.column(),f,g)}}return h.getCell(c,i)}}return null},_beginEditInternal:function(d){if(this._canInteract()&&this.options.allowEditing){var c=this.currentCell().column(),b;if(c&&!c.readOnly){b=(new a.wijmo.wijgrid.cellEditorHelper).currentCellEditStart(this,d);b;return b}}return false},_endEditInternal:function(c){if(this._canInteract()&&this.options.allowEditing){var b=(new a.wijmo.wijgrid.cellEditorHelper).currentCellEditEnd(this,c);b;return b}return false},_createRow:function(a){return a.insertRow(-1)},_createCell:function(c){var b=a.wijmo.wijgrid.rowType;switch(c){case b.header:return'<th><div class="wijmo-wijgrid-innercell"></div></th>';case b.filter:return"<td />";default:return'<td><div class="wijmo-wijgrid-innercell"></div></td>'}},_cellCreated:function(b,d,f,e,c,h,g){a.wijmo.wijgrid.dataPrefix(b,this._data$prefix,"renderState",c);this.cellStyleFormatter.format(b,d,f,e,c,h,g);this._changeRenderState(b,a.wijmo.wijgrid.renderState.rendering,false)},_rowCreated:function(b,d,c){a.wijmo.wijgrid.dataPrefix(true,b.$rows,this._data$prefix,{dataTableRowIndex:b._dataTableRowIndex,dataRowIndex:b.dataRowIndex,rowType:b.type,dataItemIndex:b.dataItemIndex,virtualDataItemIndex:b.virtualDataItemIndex,renderState:b.state});this.rowStyleFormatter.format(b,d,c);this._changeRenderState(b.$rows,a.wijmo.wijgrid.renderState.rendering,false)},_createRowInfo:function(j,i,h,d,g,f,e){var m=this.dataTable,l=null,b=j[1]?a(j):a(j[0]),k,c=a.wijmo.wijgrid.dataPrefix;if(isNaN(i))i=c(b,this._data$prefix,"rowType");if(isNaN(h))h=c(b,this._data$prefix,"renderState");if(isNaN(d))d=c(b,this._data$prefix,"dataTableRowIndex");if(isNaN(g))g=c(b,this._data$prefix,"dataRowIndex");if(isNaN(f))f=c(b,this._data$prefix,"dataItemIndex");if(isNaN(e))e=c(b,this._data$prefix,"virtualDataItemIndex");if(d>=0){k=m[d].originalRowIndex;if(k>=0)l=this.data()[k]}return{$rows:b,state:h,type:i,data:l,dataRowIndex:g,dataItemIndex:f,virtualDataItemIndex:e,_dataTableRowIndex:d}},_ensureDataParser:function(b){switch(b.dataType){case undefined:case"string":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.stringParser;break;case"boolean":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.boolParser;break;case"number":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.numberParser;break;case"currency":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.currencyParser;break;case"datetime":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.dateTimeParser;break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported dataType value: "{0}"',b.dataType);}},_parseDOM:function(a,b){return a.dataParser.parseDOM(b,this._field("closestCulture"),a.dataFormatString,this.options.nullString,true)},_parse:function(b,c){var a=b.dataParser.parse(c,this._field("closestCulture"),b.dataFormatString,this.options.nullString,true);switch(b.dataType){case"datetime":if(a!==null&&!(a instanceof Date))throw"invalid value.";break;case"number":case"currency":if(a!==null&&(typeof a!=="number"||isNaN(a)))throw"invalid value.";break;case"boolean":if(a!==null&&(typeof a!=="boolean"||isNaN(a)))throw"invalid value.";}return a},_toStr:function(a,b){return a.dataParser.toStr(b,this._field("closestCulture"),a.dataFormatString,this.options.nullString,true)},_funcOptions:function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","ajaxError","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},_canInteract:function(){return!this.options.disabled},_canMoveToAnotherCell:function(d,c){var h=d.tagName.toLowerCase(),f,e,b,g;switch(h){case"input":if(a(d).hasClass("wijgridinput")){if(d.type==="text"){f=d.value.length;e=new a.wijmo.wijgrid.domSelection(d).getSelection();b=a.ui.keyCode;g=c===b.UP||c===b.DOWN||c===b.PAGE_DOWN||c===b.PAGE_UP||e.length===0&&(e.start===0&&(c===b.LEFT||c===b.HOME)||e.end>=f&&(c===b.RIGHT||c===b.END));return g}return true}return false;case"textarea":case"select":return false}return true},_getDataToAbsOffset:function(){var c=0,a=0,b=this._headerRows();if(this.options.showRowHeader)c++;if(b)a+=b.length();if(this._filterRow())a++;return{x:c,y:a}},_getDataCellsRange:function(){var d=0,e=0,b=this._field("visibleLeaves").length-1,c=this.dataTable.length-1;if(this.options.showRowHeader)b--;if(b<0||c<0)d=e=b=c=-1;return new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(d,e),new a.wijmo.wijgrid.cellInfo(b,c))},_getFirstDataRowCell:function(d){for(var c,e=a.wijmo.wijgrid.rowType,b=0;c=this.dataTable[b];b++)if(c.rowType&e.data)return new a.wijmo.wijgrid.cellInfo(d,b);return a.wijmo.wijgrid.cellInfo.prototype.outsideValue},_getNextCurrencyPos:function(b,f,h,g){var d=f.cellIndex(),c=f.rowIndex(),e;switch(h){case a.ui.keyCode.PAGE_UP:if(this._reverseKey&&c===b.topLeft().rowIndex())c=b.bottomRight().rowIndex();else{c-=this._pageSizeKey;if(c<(e=b.topLeft().rowIndex()))c=e}break;case a.ui.keyCode.PAGE_DOWN:if(this._reverseKey&&c===b.bottomRight().rowIndex())c=b.TopLeft().RowIndex();else{c+=this._pageSizeKey;if(c>(e=b.bottomRight().rowIndex()))c=e}break;case a.ui.keyCode.END:d=this._reverseKey&&d===b.bottomRight().cellIndex()?b.topLeft().cellIndex():b.bottomRight().cellIndex();break;case a.ui.keyCode.HOME:d=this._reverseKey&&d===b.topLeft().cellIndex()?b.bottomRight().cellIndex():b.topLeft().cellIndex();break;case a.ui.keyCode.LEFT:if(d>b.topLeft().cellIndex())d--;else if(this._reverseKey)d=b.bottomRight().cellIndex();break;case a.ui.keyCode.UP:if(c>b.topLeft().rowIndex())c--;else if(this._reverseKey)c=b.bottomRight().rowIndex();break;case a.ui.keyCode.RIGHT:if(d<b.bottomRight().cellIndex())d++;else if(this._reverseKey)d=b.topLeft().cellIndex();break;case a.ui.keyCode.ENTER:case a.ui.keyCode.DOWN:if(c<b.bottomRight().rowIndex())c++;else if(this._reverseKey)c=b.topLeft().rowIndex();break;case a.ui.keyCode.TAB:if(0)if(g){d--;if(d<b.topLeft().cellIndex()){d=b.bottomRight().cellIndex();c--;if(c<b.topLeft().rowIndex())c=b.bottomRight().rowIndex()}}else{d++;if(d>b.bottomRight().cellIndex()){d=b.topLeft().cellIndex();c++;if(c>b.bottomRight().rowIndex())c=b.topLeft().rowIndex()}}}return{cellIndex:d,rowIndex:c}},_getParentSubTable:function(b,g,h){for(var f=a.map(h,function(a){return a.element()}),c=null,d=null,e;b!==null&&c===null;b=b.parentNode){e=b.tagName?b.tagName.toLowerCase():undefined;if(a.inArray(e,g)>=0)d=b;else if(a.inArray(b,f)>=0)c=b}return d&&c?[d,c]:null},_getRealStaticColumnIndex:function(){if(this._staticColumnIndex>=0){var b=this._field("visibleLeaves"),c=b.length,a=this._staticColumnIndex;if(this.options.showRowHeader===true)a++;for(;a<c;a++)if(b[a].parentIdx===-1)return a;return c-1}return this._staticColumnIndex},_getRealStaticRowIndex:function(){if(this.options.staticRowIndex>=0){var a=this._field("spanTable").length-1;if(this.options.showFilter)a++;return a}else return this.options.staticRowIndex},_view:function(){return this._field("view")},_originalFooterRowData:function(){var a=this._field("tfoot");return a&&a.length?a[0]:null},_originalHeaderRowData:function(){var a=this._field("thead");return a&&a.length?a[0]:null}})})(jQuery);(function(a){"use strict";a.widget("wijmo.c1basefield",{_data$prefix:"c1basefield",options:{allowMoving:true,allowSizing:true,dataKey:undefined,cellFormatter:undefined,footerText:undefined,headerText:undefined,visible:true,width:undefined},_create:function(){var a=this.options.owner;this.element.addClass("ui-widget wijmo-c1basefield ui-state-default");this._field("owner",a);delete this.options.owner;this._field("widgetName",this.widgetName);this.options.disabled&&this.disable();a.options.allowColMoving&&a._dragndrop().attach(this)},_init:function(){this.element.wrapInner("<div class='wijmo-wijgrid-innercell'></div>");this._refreshHeaderCell()},destroy:function(){var b=this._owner();b&&b._dragndrop().detach(this);a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix)},_field:function(c,b){return a.wijmo.wijgrid.dataPrefix(this.element[0],this._data$prefix,c,b)},_removeField:function(b){var a=this._data$prefix+b;this.element.removeData(a)},_setOption:function(c,b,f){var h=this["_preset_"+c],e=this.options[c],g,d;if(h!==undefined)b=h.apply(this,[b,e,f]);g=b!==e;a.Widget.prototype._setOption.apply(this,[c,b]);if(g){d=this["_postset_"+c];d!==undefined&&d.apply(this,[b,e,f])}},_postset_allowMoving:function(b,c,a){this._invokeGroupedColumn("allowMoving",b,a)},_preset_clientType:function(){throw"read-only";},_postset_headerText:function(b,c,a){this._refreshHeaderCell();this._invokeGroupedColumn("headerText",b,a)},_postset_visible:function(){this._owner().ensureControl(false)},_postset_width:function(a){this._owner()._view().ensureWidth(a,this.options.visLeavesIdx)},_invokeGroupedColumn:function(d,c,a){if(!a&&this.options.groupedIndex!==undefined){var b=this._owner()._field("groupedWidgets")[this.options.groupedIndex];b._setOption(d,c,true)}},_owner:function(){return this._field("owner")},_canSize:function(){return this.options.allowSizing&&this._owner().options.allowColSizing},_canDrag:function(){return this.options.allowMoving===true},_canDropTo:function(b){return a.wijmo.wijgrid.isChildOf(this._owner().options.columns,b,this)?false:true},_refreshHeaderCell:function(){var a=this.element.children(".wijmo-wijgrid-innercell").empty().html(this.options.headerText||"").wrapInner('<span class="wijmo-wijgrid-headertext" />')}})})(jQuery);(function(a){"use strict";a.widget("wijmo.c1field",a.wijmo.c1basefield,{options:{aggregate:"none",allowSort:true,dataType:"string",dataParser:undefined,dataFormatString:undefined,filterOperator:"nofilter",filterValue:undefined,groupInfo:{expandInfo:[],groupSingleRow:true,collapsedImageClass:"ui-icon-triangle-1-e",expandedImageClass:"ui-icon-triangle-1-se",position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},readOnly:false,rowMerge:"none",showFilter:true,sortDirection:"none",valueRequired:false},_create:function(){a.wijmo.c1basefield.prototype._create.apply(this,arguments);this.element.addClass("ui-widget wijmo-c1field")},destroy:function(){this.element.find("*").unbind("."+this.widgetName);if(this.$filterEditor){this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate("destroy");break;case"mask":this.$filterEditor.wijinputmask("destroy");break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.wijinputnumber("destroy")}this.$filterEditor=null}this._removeDropDownFilterList();a.wijmo.c1basefield.prototype.destroy.apply(this,arguments)},_init:function(){a.wijmo.c1basefield.prototype._init.apply(this,arguments);this.$filterEditor=null;var b=this._owner();this.filterRow=b._filterRow();b.options.showFilter&&this.options.showFilter&&this.options.dataIndex>=0&&this._prepareFilterCell()},_postset_aggregate:function(){this._owner().ensureControl(false)},_postset_allowSort:function(b,c,a){this._refreshHeaderCell();this._invokeGroupedColumn("allowSort",b,a)},_postset_dataType:function(){throw"read-only";},_postset_dataParser:function(){this._owner().ensureControl(false)},_postset_dataFormatString:function(){this._owner().ensureControl(false)},_postset_filterOperator:function(){this._owner().ensureControl(true)},_postset_filterValue:function(){this._owner().ensureControl(true)},_postset_groupInfo:function(){this._owner().ensureControl(true)},_postset_rowMerge:function(){this._owner().ensureControl(false)},_postset_showFilter:function(){this._owner().ensureControl(false)},_postset_sortDirection:function(){this.options.sortOrder=0;this._owner().ensureControl(true)},_postset_width:function(){this._setFilterEditorWidth(1);a.wijmo.c1basefield.prototype._postset_width.apply(this,arguments);this._setFilterEditorWidth(this._getFilterEditorWidth())},_canDropTo:function(b){return a.wijmo.c1basefield.prototype._canDropTo.apply(this,arguments)?this.options.groupedIndex!==undefined&&b instanceof a.wijmo.c1groupedfield?false:true:false},_canSort:function(){var a=this._owner();return a&&a.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},_refreshHeaderCell:function(){if(this._canSort()){var b,c=this.element.children(".wijmo-wijgrid-innercell").empty().html(this.options.headerText||"").wrapInner('<a class="wijmo-wijgrid-headertext" href="#" role="button" />');b=c.children("a").bind("click."+this.widgetName,this,this._onHrefClick);switch(this.options.sortDirection){case"ascending":b.append(a('<span class="ui-icon ui-icon-triangle-1-n">ascending</span>'));break;case"descending":b.append(a('<span class="ui-icon ui-icon-triangle-1-s">descending</span>'))}}else a.wijmo.c1basefield.prototype._refreshHeaderCell.apply(this,arguments)},_prepareFilterCell:function(){var f=this.options.visLeavesIdx,e=null,d=null,b,c,g;if(f>=0){e=this._owner();if(this.filterRow)d=a((new a.wijmo.wijgrid.rowAccessor).getCell(this.filterRow,f));else throw"exception";d.find(".wijmo-wijgrid-filtericon").attr("class",this._getFilterOpIconCss(e,this.options.filterOperator));this.$filterEditor=d.find("input");d.bind(a.support.selectstart?"selectstart":"mousedown",function(a){a.stopPropagation()});b=e._parse(this.options,this.options.filterValue);if(b===null)switch(this.options.dataType){case"boolean":b=false;break;case"number":case"currency":case"datetime":b=0;break;default:b=""}c={culture:e.options.culture,disabled:e.options.disabled,decimalPlaces:function(b){var a=/^(n|p|c){1}(\d*)$/.exec(b);if(a)if(a[2])return parseInt(a[2],10);return 2}(this.options.dataFormatString)};switch(g=this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate(a.extend(c,{date:b}));break;case"mask":this.$filterEditor.wijinputmask({text:b});break;case"numberCurrency":this.$filterEditor.wijinputnumber(a.extend(c,{type:"currency",value:b}));break;case"numberNumber":this.$filterEditor.wijinputnumber(a.extend(c,{value:b}));break;case"numberPercent":this.$filterEditor.wijinputnumber(a.extend(c,{type:"percent",value:b*100}));break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported editor type: "{0}"',g);}d.find(".wijmo-wijgrid-filter-trigger").attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(){a(this).addClass("ui-state-hover")}).bind("mouseleave."+this.widgetName,function(){a(this).removeClass("ui-state-hover ui-state-active")}).bind("mouseup."+this.widgetName,this,function(){a(this).removeClass("ui-state-active")}).bind("mousedown."+this.widgetName,{column:this},this._onFilterBtnClick).bind("click."+this.widgetName,function(a){a.preventDefault()})}},_onFilterBtnClick:function(k){var b=k.data.column,c,i,g,d,f,h,e,j;if(b.options.disabled)return false;if(b.$dropDownFilterList){b._removeDropDownFilterList();return false}c=b._owner();i=b.options.filterOperator.toLowerCase();g=c.filterOperatorsCache.getByDataType(b.options.dataType);c.filterOperatorsCache.sort(g,c.options.filterOperatorsSortMode);d=a.extend(true,{},{operators:g,column:b.options});c._trigger("filterOperatorsListShowing",null,d);f=[];if(d.operators)for(h in d.operators)if(d.operators.hasOwnProperty(h)){e=d.operators[h];f.push({label:e.name,value:e.name,selected:e.name.toLowerCase()===i})}b.$dropDownFilterList=a('<div class="wijmo-wijgrid-filterlist"></div').appendTo(document.body).wijlist({autoSize:true,maxItemsCount:8,selected:function(f,e){var a,d;switch(d=b._getInputEditorType(b.options)){case"date":a=b.$filterEditor.wijinputdate("option","date");break;case"mask":a=b.$filterEditor.wijinputmask("option","text");break;case"numberCurrency":case"numberNumber":case"numberPercent":a=b.$filterEditor.wijinputnumber("option","value");if(d==="numberPercent")a/=100}b._removeDropDownFilterList();c._handleFilter(b,e.item.value,a)}});b.$dropDownFilterList.wijlist("setItems",f).wijlist("renderList");f.length>8&&b.$dropDownFilterList.width(b.$dropDownFilterList.width()+20);b.$dropDownFilterList.$button=a(this);b.$dropDownFilterList.wijlist("refreshSuperPanel").position({of:a(this),my:"left top",at:"left bottom"});j=b.$dropDownFilterList.eventGuid=+new Date;a(document).bind("mousedown."+b.widgetName+"."+j,{column:b},b._onDocMouseDown)},_getFilterOpIconCss:function(d,c){var b="filter-nofilter",a=d.filterOperatorsCache.getByName(c.toLowerCase());if(a)if(a.css)b=a.css;else b="filter-"+a.name.toLowerCase();return"wijmo-wijgrid-filtericon "+b},_onDocMouseDown:function(c){var b=a(c.target),e=b.parents(".wijmo-wijgrid-filterlist:first"),d=b.is(".wijmo-wijgrid-filter-trigger")?b:b.parents(".wijmo-wijgrid-filter-trigger:first");!(d.length&&d[0]===c.data.column.$dropDownFilterList.$button[0]||e.length&&e[0]===c.data.column.$dropDownFilterList[0])&&c.data.column._removeDropDownFilterList()},_onHrefClick:function(a){if(a.data.options.disabled)return false;a.data.options.allowSort&&a.data._owner()._handleSort(a.data.options,a.ctrlKey);return false},_removeDropDownFilterList:function(){if(this.$dropDownFilterList){var b=this.$dropDownFilterList.eventGuid;this.$dropDownFilterList.remove();this.$dropDownFilterList=null;a(document).unbind("mousedown."+this.widgetName+"."+b,this._onDocMouseDown)}},_getFilterEditorWidth:function(){if(this.$filterEditor){var b=this.$filterEditor.closest(".wijmo-wijgrid-filter"),a=b.width()-b.find(".wijmo-wijgrid-filtericon").outerWidth();if(!a||a<0)a=0;return a}return undefined},_setFilterEditorWidth:function(a){if(this.$filterEditor){a-=this.$filterEditor.leftBorderWidth()+this.$filterEditor.rightBorderWidth();if(a<0)a=0;switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate("widget").width(a);break;case"mask":this.$filterEditor.wijinputmask("widget").width(a);break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.wijinputnumber("widget").width(a)}this.$filterEditor.setOutWidth(a)}},_getInputEditorType:function(a){switch(a.dataType){case"number":return a.dataFormatString&&a.dataFormatString.indexOf("p")===0?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"mask"}}})})(jQuery);(function(a){"use strict";a.widget("wijmo.c1groupedfield",{_data$prefix:"c1groupedfield",options:{allowMoving:true,allowSort:true,headerText:undefined,sortDirection:"none"},_create:function(){var a=this.options.owner;this.element.addClass("wijmo-wijgrid-group-button ui-state-default ui-corner-all");this._field("owner",a);delete this.options.owner;this.options.disabled&&this.disable();a.options.allowColMoving&&a._dragndrop().attach(this)},_init:function(){this._refreshHeaderCell()},destroy:function(){this.element.find("*").unbind("."+this.widgetName);var b=this._owner();b&&b._dragndrop().detach(this);a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix)},_field:function(c,b){return a.wijmo.wijgrid.dataPrefix(this.element[0],this._data$prefix,c,b)},_removeField:function(b){var a=this._data$prefix+b;this.element.removeData(a)},_setOption:function(c,b,f){var h=this["_preset_"+c],e=this.options[c],g,d;if(h!==undefined)b=h.apply(this,[b,e,f]);g=b!==e;a.Widget.prototype._setOption.apply(this,[c,b]);if(g){d=this["_postset_"+c];d!==undefined&&d.apply(this,[b,e,f])}},_postset_headerText:function(){this._refreshHeaderCell()},_postset_allowSort:function(){this._refreshHeaderCell()},_owner:function(){return this._field("owner")},_canSize:function(){return this.options.allowSizing&&this._owner().options.allowColSizing},_canDrag:function(){return this.options.allowMoving===true},_canDropTo:function(b){return!(b instanceof a.wijmo.c1groupedfield)?false:a.wijmo.wijgrid.isChildOf(this._owner().options.columns,b,this)?false:true},_canSort:function(){var a=this._owner();return a&&a.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},_refreshHeaderCell:function(){var b=a('<span class="wijmo-wijgrid-group-button-close ui-state-default ui-corner-all"><span class="ui-icon ui-icon-close"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.html(this.options.headerText||"").prepend(b).bind("click."+this.widgetName,this,this._onHrefClick);if(this._canSort())switch(this.options.sortDirection){case"ascending":this.element.append(a('<span class="wijmo-wijgrid-group-button-sort ui-icon ui-icon-triangle-1-n"></span>'));break;case"descending":this.element.append(a('<span class="wijmo-wijgrid-group-button-sort ui-icon ui-icon-triangle-1-s"></span>'))}},_onCloseClick:function(a){a.data._owner()._handleUngroup(a.data.options.travIdx);return false},_onHrefClick:function(e){var d=e.data._owner(),c=e.data.options,b;if(!c.disabled&&c.allowSort){b=a.wijmo.wijgrid.search(d.columns(),function(a){return a.options.travIdx===c.travIdx});b=!b.found?a.wijmo.wijgrid.getColumnByTravIdx(d.options.columns,c.travIdx).found:b.found.options;b&&d._handleSort(b,e.ctrlKey)}return false}})})(jQuery);(function(a){"use strict";a.widget("wijmo.c1band",a.wijmo.c1basefield,{options:{columns:[]},_create:function(){a.wijmo.c1basefield.prototype._create.apply(this,arguments);this.element.addClass("ui-widget wijmo-c1band")},_canDropTo:function(b){return a.wijmo.c1basefield.prototype._canDropTo.apply(this,arguments)?b instanceof a.wijmo.c1groupedfield:false}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{bandProcessor:function(){var c,h,b,g,e,f,d;this.generateSpanTable=function(j,i){c=h=f=e=0;b=[];g=[];d=[];var a=this._generateSpanTable(j,i,true);return a};this._generateSpanTable=function(i,e,j){var d,f;c=this._getVisibleHeight(i,j);e=e||[];a.wijmo.wijgrid.traverse(i,function(a){a.isLeaf&&e.push(a);g.push(a)});h=e.length;for(d=0;d<c;d++){b[d]=[];for(f=0;f<h;f++)b[d][f]={column:null,colSpan:0,rowSpan:0}}this._setTableValues(i,0,0);return b};this._getVisibleHeight=function(b,g){var d,e,h,f,c=0;if(a.isArray(b))for(d=0,e=b.length;d<e;d++){f=this._getVisibleHeight(b[d],g);c=Math.max(c,f)}else{h=b.visible===undefined?true:b.visible;b.parentVis=h&&g;if(b.isBand){for(d=0,e=b.columns.length;d<e;d++){f=this._getVisibleHeight(b.columns[d],b.parentVis);c=Math.max(c,f)}if(!b.parentVis)return c;b.isLeaf=c===0;c++}else{b.isLeaf=true;if(b.parentVis)c=1}}return c};this._getVisibleParent=function(a){while(a){a=g[a.parentIdx];if(a&&(a.parentVis||a.parentVis===undefined))return a}return null};this._setTableValues=function(g,h,n){var i,l,m,j,o,k;if(a.isArray(g))for(i=0,l=g.length;i<l;i++)this._setTableValues(g[i],h,n);else{if(g.travIdx===undefined)throw"undefined travIdx";m=n+e;if(g.parentVis){j=m+f;b[h][j].column=g;d[g.travIdx]=j}if(g.isBand)for(i=0,l=g.columns.length;i<l;i++)this._setTableValues(g.columns[i],h+1,n);if(g.parentVis)if(e-m===0){b[h][d[g.travIdx]].rowSpan=c-h;e++}else b[h][d[g.travIdx]].colSpan=e-m;else if(!g.isBand&&c>0){k=this._getVisibleParent(g);o=k?k.isLeaf:false;if(o)f++;if(h>=c)h=c-1;j=n+e+f;b[h][j].column=g;if(!o){k&&d[k.travIdx]===j&&this._shiftTableElements(j,h);f++}}}};this._shiftTableElements=function(c,e){for(var a=0;a<e;a++){b[a][c+1]=b[a][c];b[a][c]={column:null,colSpan:0,rowSpan:0};if(b[a][c+1].column)d[b[a][c+1].column.travIdx]++}}},getAllLeaves:function(b){var a=[];this._getAllLeaves(b,a);return a},_getAllLeaves:function(d,e){var c,f,a,b;if(d)for(c=0,f=d.length;c<f;c++){a=d[c];if(a.options)a=a.options;b=a.columns;if(b&&b.length)this._getAllLeaves(b,e);else e.push(a)}},getColumnByTravIdx:function(b,d){var c,f,a,e=null;if(b&&d>=0)for(c=0,f=b.length;c<f&&!e;c++){a=b[c];if(a.options)a=a.options;if(a.travIdx===d)return{found:a,at:b};if(a.columns)e=this.getColumnByTravIdx(a.columns,d)}return e},isChildOf:function(d,a,b){if(a.options)a=a.options;if(b.options)b=b.options;if(b.isBand&&a.parentIdx>=0){if(a.parentIdx===b.travIdx)return true;if(a.parentIdx>b.travIdx)for(var c=this.flatten(d);;){a=c[a.parentIdx];if(a.travIdx===b.travIdx)return true;if(a.parentIdx===-1)break}}return false},getLeaves:function(b){var a=[];this._getLeaves(b,a);return a},_getLeaves:function(c,d){var b,e,a;if(c)for(b=0,e=c.length;b<e;b++){a=c[b];a.isLeaf&&d.push(a);a.columns&&this._getLeaves(a.columns,d)}},setTraverseIndex:function(a){return this._setTraverseIndex(a,0,-1)},_setTraverseIndex:function(d,b,f){var c,e,a;if(d)for(c=0,e=d.length;c<e;c++){a=d[c];if(a.options)a=a.options;a.linearIdx=c;a.travIdx=b++;a.parentIdx=f;if(a.columns)b=this._setTraverseIndex(a.columns,b,b-1)}return b},flatten:function(b){var a=[];this.traverse(b,function(b){a.push(b)});return a},traverse:function(e,d){var c,f,b;if(e&&a.isFunction(d))for(c=0,f=e.length;c<f;c++){b=e[c];if(b.options)b=b.options;d(b);b.columns&&this.traverse(b.columns,d)}},getAriaHeaders:function(e,h){var b,g,c,d,f=[];for(b=0,g=e.length;b<g;b++){c=e[b];d="";do d+=escape(c.headerText)+" ";while(c=h[c.parentIdx]);f[b]=a.trim(d)}return f}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{getTableSection:function(a,b){if(a&&!a.nodeType)a=a[0];if(a)switch(b){case 1:return a.tHead;case 2:if(a.tBodies)return a.tBodies[0]||null;break;case 3:return a.tFoot;default:return a}return null},getTableSectionLength:function(a,b){if(a&&!a.nodeType)a=a[0];return a&&(b=this.getTableSection(a,b))?b.rows.length:0},getTableSectionRow:function(a,b,c){if(a&&!a.nodeType)a=a[0];return a&&(b=this.getTableSection(a,b))?b.rows[c]||null:null},readTableSection:function(c,f,h){var e,k,b,i,g,d,j=[],l=function(a){a=a.toLowerCase();return a==="rowspan"||a==="colspan"};if(c&&!c.nodeType)c=c[0];if(c&&(f=this.getTableSection(c,f)))for(e=0,k=f.rows.length;e<k;e++){g=f.rows[e];d=[];if(h){d.rowAttributes=null;d.cellsAttributes=[]}for(b=0,i=g.cells.length;b<i;b++){d[b]=g.cells[b].innerHTML;if(h)d.cellsAttributes[b]=a.wijmo.wijgrid.getAttributes(g.cells[b],l)}j[e]=d}return j}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{dataMode:{dom:1,statical:2,remoteStatical:4,dynamical:8},dataStore:function(c){var b=null,n=this,g=false,e=null,d=null,h,m=false,l=false;this.dataMode=function(){return f()};this.dataSource=function(){return b};this.getFieldNames=function(){if(!g)throw"data is not loaded yet";var e=[],d,h,c;if(b.items&&b.items.length)c=b.items[0];else if(f()===a.wijmo.wijgrid.dataMode.dom&&b.header&&b.header.length)c=b.header[0];if(c)for(d in c)c.hasOwnProperty(d)&&e.push(!isNaN(d)?parseInt(d,10):d);return e};this.getDataSlice=function(){if(!g)throw"data is not loaded yet";if(!m){m=true;r(e)}if(!l){l=true;if(f()!==a.wijmo.wijgrid.dataMode.dynamical)h=s(e,b.emptyData);else h={data:e,totalRows:b.data.totalRows,totals:b.data.totals||{},emptyData:b.emptyData}}return h};this.load=function(e){if(!b)b=a.proxy(p,this)(c);if(f()===a.wijmo.wijgrid.dataMode.dynamical){e.data=q();if(b.proxy)b.proxy.options.data=a.extend(b.proxy.options.data,e.data);d=null;b.load(e,true)}else if(!g){d=null;b.load(e)}else{i(b,e);j(b,e)}};this.isLoaded=function(){return g};this.updateValue=function(a,c,b){if(!g)throw"data is not loaded yet";this.dataSource().items[a][c]=b};function p(e){var b=null,c=e.options.data,d;if(c===null)b=new wijdatasource({data:e.element,reader:new k(new o),loading:a.proxy(i,this),loaded:a.proxy(j,this)});else if(a.isArray(c))b=new wijdatasource({data:c,reader:new k(new wijarrayreader),loading:a.proxy(i,this),loaded:a.proxy(j,this)});else{b=new wijdatasource(c);b.reader=new k(c.reader);b.loading=a.proxy(function(d,b){a.isFunction(c.loading)&&c.loading(d,b);a.proxy(i,this)(d,b)},this);b.loaded=a.proxy(function(d,b){a.isFunction(c.loaded)&&c.loaded(d,b);a.proxy(j,this)(d,b)},this);if(b.proxy&&b.proxy.options){d=b.proxy.options.error;b.proxy.options.error=function(){t.apply(this,arguments);a.isFunction(d)&&d.apply(this,arguments)}}}return b}function i(d,b){if(n.dataMode()===a.wijmo.wijgrid.dataMode.dynamical||c.options.alwaysParseData)m=false;l=false;h=null;e=null;c._dataLoading(b)}function j(l,o){g=true;var h,m,b,i,j,k,p=f(),n=!d&&c.options.readAttributesFromData;if(!d)d=[];e=[];for(h=0,m=l.items.length;h<m;h++){b=l.items[h];if(n)if(p===a.wijmo.wijgrid.dataMode.dom){d.push({rowAttributes:b.rowAttributes,cellsAttributes:b.cellsAttributes});delete b.rowAttributes;delete b.cellsAttributes}else{k={};for(i in b)if(b.hasOwnProperty(i)&&a.isArray(j=b[i])){k[i]=j[1];b[i]=j[0]}d.push({rowAttributes:{},cellsAttributes:k})}e.push({values:b,originalRowIndex:h,attributes:d[h]})}c._dataLoaded(o)}function t(){c._ajaxError.apply(c,arguments)}function f(){return!b.data?a.wijmo.wijgrid.dataMode.dom:b.dynamic===true?a.wijmo.wijgrid.dataMode.dynamical:a.wijmo.wijgrid.dataMode.statical}function r(d){if(d&&d.length){var g=[],j,f,k,h,e,i,b;a.wijmo.wijgrid.traverse(c.options.columns,function(b){a.wijmo.wijgrid.validDataKey(b.dataKey)&&g.push(b)});j=Math.min(g.length,n.getFieldNames().length);for(f=0,k=d.length;f<k;f++){h=d[f];for(e=0;e<j;e++){i=null;b=g[e];if(b&&b.dataParser){i=c._parse(b,h.values[b.dataKey]);h.values[b.dataKey]=i}}}}}function s(b,h){if(b&&b.length){var d=c._prepareFilterRequest(true),f=c._preparePageRequest(true),g=c._prepareSortRequest(true),e=c._prepareTotalsRequest(true),i=(new a.wijmo.wijgrid.dataHelper).getDataSlice(c,b,d,f,g,e);return i}return{data:[],totalRows:0,totals:{},emptyData:h}}function q(){return{filtering:c._prepareFilterRequest(false),paging:c._preparePageRequest(false),sorting:c._prepareSortRequest(false),totals:c._prepareTotalsRequest(false)}}function k(b){this.read=function(c){c.items=null;b&&a.isFunction(b.read)&&b.read(c);if(!a.isArray(c.items)){c.items=[];if(a.isArray(c.data))c.items=c.data;else if(c.data&&a.isArray(c.data.rows))c.items=c.data.rows}if(f()===a.wijmo.wijgrid.dataMode.dynamical)if(!c.data||isNaN(c.data.totalRows))throw"totalRows value is missing";if(!c.items||!a.isArray(c.items))c.items=[]}}function o(){this.read=function(b){b.items=[];if(b&&b.data&&b.data.length){if(a.wijmo.wijgrid.getTableSectionLength(b.data,2)===1&&a(a.wijmo.wijgrid.getTableSectionRow(b.data,2,0)).hasClass("wijmo-wijgrid-emptydatarow"))b.emptyData=a.wijmo.wijgrid.readTableSection(b.data,2);else b.items=a.wijmo.wijgrid.readTableSection(b.data,2,c.options.readAttributesFromData);b.header=a.wijmo.wijgrid.readTableSection(b.data,1);b.data=null}else throw"invalid data source";}}},dataHelper:function(){this.getDataSlice=function(k,e,n,g,p,o){e=b(e,n,k);a.proxy(c,this)(e,p);var q=e.length,f,m,i,h,j,r,l={};l=d(e,o,k);if(g){f=Math.min(e.length-1,g.pageIndex*g.pageSize);if(f<0)f=0;m=Math.min(e.length,f+g.pageSize);i=[];for(h=f,r=0,j=0;h<m;h++,j++)i[j]=e[h];e=i}return{data:e,totalRows:q,totals:l}};function d(i,f){var b,c,e,j,g,d=[],h={};for(b=0,c=f.length;b<c;b++)d.push(new a.wijmo.wijgrid.tally);for(b=0,c=i.length;b<c;b++){g=i[b].values;for(e=0,j=d.length;e<j;e++)d[e].add(g[f[e].column.dataKey])}for(b=0,c=d.length;b<c;b++)h[f[b].column.dataKey]=d[b].getValueString(f[b].column);return h}function b(e,d,o){var k,g,j={},a,b,l,i,m=[],h,f,c,n;if(!e||(k=e.length)===0||!d||(g=d.length)===0)return e;for(a=0;a<g;a++){b=d[a];l=b.operator;i=b.column;if(l.arity>1)j[a]=o._parse(i,i.filterValue)}for(a=0;a<k;a++){h=e[a];f=true;for(c=0;c<g&&f;c++){b=d[c];n=h.values[b.column.dataKey];f&=b.operator.operator(n,j[c])}f&&m.push(h)}return m}function c(i,e){if(e.length){var b=[],d,h,c,a,f,g;b.push("var context = this;");b.push("this.sort = function(a, b)\n{\n");for(d=0,h=e.length;d<h;d++){c="arg"+d;a=e[d];f=typeof a.dataKey==="string"?'"'+a.dataKey+'"':a.dataKey;if(a.sortDirection==="ascending"||a.sortDirection==="descending")if(a.sortDirection==="ascending")b.push("var ",c," = context._sortAsc","(a.values[",f,"], b.values[",f,"]);\n");else b.push("var ",c," = context._sortDesc","(a.values[",f,"], b.values[",f,"]);\n");else b.push("var ",c," = context._sortDigitAsc","(a.originalRowIndex, b.originalRowIndex);\n");b.push("if (",c," === 0)\n");b.push("{\n")}g=e.length-1;if(g>=0){c="arg"+g;a=e[g];f=typeof a.dataKey==="string"?'"'+a.dataKey+'"':a.dataKey;if(a.sortDirection==="ascending"||a.sortDirection==="descending")if(a.sortDirection==="ascending")b.push("var ",c," = context._sortDigitAsc","(a.originalRowIndex, b.originalRowIndex);\n");else b.push("var ",c," = context._sortDigitDesc","(a.originalRowIndex, b.originalRowIndex);\n")}for(d=e.length-1;d>=0;d--){b.push("}\n");c="arg"+d;b.push("return ",c,";\n")}b.push("}");eval(b.join(""));i.sort(this.sort)}}this._sortAsc=function(a,b){if(a instanceof Date)a=a.getTime();if(b instanceof Date)b=b.getTime();return a===b?0:a===null?-1:b===null?1:a<b?-1:1};this._sortDesc=function(a,b){if(a instanceof Date)a=a.getTime();if(b instanceof Date)b=b.getTime();return a===b?0:a===null?1:b===null?-1:a<b?1:-1};this._sortDigitAsc=function(a,b){return a-b};this._sortDigitDesc=function(a,b){return b-a}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{groupRange:function(d,g,h,f){this.value=-1;switch(arguments.length){case 4:this.isExpanded=d;this.cr=g;this.sum=h;this.position=f;break;case 1:this.isExpanded=d;this.cr=new a.wijmo.wijgrid.cellRange(-1,-1);this.sum=-1;this.position="none";break;default:this.isExpanded=false;this.cr=new a.wijmo.wijgrid.cellRange(-1,-1);this.sum=-1;this.position="none"}this.isSubRange=function(a){return this.cr.r1>=a.cr.r1&&this.cr.r2<=a.cr.r2};this.toString=function(){return this.cr.r1+"-"+this.cr.r2};this._getHeaderImageClass=function(c){var b=this.owner;return b?c?b.expandedImageClass||a.wijmo.c1field.prototype.options.groupInfo.expandedImageClass:b.collapsedImageClass||a.wijmo.c1field.prototype.options.groupInfo.collapsedImageClass:null};this.collapse=function(){var b,h,f,c,d,g;if((b=this.owner)&&(h=b.owner)&&(f=h.owner)){c=new a.wijmo.wijgrid.groupHelper;d=f._field("leaves");if(c.isParentExpanded(d,this.cr,b.level))if(b.position!=="footer"&&b.outlineMode!=="none"){g=c.getGroupedColumnsCount(d);e(c,f._rows(),d,this,g)}}};this.expand=function(i){var e,h,f,b,d,g;if((e=this.owner)&&(h=e.owner)&&(f=h.owner)){b=new a.wijmo.wijgrid.groupHelper;d=f._field("leaves");if(b.isParentExpanded(d,this.cr,e.level)){g=b.getGroupedColumnsCount(d);c(b,f._rows(),d,this,g,i,true)}}};function e(m,e,o,d,l){var j=d.owner,i=d.cr.r1,n=d.cr.r2,a,c,k,h,f,g;switch(j.position){case"header":case"headerAndFooter":a=e.item(d.cr.r1);if(a){if(a[0])a[0]["aria-expanded"]="false";if(a[1])a[1]["aria-expanded"]="false"}i++}for(c=i;c<=n;c++){a=e.item(c);if(a){if(a[0]){a[0].style.display="none";a[0]["aria-hidden"]="true"}if(a[1]){a[1].style.display="none";a[1]["aria-hidden"]="true"}}}d.isExpanded=false;b(e,d);for(c=j.level+1;c<=l;c++){h=m.getChildGroupRanges(o,d.cr,c-1);for(g=0,k=h.length;g<k;g++){f=h[g];f.isExpanded=false;switch(f.owner.position){case"header":case"headerAndFooter":a=e.item(f.cr.r1);if(a){if(a[0])a[0]["aria-expanded"]="false";if(a[1])a[1]["aria-expanded"]="false"}}b(e,f)}}}function c(o,e,p,f,n,g,i){var r=f.owner,k=f.cr.r1,l=f.cr.r2,a,d,m,j,h,q;switch(r.position){case"header":a=e.item(k);if(a){if(a[0]){a[0].style.display="";a[0]["aria-hidden"]="false";if(i||g)a[0]["aria-expanded"]="true"}if(a[1]){a[1].style.display="";a[1]["aria-hidden"]="false";if(i||g)a[1]["aria-expanded"]="true"}}k++;break;case"footer":a=e.item(l);if(a){if(a[0]){a[0].style.display="";a[0]["aria-hidden"]="false"}if(a[1]){a[1].style.display="";a[1]["aria-hidden"]="false"}}l--;break;case"headerAndFooter":a=e.item(k);if(a){if(a[0]){a[0].style.display="";a[0]["aria-hidden"]="false";if(i||g)a[0]["aria-expanded"]="true"}if(a[1]){a[1].style.display="";a[1]["aria-hidden"]="false";if(i||g)a[1]["aria-expanded"]="true"}}if(i){a=e.item(l);if(a){if(a[0]){a[0].style.display="";a[0]["aria-hidden"]="false"}if(a[1]){a[1].style.display="";a[1]["aria-hidden"]="false"}}}k++;l--}if(i){f.isExpanded=true;b(e,f)}else return;if(f.owner.level===n)for(d=k;d<=l;d++){a=e.item(d);if(a){if(a[0]){a[0].style.display="";a[0]["aria-hidden"]="false"}if(a[1]){a[1].style.display="";a[1]["aria-hidden"]="false"}}}else{j=o.getChildGroupRanges(p,f.cr,f.owner.level);if(g)for(d=0,m=j.length;d<m;d++){h=j[d];c(o,e,p,h,n,g,true)}else for(d=0,m=j.length;d<m;d++){h=j[d];q=h.owner.position==="footer"||h.owner.outlineMode==="none"?true:false;c(o,e,p,h,n,false,q)}}}function b(e,b){if(b.owner.position!=="footer"){var c=null,d=e.item(b.cr.r1);if(d)if(d[0])c=a(d[0]).find("div.wijmo-wijgrid-grouptogglebtn:first-child");if(c&&c.length){c.toggleClass(b._getHeaderImageClass(!b.isExpanded),false);c.toggleClass(b._getHeaderImageClass(b.isExpanded),true)}}}},grouper:function(){this.group=function(i,k,e){this._grid=i;this._data=k;this._leaves=e;this._groupRowIdx=0;this._groupHelper=new a.wijmo.wijgrid.groupHelper;var h=1,c,f,b,d=[],g=false,j=0;for(c=0,f=e.length;c<f;c++){b=e[c];if(b.groupInfo){delete b.groupInfo.level;delete b.groupInfo.expandInfo}if(b.groupInfo&&b.groupInfo.position&&b.groupInfo.position!=="none"&&b.dataIndex>=0){if(b.groupedIndex===undefined)g=true}else if(b.groupedIndex!==undefined)delete b.groupedIndex}if(g)for(c=0,f=e.length;c<f;c++){b=e[c];if(b.groupInfo&&b.groupInfo.position&&b.groupInfo.position!=="none"&&b.dataIndex>=0){b.groupedIndex=j++;d.push(b)}}else{d=a.map(e,function(a){return a.groupedIndex!==undefined?a:null});d.sort(function(a,b){return a.groupedIndex-b.groupedIndex});a.each(d,function(a,b){b.groupedIndex=a})}i._field("groupedColumns",d);for(c=0,f=d.length;c<f;c++){b=d[c];this._groupRowIdx=0;if(b.groupInfo&&b.groupInfo.position&&b.groupInfo.position!=="none"&&b.dataIndex>=0){b.groupInfo.level=h;b.groupInfo.expandInfo=[];this._processRowGroup(b,h++)}}delete this._grid;delete this._data;delete this._leaves};this._processRowGroup=function(j,c){for(var b,i,m,l,d,h,e,g,f,k=0;k<this._data.length;k++){if(!(this._data[k].rowType&a.wijmo.wijgrid.rowType.data))continue;b=this._getGroupCellRange(k,j,c);i=true;m=j.groupInfo.outlineMode==="startCollapsed";if(m||this._groupHelper.isParentCollapsed(this._leaves,b,c)){if(j.groupInfo.groupSingleRow===false&&b.r1===b.r2)continue;i=false}if(c&&this._grid.options.groupIndent)for(l=b.r1;l<=b.r2;l++)this._addIndent(this._data[l][0],c);switch(j.groupInfo.position){case"header":d=this._addGroupRange(j.groupInfo,b,i);this._updateByGroupRange(d,c);h=this._groupHelper.isParentCollapsed(this._leaves,d.cr,c);e=this._buildGroupRow(d,b,true,h);for(f=b.r1;f<=b.r2;f++){this._data[f].__attr["aria-level"]=c+1;if(!i){this._data[f].__style.display="none";this._data[f].__attr["aria-hidden"]=true}}this._data.splice(b.r1,0,e);e.__attr["arial-level"]=c;e.__attr["aria-expanded"]=i;if(h){e.__style.display="none";e.__attr["aria-hidden"]=true}k=b.r2+1;break;case"footer":d=this._addGroupRange(j.groupInfo,b,true);this._updateByGroupRange(d,c);g=this._buildGroupRow(d,b,false,false);g.__attr["aria-level"]=c;this._data.splice(b.r2+1,0,g);k=b.r2+1;h=this._groupHelper.isParentCollapsed(this._leaves,d.cr,c);if(h){g.__style.display="none";g.__attr["aria-hidden"]=true}break;case"headerAndFooter":d=this._addGroupRange(j.groupInfo,b,i);this._updateByGroupRange(d,c);h=this._groupHelper.isParentCollapsed(this._leaves,d.cr,c);e=this._buildGroupRow(d,b,true,h);g=this._buildGroupRow(d,b,false,false);for(f=b.r1;f<=b.r2;f++){this._data[f].__attr["aria-level"]=c+1;if(!i){this._data[f].__style.display="none";this._data[f].__attr["aria-hidden"]=true}}this._data.splice(b.r2+1,0,g);g.__attr["aria-level"]=c;if(h||!i){g.__style.display="none";g.__attr["aria-hidden"]=true}this._data.splice(b.r1,0,e);e.__attr["aria-level"]=c;e.__attr["aria-expanded"]=i;if(h){e.__style.display="none";e.__attr["aria-hidden"]=true}k=b.r2+2;break;default:throw a.wijmo.wijgrid.stringFormat('Unknown Position value: "{0}"',j.groupInfo.position);}this._groupRowIdx++}};this._buildGroupRow=function(n,l,f){var e=n.owner,c=e.owner,r=c.owner,h=[],j="",k="",d,g,b,p,q,i,o,m;h.__style={};h.__attr={};h.__attr.id=(f?"GH":"GF")+this._groupRowIdx+"-"+e.level;h.rowType=f?a.wijmo.wijgrid.rowType.groupHeader:a.wijmo.wijgrid.rowType.groupFooter;if(c.dataIndex>=0&&(d=this._data[l.r1][c.dataIndex].value)!==null)j=r._toStr(c,d);this._grid.options.showRowHeader&&h.push({html:"&nbsp;"});g={html:"",__attr:{},__style:{}};if(f&&e.outlineMode!=="none")if(n.isExpanded)g.html='<div class="ui-icon '+n._getHeaderImageClass(true)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>';else g.html='<div class="ui-icon '+n._getHeaderImageClass(false)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>';h.push(g);if(c.aggregate&&c.aggregate!=="none")k=this._getAggregate(l,c,c,f,j);b=f?e.headerText:e.footerText;if(b==="custom"){p={data:this._data,column:c,groupByColumn:e.owner,groupText:j,text:"",groupingStart:l.r1,groupingEnd:l.r2,isGroupHeader:f,aggregate:k};if(this._grid._trigger("groupText",null,p))b=p.text}else{if(b===undefined||b===null){if(f)b="{1}: {0}";if(k||k===0)b=b?b+" {2}":"{2}"}b=a.wijmo.wijgrid.stringFormat(b,j,c&&c.headerText?c.headerText:"",k.toString())}if(!b)b="&nbsp;";g.html+="<span>"+b+"</span>";this._addIndent(g,e.level-1);q=1;i=this._grid.options.showRowHeader?1:0;o=true;for(;i<this._leaves.length;i++){d=this._leaves[i];if(d.parentVis){if(o){o=false;continue}if(d.dynamic!==true&&d.aggregate&&d.aggregate!=="none")break;q++}}for(;i<this._leaves.length;i++){d=this._leaves[i];if(d.parentVis){m=this._getAggregate(l,d,e.owner,f,j);if(!m&&m!==0)m="&nbsp;";h.push({html:m.toString(),__attr:{groupInfo:{leafIndex:d.leavesIdx,purpose:a.wijmo.wijgrid.groupRowCellPurpose.aggregateCell}}})}}g.__attr.colSpan=q;g.__attr.groupInfo={leafIndex:c.leavesIdx,purpose:a.wijmo.wijgrid.groupRowCellPurpose.groupCell};return h};this._getAggregate=function(d,b,h,i,j){var c="",g,f,e;if(!b.aggregate||b.aggregate==="none")return c;if(b.aggregate==="custom"){g={data:this._data,column:b,groupByColumn:h,groupText:j,text:"",groupingStart:d.r1,groupingEnd:d.r2,isGroupHeader:i};if(this._grid._trigger("groupAggregate",null,g))c=g.text}else{f=new a.wijmo.wijgrid.tally;for(e=d.r1;e<=d.r2;e++)f.add(this._data[e][b.dataIndex].value);c=f.getValueString(b)}return c};this._getGroupCellRange=function(c,d,h){var i=d.leavesIdx,b=new a.wijmo.wijgrid.cellRange(c,i),e=this._groupHelper.getParentGroupRange(this._leaves,b,h),g,f;if(this._data[c].rowType&a.wijmo.wijgrid.rowType.data){g=this._data[c][d.dataIndex].value;for(b.r2=c,f=this._data.length-1;b.r2<f;b.r2++){if(!(this._data[b.r2+1].rowType&a.wijmo.wijgrid.rowType.data)||e&&b.r2+1>e.r2)break;if(this._data[b.r2+1][d.dataIndex].value!==g)break}}return b};this._addGroupRange=function(b,c,i){var d=null,f=this._groupHelper.getChildGroupIndex(c,b.expandInfo),h,g,j,e;if(f>=0&&f<b.expandInfo.length)d=b.expandInfo[f];else{h=new a.wijmo.wijgrid.cellRange(c.r1,c.r1,c.r2,c.r2);g=b.position==="footer"?true:i&&b.outlineMode!=="startCollapsed";d=new a.wijmo.wijgrid.groupRange(g,h,-1,b.position);d.owner=b;b.expandInfo.push(d)}if(d){j=c.r1;e=c.r2;if(b.position==="headerAndFooter")e+=2;if(b.position!=="headerAndFooter")e++;d.cr.r2=e}return d};this._updateByGroupRange=function(c,i){var d,h,b,g,e,a,f;for(d=0,h=this._leaves.length;d<h;d++){b=this._leaves[d].groupInfo;if(b&&b.level<i){g=b.expandInfo?b.expandInfo.length:0;for(e=0;e<g;e++){a=b.expandInfo[e];f=c.position==="headerAndFooter"?2:1;if(a.cr.r1>=c.cr.r1&&!(a.cr.r1===c.cr.r1&&a.position==="footer"))a.cr.r1+=f;if(a.cr.r2>=c.cr.r1)a.cr.r2+=f}}}};this._addIndent=function(c,b){var a;if(b>0&&(a=this._grid.options.groupIndent))c.__style.paddingLeft=a*b+"px"}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{groupHelper:function(){this.getGroupInfo=function(d){if(d){if(!a.wijmo.wijgrid._getGroupInfoRegExp)a.wijmo.wijgrid._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$");var b=a.wijmo.wijgrid._getGroupInfoRegExp.exec(d.id),f,e,c;if(b){f=parseInt(b[3],10);e=parseInt(b[2],10);c=b[1]==="H";return{level:f,index:e,isHeader:c,toString:function(){return(this.isHeader?"GH":"GF")+this.index+"-"+this.level}}}}return null};this.getColumnByGroupLevel=function(c,e){var b,d,a;for(b=0,d=c.length;b<d;b++){a=c[b];if(a.groupInfo&&a.groupInfo.level===e)return a}return null};this.getGroupedColumnsCount=function(c){var d=0,b,e,a;for(b=0,e=c.length;b<e;b++){a=c[b].groupInfo;if(a&&(a.position==="header"||a.position==="headerAndFooter"||a.position==="footer"))d++}return d};this.getChildGroupIndex=function(f,e){var b=0,c=e.length-1,a,d;while(b<=c){a=(c-b>>1)+b;d=e[a].cr.r1-f.r1;if(d===0)return a;if(d<0)b=a+1;else c=a-1}return b};this.getParentGroupIndex=function(c,b){var a=this.getChildGroupIndex(c,b);if(a>0)a--;return a<b.length?a:-1};this.getChildGroupRanges=function(i,f,j){var g=[],a,c,b,h,e,d=this.getColumnByGroupLevel(i,j+1);if(d){a=d.groupInfo.expandInfo;e=this.getChildGroupIndex(f,a);for(b=e,h=a.length;b<h;b++){c=a[b];if(c.cr.r2<=f.r2)g.push(c);else break}}return g};this.getParentGroupRange=function(e,f,b){var c,a,d;if(b===undefined)b=65535;if(b-2>=0)for(c=e.length-1;c>=0;c--){a=e[c].groupInfo;if(!a||!a.expandInfo||a.level<0||a.level!==b-1)continue;d=this.getParentGroupIndex(f,a.expandInfo);if(d>=0)return a.expandInfo[d]}return null};this.isParentCollapsed=function(e,c,d){var b,a;if(d===1)return false;for(b=d;b>1;b--){a=this.getParentGroupRange(e,c,b);if(a&&!a.isExpanded)return true;c=a.cr}return false};this.isParentExpanded=function(e,c,d){var b,a;if(d===1)return true;for(b=d;b>1;b--){a=this.getParentGroupRange(e,c,b);if(a&&a.isExpanded)return true;c=a.cr}return false}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{cellRange:function(b,a,d,c){switch(arguments.length){case 2:this.r1=this.r2=b;this.c1=this.c2=a;break;case 4:this.r1=b;this.r2=d;this.c1=a;this.c2=c;break;default:this.r1=0;this.r2=0;this.c1=0;this.c2=0}this.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2}},merger:function(){this.merge=function(e,c){this.leaves=c;this.data=e;var b,d,a;for(b=0,d=c.length;b<d;b++){a=c[b];a.dataIndex>=0&&!a.isBand&&(a.rowMerge==="free"||a.rowMerge==="restricted")&&this.mergeColumn(a)}delete this.data;delete this.leaves};this.mergeColumn=function(f){var e=f.dataIndex,c,h,b,g,d;for(c=0,h=this.data.length;c<h;c++){if(!(this.data[c].rowType&a.wijmo.wijgrid.rowType.data))continue;b=this.getCellRange(c,f);if(b.r1!==b.r2){g=b.r2-b.r1+1;this.data[b.r1][e].__attr.rowSpan=g;for(d=b.r1+1;d<=b.r2;d++)this.data[d][e].visible=false}c=b.r2}};this.getCellRange=function(c,h){var d=h.dataIndex,b=new a.wijmo.wijgrid.cellRange(c,d),k=this.data[c][d].value,j=this.data.length,e,g,f,i;for(b.r2=c;b.r2<j-1;b.r2++){e=this.data[b.r2+1];if(!(e.rowType&a.wijmo.wijgrid.rowType.data)||e[d].value!==k)break}g=h.leavesIdx;if(g>0&&h.rowMerge==="restricted"){f=this.leaves[g-1];if(f.dataIndex>=0){i=this.getCellRange(c,f);b.r1=Math.max(b.r1,i.r1);b.r2=Math.min(b.r2,i.r2)}}return b}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{rowType:{header:1,data:2,dataAlt:4,filter:8,groupHeader:16,groupFooter:32,footer:64,emptyDataRow:128},renderState:{none:0,rendering:1,current:2,hovered:4,selected:8},groupRowCellPurpose:{groupCell:0,aggregateCell:1},stringFormat:function(b){var a,c;if(!b)return"";for(a=1,c=arguments.length;a<c;a++)b=b.replace(new RegExp("\\{"+(a-1)+"\\}","gm"),arguments[a]);return b},validDataKey:function(a){return a&&!(a<0)||a===0},iterateChildrenWidgets:function(b,c){if(b&&c){if(b.nodeType)b=a(b);b.find(".ui-widget").each(function(b,d){a.each(a(d).data(),function(d,a){a.widgetName&&c(b,a)})})}},remove$dataByPrefix:function(c,d){var b=[];a.each(c.data(),function(a){a.indexOf(d)===0&&b.push(a)});a.each(b,function(b,a){c.removeData(a)})},domSelection:function(b){this.getSelection=function(){var a=0,c=0,d;if(b.selectionStart!==undefined){a=b.selectionStart;c=b.selectionEnd}else if(document.selection){d=document.selection.createRange().duplicate();c=d.text.length;a=Math.abs(d.moveStart("character",-b.value.length));c+=a}return{start:a,end:c,length:c-a}};this.setSelection=function(c){if(b.selectionStart!==undefined)b.setSelectionRange(c.start,c.end);else{var a=b.createTextRange();a.collapse(true);a.moveStart("character",c.start);a.moveEnd("character",c.end);a.select()}};this.toggleSelection=function(c){if(c)a(b).enableSelection().css({MozUserSelect:"",WebkitUserSelect:""});else a(b).disableSelection().css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})}},createDynamicField:function(b){return a.extend(true,{},a.wijmo.c1basefield.prototype.options,a.wijmo.c1field.prototype.options,{dynamic:true,isLeaf:true,isBand:false,parentIdx:-1},b)},bounds:function(d,e){if(d){var c=d.nodeType?a(d):d,b=c.offset();if(b)return e?{top:b.top,left:b.left,width:c[0].clientWidth||0,height:c[0].clientHeight||0}:{top:b.top,left:b.left,width:c.outerWidth(),height:c.outerHeight()}}return null},_getDOMText:function(a,c,b){if(b===undefined)b=0;if(a&&(!c||c&&b<2))if(a.nodeType===3)return a.nodeValue;else if(a.nodeType===1){switch(a.type){case"button":case"text":case"textarea":case"select-one":return a.value;case"checkbox":return a.checked.toString()}for(var e="",d=0;a.childNodes[d];d++)e+=this._getDOMText(a.childNodes[d],c,b+1);return e}return""},ensureTBody:function(a){return a?a.tBodies&&a.tBodies.length>0?a.tBodies[0]:a.appendChild(document.createElement("tbody")):null},rowTypeFromCss:function(b){var c=/wijmo-wijgrid-(\S+)row/.exec(b.attr("class"));if(c)switch(c[1]){case"header":return a.wijmo.wijgrid.rowType.header;case"filter":return a.wijmo.wijgrid.rowType.filter;case"data":return b.hasClass("wijmo-wijgrid-alternatingrow")?a.wijmo.wijgrid.rowType.data|a.wijmo.wijgrid.rowType.dataAlt:a.wijmo.wijgrid.rowType.data;case"alternating":return a.wijmo.wijgrid.rowType.data|a.wijmo.wijgrid.rowType.dataAlt;case"groupheader":return a.wijmo.wijgrid.rowType.groupHeader;case"groupheader":return a.wijmo.wijgrid.rowType.groupFooter}},dataPrefix:function(){var f=arguments.length,h,g,b,k=typeof arguments[0]==="boolean",c=k?arguments[1]:arguments[0],j=c.nodeType===undefined,i,d,e;if(f===3){b=arguments[1]+arguments[2];return j?a.data(c[0],b):a.data(c,b)}else if(k){g=arguments[3];for(h in g){e=g[h];if(g.hasOwnProperty(h)){b=arguments[2]+h;if(j)for(d=0,f=c.length;d<f;d++)i=a.data(c[d],b,e);else a.data(c,b,e)}}}else{b=arguments[1]+arguments[2];e=arguments[3];if(j){for(d=0,f=c.length;d<f;d++)i=a.data(c[d],b,e);return i}else return a.data(c,b,e)}},shallowMerge:function(d,c){if(c&&d){var a,e,b;for(a in c)if(c.hasOwnProperty(a)){e=c[a];b=typeof e;if((b==="string"||b==="boolean"||b==="number")&&d[a]===undefined)d[a]=e}}},isCustomObject:function(a){return a&&typeof a==="object"&&!(a instanceof Date)},search:function(c,d){var b,e,f=a.isFunction(d);for(b in c)if(c.hasOwnProperty(b)){e=f?d(c[b]):c[b]===d;if(e===true)return{at:b,found:c[b]}}return{at:null,found:null}},getAttributes:function(c,e){if(c){var d,h,g=0,f={},a,b;for(d=0,h=c.attributes.length;d<h;d++){b=c.attributes[d].name;if(b&&(!e||!e(b))){a=c.getAttribute(b);if(b==="style")a=typeof a==="object"?a.cssText:a;if(!a&&b==="class")a=c.getAttribute("className");if(a&&typeof a!=="function"){f[b]=a;g++}}}if(g)return f}return null}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{embeddedParsers:{stringParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(a,d,e,c,b){switch(a){case null:return null;case c:if(b)return null;case undefined:case"&nbsp":return"";default:return""+a}},toStr:function(a,d,e,c,b){return a===null&&b?c:""+a}},numberParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(a,d,f,c,b){var e=typeof a;return e==="number"?isNaN(a)?NaN:a:!a&&a!==0||a==="&nbsp;"||a===c&&b?null:Globalize.parseFloat(a,10,d.name)},toStr:function(b,e,a,d,c){return b===null&&c?d:Globalize.format(b,a?a:"n",e.name)}},currencyParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(a,b,f,e,d){var c=typeof a;if(c==="number")return isNaN(a)?NaN:a;if(!a&&a!==0||a==="&nbsp;"||a===e&&d)return null;if(c==="string")a=a.replace(b.numberFormat.currency.symbol,"");return Globalize.parseFloat(a,10,b.name)},toStr:function(b,e,a,d,c){return b===null&&c?d:Globalize.format(b,a?a:"c",e.name)}},dateTimeParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(a,e,f,d,c){var b;if(a instanceof Date)return a;if(!a||a==="&nbsp;"||a===d&&c)return null;b=/^\/Date\((\d+)\)\/$/.exec(a);return b?new Date(parseInt(b[1],10)):Globalize.parseDate(a,f,e.name)},toStr:function(b,e,a,d,c){return b===null&&c?d:Globalize.format(b,a?a:"d",e.name)}},boolParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(b,f,g,e,d){var c=typeof b;if(c==="boolean")return b;if(c==="string")b=a.trim(b);if(!b||b==="&nbsp;"||b===e&&d)return null;switch(b.toLowerCase()){case"true":return true;case"false":return false}return NaN},toStr:function(a,d,e,c,b){return a===null&&b?c:a?"true":"false"}}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{filterOperatorsCache:function(){var b={};this.add=function(a){if(a&&a.name&&a.operator){var c=a.name.toLowerCase();if(!b[c])b[c]=a}};this.clear=function(){b.length=0};this.getByName=function(a){return b[a.toLowerCase()]};this.getByDataType=function(f){var e=[],d,c;for(d in b)if(b.hasOwnProperty(d)){c=b[d];a.inArray(f,c.applicableTo)>=0&&e.push(c)}return e};this.removeCustom=function(){var a;for(a in b)if(b[a].custom)delete b[a]};this.sort=function(a,b){switch(b.toLowerCase()){case"alphabetical":a.sort(e);break;case"alphabeticalcustomfirst":a.sort(d);break;case"alphabeticalembeddedFirst":a.sort(c)}return a};function e(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}return a===b?0:a<b?-1:1}function c(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}if(c.custom!==d.custom){if(c.custom)return 1;if(d.custom)return-1}return a===b?0:a<b?-1:1}function d(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}if(c.custom!==d.custom){if(c.custom)return-1;if(d.custom)return 1}return a===b?0:a<b?-1:1}}});a.wijmo.wijgrid.embeddedFilters=[{name:"NoFilter",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(){return true}},{name:"Contains",arity:2,applicableTo:["string"],operator:function(a,b){return a===b?true:a?a.indexOf(b)>=0:false}},{name:"NotContain",arity:2,applicableTo:["string"],operator:function(a,b){return a===b?false:a?a.indexOf(b)<0:true}},{name:"BeginsWith",arity:2,applicableTo:["string"],operator:function(a,b){return a===b?true:a?a.indexOf(b)===0:false}},{name:"EndsWith",arity:2,applicableTo:["string"],operator:function(a,b){if(a===b)return true;if(a){var c=a.lastIndexOf(b);return c>=0?a.length-c===b.length:false}return false}},{name:"Equals",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b===a}},{name:"NotEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b!==a}},{name:"Greater",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b>a}},{name:"Less",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b<a}},{name:"GreaterOrEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b>=a}},{name:"LessOrEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b<=a}},{name:"IsEmpty",arity:1,applicableTo:["string"],operator:function(a){return!a&&a!==0&&a!==false}},{name:"NotIsEmpty",arity:1,applicableTo:["string"],operator:function(a){return!!a||a===0||a===false}},{name:"IsNull",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(a){return a===null}},{name:"NotIsNull",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(a){return a!==null}}]})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{htmlTableAccessor:function(e){var c=[],d=0,b=e;f();function f(){var f=[],e,h,n,k,g,a,m,j,l,i;for(h=0,n=b.rows.length;h<n;h++){e=[];c[h]=e;k=b.rows[h];for(g=0,a=0,m=k.cells.length;g<m;g++,a++){j=k.cells[g];for(;f[a]>1;a++){f[a]--;e[a]={cellIdx:-1,colIdx:-1}}if(!(f[a]>1))f[a]=j.rowSpan;e[a]={cellIdx:g,colIdx:-1};e[g].colIdx=a;l=j.colSpan;for(;l>1;l--)e[++a]={cellIdx:-1,colIdx:-1}}i=f.length;for(;a<i;a++){f[a]--;e[a]={cellIdx:-1,colIdx:-1}}d=Math.max(d,i)}}this.element=function(){return e};this.getCellIdx=function(a,b){return a<d?c[b][a].cellIdx:-1};this.getColumnIdx=function(a,e){if(typeof a!=="number"){var b=a;a=b.cellIndex;e=b.parentNode.rowIndex}return a<d?c[e][a].colIdx:-1};this.getSectionLength=function(c){return a.wijmo.wijgrid.getTableSectionLength(b,c)};this.getSectionRow=function(c,d){return a.wijmo.wijgrid.getTableSectionRow(b,d,c)};this.forEachColumnCellNatural=function(c,g,h){var a,f,e,d;for(a=0,f=b.rows.length;a<f;a++){e=b.rows[a];if(c<e.cells.length){d=g(e.cells[c],c,h);if(d!==true)return d}}return true};this.forEachColumnCell=function(h,i,j){var a,f,g,d,e;for(a=0,f=c.length;a<f;a++){g=b.rows[a];d=this.getCellIdx(h,a);if(d>=0){e=i(g.cells[d],a,j);if(e!==true)return e}}return true};this.forEachRowCell=function(g,f,h){var e=b.rows[g],a,d,c;for(a=0,d=e.cells.length;a<d;a++){c=f(e.cells[a],a,h);if(c!==true)return c}return true};this.colGroupTag=function(){var a=b.getElementsByTagName("colgroup");return a!==null&&a.length>0?a[0]:null};this.colTags=function(){var a=this.colGroupTag();return a!==null?a.getElementsByTagName("col"):[]}}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.cellInfo=function(d,c){var e=false,b=null;this.cellIndex=function(a){if(arguments.length===0)return d;d=a};this.column=function(){if(b&&this._isValid()){var a=b._getDataToAbsOffset();return b._field("visibleLeaves")[d+a.x]}return null};this.rowIndex=function(a){if(arguments.length===0)return c;c=a};this.isEqual=function(a){return a&&a.rowIndex()===c&&a.cellIndex()===d};this.tableCell=function(){if(b&&this._isValid()){var a=b._getDataToAbsOffset();return b._view().getCell(d+a.x,c+a.y)}return null};this.container=function(){var c=this.tableCell(),b;if(c){b=a(c).children("div.wijmo-wijgrid-innercell");if(b)return b}return null};this.value=function(e){var d,f;if(b&&this._isValid()){f=b.dataTable[c];if(f.rowType&a.wijmo.wijgrid.rowType.data){d=this.column();if(arguments.length===0)return f[d.dataIndex].value;else{e=b._parse(d,e);if(e===null&&d.valueRequired||d.dataType&&d.dataType!=="string"&&isNaN(e))throw"invalid value";f[d.dataIndex].value=e;b._dataStore.updateValue(f.originalRowIndex,d.dataKey,e)}}}};this.row=function(){var a=this._row();if(a!==null){a=b._createRowInfo(a);return a}return null};this.toString=function(){return d+":"+c};this._dataToAbs=function(a){d-=a.x;c-=a.y;return this};this._clip=function(e){var b=false,a;if(d<(a=e.topLeft().cellIndex())){b=true;d=a}if(d>(a=e.bottomRight().cellIndex())){b=true;d=a}if(c<(a=e.topLeft().rowIndex())){b=true;c=a}if(c>(a=e.bottomRight().rowIndex())){b=true;c=a}return b};this._clone=function(){return new a.wijmo.wijgrid.cellInfo(d,c)};this._row=function(){return b&&this._isValid()?b._rows().item(c):null};this._isValid=function(){return d>=0&&c>=0};this._isEdit=function(a){if(!arguments.length)return e;e=a};this._setGridView=function(a){b=a}};a.wijmo.wijgrid.cellInfo.prototype.outsideValue=new a.wijmo.wijgrid.cellInfo(-1,-1);a.wijmo.wijgrid.cellInfoRange=function(e,d){if(!e||!d)throw"invalid arguments";var b=e._clone(),c=d._clone();this.bottomRight=function(){return c};this.isEqual=function(a){return a&&b.isEqual(a.topLeft())&&c.isEqual(a.bottomRight())};this.topLeft=function(){return b};this.toString=function(){return b.toString()+" - "+c.toString()};this._isIntersect=function(a){var d,f,e,g;if(a){d=a.bottomRight().rowIndex()-a.topLeft().rowIndex()+1;f=c.rowIndex()-b.rowIndex()+1;if(a.topLeft().rowIndex()+d-b.rowIndex()<d+f){e=a.bottomRight().cellIndex()-a.topLeft().cellIndex()+1;g=c.cellIndex()-b.cellIndex()+1;return a.topLeft().cellIndex()+e-b.cellIndex()<e+g}}return false};this._isValid=function(){return b._isValid()&&c._isValid()};this._clip=function(a){return b._clip(a)|c._clip(a)};this._clone=function(){return new a.wijmo.wijgrid.cellInfoRange(b._clone(),c._clone())};this._containsCellInfo=function(a){return a&&a.cellIndex()>=b.cellIndex()&&a.cellIndex()<=c.cellIndex()&&a.rowIndex()>=b.rowIndex()&&a.rowIndex()<=c.rowIndex()};this._containsCellRange=function(a){return a&&this._containsCellInfo(a.topLeft())&&this._containsCellInfo(a.bottomRight())};this._extend=function(d,a){if(d===1){b.rowIndex(a.topLeft().rowIndex());c.rowIndex(a.bottomRight().rowIndex())}else if(d===2){b.cellIndex(a.topLeft().cellIndex());c.cellIndex(a.bottomRight().cellIndex())}return this};this._normalize=function(){var a=b.cellIndex(),e=b.rowIndex(),d=c.cellIndex(),f=c.rowIndex();b.cellIndex(Math.min(a,d));b.rowIndex(Math.min(e,f));c.cellIndex(Math.max(a,d));c.rowIndex(Math.max(e,f))}}})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{classFactory:function(f,g){var h="#fake#",i=/xyz/.test(function(){xyz})?/\b_base\b/:/.*/,e=f?f.prototype:function(){},c=f?new f(h):new e,a,b,d;for(a in g)if(g.hasOwnProperty(a)){b=g[a];if(e&&typeof b==="function"&&typeof e[a]==="function"&&i.test(b))c[a]=function(b,a){return function(){var d=this._base,c;this._base=e[b];c=a.apply(this,arguments);if(d!==undefined)this._base=d;else delete this._base;return c}}(a,b);else c[a]=b}d=function(a){a!==h&&this.ctor&&this.ctor.apply(this,arguments)};d.prototype=c;d.constructor=c;return d}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.baseView=a.wijmo.wijgrid.classFactory(null,{ctor:function(a){if(!a)throw"'wijgrid' must be specified";this._verScrollBarSize=18;this._wijgrid=a},dispose:function(){this.toggleDOMSelection(true)},ensureWidth:function(a,b){arguments.length>0&&this._setColumnWidth(b,a);this.refreshPanel()},getScrollValue:function(){throw"not implemented";},getVisibleAreaBounds:function(){throw"not implemented";},render:function(){this._preRender();this._renderContent();this._postRender()},refreshPanel:function(){throw"not implemented";},scrollTo:function(){throw"not implemented";},toggleDOMSelection:function(b){a.each(this.subTables(),function(d,c){new a.wijmo.wijgrid.domSelection(c.element()).toggleSelection(b)})},updateSplits:function(a){this.refreshPanel(a)},focusableElement:function(){throw"not implemented";},forEachColumnCell:function(){throw"not implemented";},forEachRowCell:function(){throw"not implemented";},getAbsoluteCellInfo:function(){throw"not implemented";},getAbsoluteRowIndex:function(){throw"not implemented";},getCell:function(){throw"not implemented";},getColumnIndex:function(){throw"not implemented";},getHeaderCell:function(){throw"not implemented";},getJoinedCols:function(){throw"not implemented";},getJoinedRows:function(){throw"not implemented";},getJoinedTables:function(){throw"not implemented";},subTables:function(){throw"not implemented";},_getGridWidth:function(){throw"not implemented";},_getMappedScrollMode:function(){var c=this._wijgrid.options.scrollMode,b="auto",a="auto";switch(c){case"horizontal":b="hidden";a="visible";break;case"vertical":b="visible";a="hidden";break;case"both":b="visible";a="visible"}return{vScrollBarVisibility:b,hScrollBarVisibility:a}},_getSuperPanel:function(){throw"not implemented";},_postRender:function(){this.toggleDOMSelection(this._wijgrid.options.selectionMode==="none")},_preRender:function(){throw"not implemented";},_renderContent:function(){throw"not implemented";},_setColumnWidth:function(){throw"not implemented";}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.flatView=a.wijmo.wijgrid.classFactory(a.wijmo.wijgrid.baseView,{ctor:function(a){this._base(a);this._dataTable=null;this._contentArea=null},getScrollValue:function(){var a=this._getSuperPanel();return a?{type:"flat",hScrollValue:a.options.hScroller.scrollValue,vScrollValue:a.options.vScroller.scrollValue}:{type:"flat",hScrollValue:null,vScrollValue:null}},getVisibleAreaBounds:function(){var b=a.wijmo.wijgrid.bounds(this._dataTable.element()),c;if(this._wijgrid.options.scrollMode==="none")return b;else{c=a.wijmo.wijgrid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-se:first")[0]);return{top:b.top,left:b.left,width:Math.min(c.width,b.width),height:Math.min(c.height,b.height)}}},refreshPanel:function(b){var c=this._wijgrid,f=c.options.scrollMode,e=c.outerDiv,a,d;if(f!=="none"){a=e.find(".wijmo-wijgrid-content-area");d=this._getMappedScrollMode();a.width(this._getGridWidth(f));a.height(e.innerHeight());if(!a.data("wijsuperpanel"))a.wijsuperpanel({bubbleScrollingEvent:false,vScroller:{scrollBarVisibility:d.vScrollBarVisibility,scrollValue:b.type==="flat"?b.vScrollValue:null},hScroller:{scrollBarVisibility:d.hScrollBarVisibility,scrollValue:b.type==="flat"?b.hScrollValue:null},hScrollerActivating:function(e,d){var b;if(c._autoHeight){b=c.element.height()-d.contentLength;if(b>0){a.height(a.height()+b);a.wijsuperpanel("paintPanel");return false}}}});else a.wijsuperpanel("paintPanel")}},scrollTo:function(r){var g=this._getSuperPanel(),q=r.tableCell(),j=q.nodeType?a(q):q,f,l,h,d,p,n,k,b,c,o,m,i=null,e=null;if(g&&j.is(":visible")){f=g.getContentElement();l=f.parent();h=parseInt((f.css("left")+"").replace("px",""),10)*-1;d=parseInt((f.css("top")+"").replace("px",""),10)*-1;p=l.outerWidth();n=l.outerHeight();k=j.position();b=Math.abs(k.left);c=Math.abs(k.top);o=j.outerWidth();m=j.outerHeight();if(c+m>d+n)d=e=c+m-n;if(b+o>h+p)h=i=b+o-p;if(c<d)e=c;if(b<h)i=b;if(r.row()._dataTableRowIndex===0&&d>0)e=0;i!==null&&g.hScrollTo(i);e!==null&&g.vScrollTo(e)}},updateSplits:function(t){var l=this,g=this._wijgrid,b=this._wijgrid.options,q=false,c=g.element,d=[],j=g._field("visibleLeaves"),u=g.options.scrollMode,k=g.outerDiv,f,o,s,e,h,m,r,p,i,n=[];a.each(j,function(e,g){var c,d,f=g.width;if(f){q=true;c=l.getHeaderCell(e);d=typeof f==="string";if(!d&&b.ensureColumnsPxWidth){l._setColumnWidth(e,f);g._realWidth=true;n.push({th:a(c),clientWidth:c.clientWidth,index:e,isPercentage:d,ensurePxWidth:true})}else{c.width=f;n.push({th:a(c),clientWidth:c.clientWidth,index:e,isPercentage:d})}}});if(b.scrollMode!=="none"||q||b.allowColSizing||b.showFilter||b.allowEditing||b.autoExpandColumnIndex){if(!b.ensureColumnsPxWidth){f=b.scrollMode==="none"?k:k.find(".wijmo-wijgrid-content-area");r=this._testNeedVBar(k,c,u,g._autoHeight);r&&f.width(f.width()-this._verScrollBarSize);p=!b.ensureColumnsPxWidth&&f.innerWidth()>c[0].offsetWidth;i=b.autoExpandColumnIndex;if(p&&!i){c.css("width","100%");o=c.width()}}a.each(j,function(a){l._setColumnWidth(a,null,d)});a.each(n,function(b,a){if(a.ensurePxWidth)return;a.th.removeAttr("width");if(!a.isPercentage)d[a.index]=a.clientWidth});a.each(d,function(a,c){var b=j[a];if(b._realWidth){delete b._realWidth;return}l._setColumnWidth(a,c)});if(p){if(i)o=c.width();else c.css("width","auto");s=b.autoExpandColumnIndex?f.width():c.width();h=s-o;if(!i)h=-h}if(h&&j.length>0){m=d.length-1;e=b.autoExpandColumnIndex||m;if(e>m)e=m;this._setColumnWidth(e,d[e]+h)}}else k.innerWidth()>c[0].offsetWidth&&c.css("width","100%");this._base(t)},focusableElement:function(){return a(this._dataTable.element())},forEachColumnCell:function(a,b,c){return this._dataTable.forEachColumnCell(a,b,c)},forEachRowCell:function(b,a,c){return this._dataTable.forEachRowCell(b,a,c)},getAbsoluteCellInfo:function(b){return new a.wijmo.wijgrid.cellInfo(this.getColumnIndex(b),b.parentNode.rowIndex)},getAbsoluteRowIndex:function(a){return a.rowIndex},getCell:function(d,b){var c=this._dataTable.getCellIdx(d,b),a;if(c>=0){a=this.getJoinedRows(b,0);if(a[0])return a[0].cells[c]}return null},getColumnIndex:function(a){return this._dataTable.getColumnIdx(a)},getHeaderCell:function(d){var b=this._wijgrid._field("visibleLeaves")[d],c;return b&&(c=this._wijgrid._headerRows())?(new a.wijmo.wijgrid.rowAccessor).getCell(c.item(b.thY),b.thX):null},getJoinedCols:function(c){var b=a(this._dataTable.element()).find("> colgroup");if(b.length)if(c<b[0].childNodes.length)return[b[0].childNodes[c],null];return[null,null]},getJoinedRows:function(a,b){return[this._dataTable.getSectionRow(a,b),null]},getJoinedTables:function(b,a){return[this._dataTable,null,a]},subTables:function(){return[this._dataTable]},_getGridWidth:function(c){var a=this._wijgrid.element.width(),b=this._wijgrid.outerDiv.innerWidth();if(this._testNeedVBar(this._wijgrid.outerDiv,this._wijgrid.element,c,this._wijgrid._autoHeight))a+=this._verScrollBarSize;if(a>b)a=b;return a},_getSuperPanel:function(){var a=this._wijgrid.outerDiv.find(".wijmo-wijgrid-content-area");return a?a.data("wijsuperpanel"):null},_postRender:function(){this._wijgrid.element.addClass("wijmo-wijgrid-table").find("> tbody").addClass("ui-widget-content wijmo-wijgrid-data");this._dataTable=new a.wijmo.wijgrid.htmlTableAccessor(this._wijgrid.element[0]);this._wijgrid.element.attr({role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}).css("border-collapse","separate");this._base()},_preRender:function(){this._wijgrid.options.scrollMode!=="none"&&this._wijgrid.outerDiv.wrapInner('<div class="wijmo-wijgrid-fixedview"><div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div>')},_renderContent:function(){var n=this._wijgrid._field("visibleLeaves"),q=this._wijgrid.element[0],r=null,p,k,I,j,G,i,K,d,f,o,l,u,h,w,J,z,y,H,b,B,t,D,e,x,v,E,g,F,C,L=-1,A=0,c=a.wijmo.wijgrid.rowType,m=a.wijmo.wijgrid.renderState,s;p=this._wijgrid._field("spanTable");if(p&&p.length){r=q.createTHead();I=p[0].length;for(j=0,G=p.length;j<G;j++){i=this._wijgrid._createRow(r,c.header,j);g=this._wijgrid._createRowInfo([i],c.header,m.rendering,-1,-1,-1,-1);K=0;for(d=0;d<I;d++){k=p[j][d];if(k.column&&k.column.parentVis){k.column.thX=K++;k.column.thY=j;f=a(this._wijgrid._createCell(c.header,j,d,k.column));o=f.children("div");i.appendChild(f[0]);this._wijgrid.cellFormatter.format(o,k.column,k.column.headerText,g);this._wijgrid._cellCreated(f,d,k.column,g,m.rendering,{colSpan:k.colSpan,rowSpan:k.rowSpan})}}this._wijgrid._rowCreated(g)}}if(this._wijgrid.options.showFilter){if(!r)r=q.createTHead();i=this._wijgrid._createRow(r,c.filter,-1);g=this._wijgrid._createRowInfo([i],c.filter,m.rendering,-1,-1,-1,-1);for(l=0,u=n.length;l<u;l++){h=n[l];f=a(this._wijgrid._createCell(c.filter,undefined,l,h));i.appendChild(f[0]);this._wijgrid.cellFormatter.format(f,h,h.filterValue,g);this._wijgrid._cellCreated(f,l,h,g,m.rendering)}this._wijgrid._rowCreated(g)}w=document.createElement("colgroup");for(l=0,u=n.length;l<u;l++){J=document.createElement("col");w.appendChild(J)}q.appendChild(w);z=this._wijgrid.dataTable;y=a.wijmo.wijgrid.ensureTBody(q);if(this._wijgrid._dataStore.dataMode()===a.wijmo.wijgrid.dataMode.dynamical)A=this._wijgrid.options.pageIndex*this._wijgrid.options.pageSize;for(j=0,H=z.length;j<H;j++){b=z[j];B=b.length;s=(b.rowType&c.data)!==0;i=this._wijgrid._createRow(y,b.rowType,b.originalRowIndex);g=this._wijgrid._createRowInfo([i],b.rowType,m.rendering,j,s?++L:-1,s?b.originalRowIndex:-1,s?A+b.originalRowIndex:-1);for(d=0,t=n.length;d<t;d++){h=n[d];D=h.dataIndex;e=0;x=false;switch(b.rowType){case c.data:case c.data|c.dataAlt:e=D;if(e>=0&&(!b[e]||b[e].visible===false))continue;break;case c.emptyDataRow:case c.groupHeader:case c.groupFooter:e=d;if(e>=B)x=true}if(x)break;f=a(this._wijgrid._createCell(b.rowType,b.originalRowIndex,e,h));o=f.children("div");i.appendChild(f[0]);if(b.rowType&c.data&&h.dataParser){v=null;if(e>=0){E=b[e].value;v=this._wijgrid._toStr(h,E)}this._wijgrid.cellFormatter.format(o,h,v,g)}else e>=0&&o.html(b[e].html);F=e>=0?b[e].__attr:null;C=e>=0?b[e].__style:null;this._wijgrid._cellCreated(f,d,h,g,m.rendering,F,C)}if(!i.cells.length)y.removeChild(i);else this._wijgrid._rowCreated(g,b.__attr,b.__style)}if(this._wijgrid.options.showFooter){i=this._wijgrid._createRow(q.createTFoot(),c.footer,-1);g=this._wijgrid._createRowInfo([i],c.footer,m.rendering,-1,-1,-1,-1);for(d=0,t=n.length;d<t;d++){h=n[d];f=a(this._wijgrid._createCell(c.footer,undefined,d,h));o=f.children("div");i.appendChild(f[0]);this._wijgrid.cellFormatter.format(o,h,"",g);this._wijgrid._cellCreated(f,l,h,g,m.rendering)}this._wijgrid._rowCreated(g)}},_setColumnWidth:function(e,b,d){var c=this.getHeaderCell(e);if(c){b=b?b:c.clientWidth;if(d){d.push(b);return}if(b){a(c).children("div.wijmo-wijgrid-innercell").setOutWidth(b);this.forEachColumnCell(e,function(d){var c=a(d.parentNode);c.parent().is("tbody")&&!c.is(".wijmo-wijgrid-emptydatarow",".wijmo-wijgrid-groupheaderrow",".wijmo-wijgrid-groupfooterrow")&&a(d).children("div.wijmo-wijgrid-innercell").setOutWidth(b);return true})}}},_testNeedVBar:function(f,a,c,g){var b=false,i=a.width(),e=a.height(),h=f.width(),d=f.height();a[0].style.width==="auto"&&a.css("width","");if(c==="both"||c==="vertical")b=true;else b=c==="auto"&&(e>d||!g&&i>h&&e>d-this._verScrollBarSize);return b}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.fixedView=a.wijmo.wijgrid.classFactory(a.wijmo.wijgrid.baseView,{ctor:function(a){this._base(a);this._rowsCount,this._viewTables={},this._table00,this._table01,this._table10,this._table11,this._scroller,this.element=this._wijgrid.element},getScrollValue:function(){var a=this._getSuperPanel();return a?{type:"fixed",hScrollValue:a.options.hScroller.scrollValue,vScrollValue:a.options.vScroller.scrollValue}:{type:"fixed",hScrollValue:null,vScrollValue:null}},getVisibleAreaBounds:function(){return a.wijmo.wijgrid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first"))},refreshPanel:function(c){var b=this,d=this._getMappedScrollMode();this._scroller.width(this._getGridWidth(this._wijgrid.options.scrollMode));if(!this._scroller.data("wijsuperpanel"))this._scroller.wijsuperpanel({scrolled:a.proxy(this._onScrolled,this),bubbleScrollingEvent:false,vScroller:{scrollBarVisibility:d.vScrollBarVisibility,scrollValue:c.type==="fixed"?c.vScrollValue:null},hScroller:{scrollBarVisibility:d.hScrollBarVisibility,scrollValue:c.type==="fixed"?c.hScrollValue:null},hScrollerActivating:function(e,d){var a,c;if(b._wijgrid._autoHeight){a=b._wijgrid.element.height()+b._wijgrid.options.splitDistanceY-d.contentLength;if(a>0){c=b._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-sw");c.height(c.height()+a);b._scroller.height(b._scroller.height()+a);b._scroller.wijsuperpanel("paintPanel");return false}}}});else this._scroller.wijsuperpanel("paintPanel");this._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-ne").width(this._scroller.wijsuperpanel("getContentElement").parent().width());this._onScrolled()},scrollTo:function(s){var r=this._wijgrid.options,e=this._getSuperPanel(),q=s.tableCell(),j=q.nodeType?a(q):q,d,l,f,h,p,n,k,b,c,o,m,g=null,i=null;if(e&&j.is(":visible")){d=e.getContentElement();l=d.parent();f=parseInt((d.css("left")+"").replace("px",""),10)*-1;h=parseInt((d.css("top")+"").replace("px",""),10)*-1;p=l.outerWidth()-r.splitDistanceX;n=l.outerHeight()-r.splitDistanceY;k=j.position();b=Math.abs(k.left);c=Math.abs(k.top);o=j.outerWidth();m=j.outerHeight();if(c+m>h+n)h=i=c+m-n;if(b+o>f+p)f=g=b+o-p;if(c<h)i=c;if(b<f)g=b;g!==null&&e.hScrollTo(g);i!==null&&e.vScrollTo(i)}},updateSplits:function(u){var d=this._wijgrid,b=d.options,n=[],g,r,k,o,f,t,m,e,p,i,l=this,j=[],v=b.scrollMode,h=d._field("visibleLeaves"),s=a(this._table11.element()),c=a(this._table01.element()),q=d.outerDiv;try{if(b.staticRowIndex>=0)b.splitDistanceY=q.find(".wijmo-wijgrid-split-area-ne table")[0].offsetHeight;else b.splitDistanceY=0;if(d._staticColumnIndex>=0)b.splitDistanceX=q.find(".wijmo-wijgrid-split-area-nw table")[0].offsetWidth;else b.splitDistanceX=0}catch(w){}this._updateSplitAreaBounds();r=s.find("tbody .wijmo-wijgrid-row:not(.wijmo-wijgrid-groupheaderrow):first");this.fooRow=k=r.clone().removeAttr("datarowindex").addClass("wijmo-wijgrid-foorow").appendTo(r.parent()).show().height(0).css({"font-size":"0"});this.fooRowCells=k.find(">td").height(0).css({"border-top":"0","border-bottom":"0"}).find(">div.wijmo-wijgrid-innercell").css({"padding-top":"0px","padding-bottom":"0px"}).empty();k.css("visibility","hidden");k.length===0&&d.element.css("width","100%");a.each(h,function(e,g){var c,d,f=g.width;if(f){d=typeof f==="string";c=l.getHeaderCell(e);if(!d&&b.ensureColumnsPxWidth){l._setColumnWidth(e,f);g._realWidth=true;n.push({th:a(c),clientWidth:c.clientWidth,index:e,isPercentage:d,ensurePxWidth:true})}else{c.width=f;n.push({th:a(c),clientWidth:c.clientWidth,index:e,isPercentage:d})}}});if(!b.ensureColumnsPxWidth&&this._testNeedVBar(d.outerDiv,s,c,v,d._autoHeight))i=this._scroller.width()-this._verScrollBarSize;else i=this._scroller.width();this._scroller.width(i);c.parent().width(i);if(!b.ensureColumnsPxWidth){p=c.width()<q.innerWidth();g=b.autoExpandColumnIndex;if(p&&!g){c.css("width","100%");o=c.width()}}a.each(h,function(a){l._setColumnWidth(a,null,j)});a.each(n,function(b,a){if(a.ensurePxWidth)return;a.th.removeAttr("width")});a.each(j,function(a,c){var b=h[a];if(b._realWidth){delete b._realWidth;return}l._setColumnWidth(a,c)});if(p){if(g)o=c.width();else c.css("width","auto");t=b.autoExpandColumnIndex?this._scroller.width():c.width();f=t-o;if(!g)f=-f}if(f&&h.length>0){m=j.length-1;e=b.autoExpandColumnIndex||m;if(e>m)e=m;this._setColumnWidth(e,j[e]+f)}this._base(u)},focusableElement:function(){return this._wijgrid.outerDiv},forEachColumnCell:function(f,d,e){var b=this.getJoinedTables(true,f),c,a;if(b[0]!==null){c=b[2];a=b[0].forEachColumnCell(c,d,e);if(a!==true)return a;if(b[1]!==null){a=b[1].forEachColumnCell(c,d,e);if(a!==true)return a}}return true},forEachRowCell:function(h,f,g){var c=this.getJoinedTables(false,h),d=c[0],e=c[1],b,a;if(d!==null){b=c[2];if(b<d.element().rows.length){a=d.forEachRowCell(b,f,g);if(a!==true)return a}if(e!==null&&b<e.element().rows.length){a=e.forEachRowCell(b,f,g);if(a!==true)return a}}return true},getAbsoluteCellInfo:function(b){return new a.wijmo.wijgrid.cellInfo(this.getColumnIndex(b),this.getAbsoluteRowIndex(b.parentNode))},getAbsoluteRowIndex:function(b){var c=b.rowIndex,a=b.parentNode;while(a.tagName.toLowerCase()!=="table")a=a.parentNode;return a===this._table00.element()||a===this._table01.element()?c:c+this._wijgrid._getRealStaticRowIndex()+1},getCell:function(g,h){var a=this.getJoinedTables(false,h),c,e,d,b,f;if(a[0]!==null){c=this.getJoinedTables(true,g);if(c[0]!==null){e=a[2];d=c[2];b=null;if(a[1]!==null)b=g===d?a[0]:a[1];else b=a[0];f=b.getCellIdx(d,e);if(f>=0)return b.element().rows[e].cells[f]}}return null},getColumnIndex:function(e){for(var a=null,b=null,d=false,c,a=e.parentNode;a.tagName.toLowerCase()!=="table";a=a.parentNode);if(a!==null){if(a===this._table00.element())b=this._table00;else if(a===this._table01.element()){b=this._table01;d=true}else if(a===this._table10.element())b=this._table10;else if(a===this._table11.element()){b=this._table11;d=true}if(b!==null){c=b.getColumnIdx(e);if(d)c+=this._wijgrid._getRealStaticColumnIndex()+1;return c}}return-1},getHeaderCell:function(d){var b=this._wijgrid._field("visibleLeaves")[d],c;return b&&(c=this._wijgrid._headerRows())?(new a.wijmo.wijgrid.rowAccessor).getCell(c.item(b.thY),b.thX):null},getJoinedCols:function(c){var d=[],b=this.getJoinedTables(true,c);b.splice(b.length-1,1);a.each(b,function(e,b){d.push(a(b.element()).find("col")[c])});return d},getJoinedRows:function(c,e){var f=null,g=null,a=null,d=null,l=this._wijgrid._getRealStaticRowIndex(),b=this._wijgrid._getRealStaticColumnIndex(),m=this._wijgrid._field("leaves").length-1,n=this._rowsCount-1,k=l===n,h=l<0,j=!k&&!h,i=0;if(k||j){if(b>=0&&b<m){a=this._table00;d=this._table01}else a=b<0?this._table01:this._table00;i=a.getSectionLength(e);if(c<i){f=a.getSectionRow(c,e);if(d!==null)g=d.getSectionRow(c,e)}}if(h||j&&f===null){if(!h)c-=i;if(b>=0&&b<m){a=this._table10;d=this._table11}else a=b<0?this._table11:this._table10;f=a.getSectionRow(c,e);if(d!==null)g=d.getSectionRow(c,e)}return f===null&&g===null?null:[f,g]},getJoinedTables:function(h,g){var a=null,b=null,c=g,f=this._wijgrid,e=f._getRealStaticRowIndex(),d=f._getRealStaticColumnIndex();if(h){if(g<=d){a=this._table00;b=this._table10}else{a=this._table01;b=this._table11;c=c-(d+1)}if(e<0)a=null;if(e===this._rowsCount-1)b=null}else{if(g<=e){a=this._table00;b=this._table01}else{a=this._table10;b=this._table11;c=c-(e+1)}if(d<0)a=null;if(d===f._field("leaves").length-1)b=null}if(a===null){a=b;b=null}return[a,b,c]},subTables:function(){return[this._table00,this._table01,this._table10,this._table11]},_getGridWidth:function(e){var b=this._wijgrid,c=b.element.outerWidth(true),d=b.outerDiv.innerWidth();if(this._testNeedVBar(b.outerDiv,b.element,a(this._table01.element()),e,b._autoHeight))c+=this._verScrollBarSize;if(c>d)c=d;return c},_getSuperPanel:function(){return this._scroller?this._scroller.data("wijsuperpanel"):null},_postRender:function(){var b;for(b in this._viewTables)this._viewTables.hasOwnProperty(b)&&a(this._viewTables[b]).addClass("wijmo-wijgrid-table").attr("role","grid").find("> tbody").addClass("ui-widget-content wijmo-wijgrid-data");this._table00=new a.wijmo.wijgrid.htmlTableAccessor(this._viewTables.nw);this._table01=new a.wijmo.wijgrid.htmlTableAccessor(this._viewTables.ne);this._table10=new a.wijmo.wijgrid.htmlTableAccessor(this._viewTables.sw);this._table11=new a.wijmo.wijgrid.htmlTableAccessor(this._viewTables.se);this._rowsCount=Math.max(this._viewTables.nw.rows.length,this._viewTables.ne.rows.length)+Math.max(this._viewTables.sw.rows.length,this._viewTables.se.rows.length);a(this._viewTables.ne).attr({cellpadding:"0",border:"0",cellspacing:"0"}).css("border-collapse","separate");a(this._viewTables.se).attr({cellpadding:"0",border:"0",cellspacing:"0"}).css("border-collapse","separate");this._base()},_preRender:function(){this._wijgrid.outerDiv.wrapInner('<div class="wijmo-wijgrid-fixedview"><div class="wijmo-wijgrid-scroller"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>');this._scroller=this._wijgrid.outerDiv.find(".wijmo-wijgrid-scroller");this._scroller.after('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>');this._scroller.after('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>');this._scroller.after('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')},_renderContent:function(){var b=this._wijgrid,s=b._field("visibleLeaves"),y=document.createDocumentFragment(),v=b._field("spanTable"),W=b._getRealStaticRowIndex(),u=b._getRealStaticColumnIndex(),q={},T,l,R,c,M,e,d,V,h,n,f,m,U,k,p,x,w,C,B,K,o={},D,S,A,O,j,F,t,E,P,H,G,J,I,Q,N,i,X=-1,L=0,g=a.wijmo.wijgrid.rowType,r=a.wijmo.wijgrid.renderState,z;this._viewTables={nw:y.appendChild(document.createElement("table")),ne:y.appendChild(document.createElement("table")),sw:y.appendChild(document.createElement("table")),se:y.appendChild(b.element[0])};if(v&&v.length){q.nw=this._viewTables.nw.createTHead();q.ne=this._viewTables.ne.createTHead();T=v[0].length;for(l=0,R=v.length;l<R;l++){e=null;d=null;e=b._createRow(q.nw,g.header,l);d=b._createRow(q.ne,g.header,l);i=b._createRowInfo([e,d],g.header,r.rendering,-1,-1,-1,-1);V=0;for(h=0;h<T;h++){n=v[l][h];if(n.column&&n.column.parentVis){n.column.thX=V++;n.column.thY=l;f=a(b._createCell(g.header,l,h,n.column));t=f.children("div");if(h<=u)e.appendChild(f[0]);else d.appendChild(f[0]);b.cellFormatter.format(t,n.column,n.column.headerText,i);b._cellCreated(f,h,n.column,i,r.rendering,{colSpan:n.colSpan,rowSpan:n.rowSpan})}}b._rowCreated(i)}}if(b.options.showFilter){if(q.nw)e=b._createRow(q.nw,g.filter,-1);if(q.ne)d=b._createRow(q.ne,g.filter,-1);i=b._createRowInfo([e,d],g.filter,r.rendering,-1,-1,-1,-1);for(m=0,U=s.length;m<U;m++){k=s[m];f=a(b._createCell(g.filter,undefined,m,k));if(m<=u)e.appendChild(f[0]);else d.appendChild(f[0]);b.cellFormatter.format(f,k,k.filterValue,i);b._cellCreated(f,m,k,i,r.rendering)}b._rowCreated(i)}p={t0:this._viewTables.nw,t1:this._viewTables.sw};for(x in p)if(p.hasOwnProperty(x)){w=document.createElement("colgroup");for(m=0;m<=u;m++){C=document.createElement("col");w.appendChild(C)}B=p[x];B.appendChild(w)}p={t0:this._viewTables.ne,t1:this._viewTables.se};for(x in p)if(p.hasOwnProperty(x)){w=document.createElement("colgroup");for(m=u+1;m<s.length;m++){C=document.createElement("col");w.appendChild(C)}B=p[x];B.appendChild(w)}K=b.dataTable;o={nw:a.wijmo.wijgrid.ensureTBody(this._viewTables.nw),ne:a.wijmo.wijgrid.ensureTBody(this._viewTables.ne),sw:a.wijmo.wijgrid.ensureTBody(this._viewTables.sw),se:a.wijmo.wijgrid.ensureTBody(this._viewTables.se)};D=W-(v.length+(b.options.showFilter?1:0));if(b._dataStore.dataMode()===a.wijmo.wijgrid.dataMode.dynamical)L=b.options.pageIndex*b.options.pageSize;for(l=0,S=K.length;l<S;l++){c=K[l];M=c.length;z=(c.rowType&g.data)!==0;e=null;d=null;if(l<=D){e=b._createRow(o.nw,c.rowType,c.originalRowIndex);d=b._createRow(o.ne,c.rowType,c.originalRowIndex)}else{e=b._createRow(o.sw,c.rowType,c.originalRowIndex);d=b._createRow(o.se,c.rowType,c.originalRowIndex)}i=b._createRowInfo([e,d],c.rowType,r.rendering,l,z?++X:-1,z?c.originalRowIndex:-1,z?L+c.originalRowIndex:-1);for(h=0,A=s.length;h<A;h++){k=s[h];O=k.dataIndex;j=0;F=false;switch(c.rowType){case g.data:case g.data|g.dataAlt:j=O;if(j>=0&&(!c[j]||c[j].visible===false))continue;break;case g.emptyDataRow:case g.groupHeader:case g.groupFooter:j=h;if(j>=M)F=true}if(F)break;f=a(b._createCell(c.rowType,c.originalRowIndex,j,k));t=f.children("div");if(h<=u)e.appendChild(f[0]);else d.appendChild(f[0]);if(c.rowType&g.data&&k.dataParser){E=null;if(j>=0){P=c[j].value;E=b._toStr(k,P)}b.cellFormatter.format(t,k,E,i)}else j>=0&&t.html(c[j].html);Q=j>=0?c[j].__attr:null;N=j>=0?c[j].__style:null;b._cellCreated(f,h,k,i,r.rendering,Q,N)}if(l<=D){if(!e.cells.length){o.nw.removeChild(e);e=null}if(!d.cells.length){o.ne.removeChild(d);d=null}(e||d)&&b._rowCreated(i,c.__attr,c.__style)}else{if(!e.cells.length){o.sw.removeChild(e);e=null}if(!d.cells.length){o.se.removeChild(d);d=null}(e||d)&&b._rowCreated(i,c.__attr,c.__style)}}if(b.options.showFooter){e=b._createRow(this._viewTables.sw.createTFoot(),g.footer,-1);d=b._createRow(this._viewTables.se.createTFoot(),g.footer,-1);i=b._createRowInfo([e,d],g.footer,r.rendering,-1,-1,-1,-1);for(h=0,A=s.length;h<A;h++){k=s[h];f=a(b._createCell(g.footer,undefined,h,k));t=f.children("div");if(h<=u)e.appendChild(f[0]);else d.appendChild(f[0]);b.cellFormatter.format(t,k,"",i);b._cellCreated(f,m,k,i,r.rendering)}b._rowCreated(i)}H=b.outerDiv.find(".wijmo-wijgrid-split-area-nw");G=b.outerDiv.find(".wijmo-wijgrid-split-area-ne");J=b.outerDiv.find(".wijmo-wijgrid-split-area-sw");I=b.outerDiv.find(".wijmo-wijgrid-content-area");H[0].innerHTML="";G[0].innerHTML="";J[0].innerHTML="";I[0].innerHTML="";a(this._viewTables.nw).appendTo(H);a(this._viewTables.ne).appendTo(G);a(this._viewTables.sw).appendTo(J);a(this._viewTables.se).appendTo(I)},_setColumnWidth:function(d,c,b){var f=this.getHeaderCell(d),e=f.clientWidth;if(c){if(!b){a(f).children("div.wijmo-wijgrid-innercell").setOutWidth(c);this.fooRowCells.eq(d).setOutWidth(c)}this.forEachColumnCell(d,function(e){var d=a(e.parentNode);if(d.parent().is("tbody")&&!d.is(".wijmo-wijgrid-emptydatarow",".wijmo-wijgrid-groupheaderrow",".wijmo-wijgrid-groupfooterrow"))if(b){b.push(c);return false}else a(e).children("div.wijmo-wijgrid-innercell").setOutWidth(c);return true})}else{this.forEachColumnCell(d,function(d){var c=a(d.parentNode);if(c.parent().is("tbody")&&!c.is(".wijmo-wijgrid-groupheaderrow",".wijmo-wijgrid-groupfooterrow"))if(!b)a(d).children("div.wijmo-wijgrid-innercell").setOutWidth(e);else return false;return true});if(b)b.push(e);else a(f).children("div.wijmo-wijgrid-innercell").setOutWidth(e)}},adjustCellsSizes:function(){for(var m=new a.wijmo.wijgrid.rowAccessor(this,9,0),o=m.length(),n=[],c,h,d,k,f,i,e,l,g,j,p,b=0;b<o;b++){h=this.getJoinedRows(b,9);d=h[0];k=d!==null?d.cells.length:0;f=false;for(c=0;c<k&&!f;c++)f=d.cells[c].rowSpan>1;e=h[1];l=e!==null?e.cells.length:0;g=false;if(!f)for(c=0;c<l&&!g;c++)g=e.cells[c].rowSpan>1;i=d!==null&&k>0?d.offsetHeight:0;j=e!==null&&l>0?e.offsetHeight:0;n[b]=f||g?Math.min(i,j):Math.max(i,j)}for(b=0;b<o;b++){p=this.getJoinedRows(b,9);m.iterateCells(p,this.setCellContentDivHeight,n[b])}},_onScrolled:function(){this._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-ne")[0].scrollLeft=parseInt((this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-templateouterwrapper").css("left")+"").replace("px",""),10)*-1;this._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-sw")[0].scrollTop=parseInt((this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-templateouterwrapper").css("top")+"").replace("px",""),10)*-1},setCellContentDivHeight:function(b,a){b.style.height=a+"px";return true},_testNeedVBar:function(g,h,j,d,i){var a,f,c,e,b;f=j.width();c=h.height()+this._wijgrid.options.splitDistanceY;e=g.width();b=g.height();if(d==="both"||d==="vertical")a=true;else a=d==="auto"&&(c>b||!i&&f>e&&c>b-this._verScrollBarSize);return a},_updateSplitAreaBounds:function(){var a=this._wijgrid,b=a.options,h=b.width||a.outerDiv.width(),c=b.height||a.outerDiv.height(),f=a.outerDiv.find(".wijmo-wijgrid-split-area-nw"),e=a.outerDiv.find(".wijmo-wijgrid-split-area-ne"),d=a.outerDiv.find(".wijmo-wijgrid-split-area-sw"),g=a.outerDiv.find(".wijmo-wijgrid-split-area-se");if(c<=0)c=a.outerDiv.find(".wijmo-wijgrid-split-area-se > table")[0].offsetHeight;if(!a._autoHeight)this._scroller.height(c);else this._scroller.height(c+b.splitDistanceY);this._scroller.width(h);f.height(b.splitDistanceY);e.height(b.splitDistanceY);a.$superPanelHeader!==null&&e.css("top",a.$superPanelHeader.outerHeight(true)+"px");if(!a._autoHeight)d.height(c-b.splitDistanceY);else d.height(c);d.css("top",b.splitDistanceY);f.width(b.splitDistanceX);d.width(b.splitDistanceX);g.css("marginLeft",b.splitDistanceX);g.css("marginTop",b.splitDistanceY);e.css("marginLeft",b.splitDistanceX)}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.selection=function(b){var g=0,k,e=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),c=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),d=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),f=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),i=null,j=null;this.selectedCells=function(){return d};this.addRange=function(c,f,e,g){if(!c&&arguments.length===1)throw"invalid argument";var d=arguments.length===4?new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(c,f),new a.wijmo.wijgrid.cellInfo(e,g)):c._clone();d._normalize();if(!d._isValid())throw"invalid argument";this.beginUpdate();this._startNewTransaction(b._field("currentCell"));this._selectRange(d,false,true,0,null);this.endUpdate()};this.clear=function(){this.beginUpdate();c._clear();c._addFrom(d);this.endUpdate()};this.selectAll=function(){this.beginUpdate();this._selectRange(b._getDataCellsRange(),false,false,0,null);this.endUpdate()};this.beginUpdate=function(){g++};this.endUpdate=function(){if(g>0){g--;if(g===0){l();if(e.length()||c.length()){i!==null&&i.UnderlyingDataChanged();j!==null&&j.UnderlyingDataChanged();b._trigger("selectionChanged",null,{addedCells:e,removedCells:c})}e=new a.wijmo.wijgrid.cellInfoOrderedCollection(b);c._clear()}}};this._multipleRangesAllowed=function(){var a=b.options.selectionMode;return a&&((a=a.toLowerCase())==="multicolumn"||a==="multirow"||a==="multirange")};this._anchorCell=function(){return k};this._startNewTransaction=function(c){if(c){k=c._clone();f=new a.wijmo.wijgrid.cellInfoOrderedCollection(b)}};this._clearRange=function(l,p){var j=b.options.selectionMode.toLowerCase(),a,n,m,e,g,f,i,o,k;if(l._isValid()&&j!=="none"&&d.length()>0){a=l._clone();a._normalize();a._clip(b._getDataCellsRange());if(!l._isValid())return;a=h(a,j,p,null);this.beginUpdate();switch(j){case"singlecell":a._containsCellInfo(d.item(0))&&this.clear();break;case"singlecolumn":case"singlerow":case"singlerange":n=a.bottomRight().rowIndex();m=a.bottomRight().cellIndex();e=false;for(g=a.topLeft().rowIndex();!e&&g<=n;g++)for(f=a.topLeft().cellIndex();!e&&f<=m;f++){e=d.indexOf(f,g)>=0;e&&this.clear()}break;case"multicolumn":case"multirow":case"multirange":for(i=0,o=d.length();i<o;i++){k=d.item(i);a._containsCellInfo(k)&&c._add(k)}}this.endUpdate()}};this._selectRange=function(g,k,e,i,j){var d=b.options.selectionMode.toLowerCase(),a;if(d!=="none"&&g._isValid()){a=g._clone();a._normalize();a._clip(b._getDataCellsRange());if(!a._isValid())return;this.beginUpdate();if(!this._multipleRangesAllowed())this.clear();else if(k||e){if(e){c._clear();c._addFrom(f)}}else this.clear();a=h(a,d,i,j);m(a,true);this.endUpdate()}};function h(c,g,f,d){var e=b._getDataCellsRange();switch(g){case"singlecell":c=d===null?new a.wijmo.wijgrid.cellInfoRange(c.topLeft(),c.topLeft()):new a.wijmo.wijgrid.cellInfoRange(d,d);break;case"singlecolumn":c=d===null?new a.wijmo.wijgrid.cellInfoRange(c.topLeft(),c.topLeft()):new a.wijmo.wijgrid.cellInfoRange(d,d);c._extend(1,e);break;case"singlerow":c=d===null?new a.wijmo.wijgrid.cellInfoRange(c.topLeft(),c.topLeft()):new a.wijmo.wijgrid.cellInfoRange(d,d);c._extend(2,e);break;case"singlerange":c._extend(f,e);break;case"multicolumn":c._extend(1,e);break;case"multirow":c._extend(2,e);break;case"multirange":c._extend(f,e)}return c}function l(){var r=b._getDataToAbsOffset(),p=r.x,q=r.y,s=b._view(),h,k,g,j,i,o,t=a.wijmo.wijgrid.renderState,m,n,l=-1;for(h=0,k=c.length();h<k;h++){g=c.item(h);if(e.indexOf(g)<0){j=s.getCell(g.cellIndex()+p,g.rowIndex()+q);if(j){if(l!==g.rowIndex()){m=b._createRowInfo(g._row());l=g.rowIndex()}i=a(j);n=b._changeRenderState(i,t.selected,false);b.cellStyleFormatter.format(i,g.cellIndex(),g.column(),m,n)}d._remove(g);f._remove(g)}else{c._removeAt(h);h--;k--}}l=-1;for(h=0,k=e.length();h<k;h++){g=e.item(h);o=d.indexOf(g);if(o<0){j=s.getCell(g.cellIndex()+p,g.rowIndex()+q);if(j){if(l!==g.rowIndex()){m=b._createRowInfo(g._row());l=g.rowIndex()}i=a(j);n=b._changeRenderState(i,t.selected,true);b.cellStyleFormatter.format(i,g.cellIndex(),g.column(),m,n)}d._insertUnsafe(g,~o);f._add(g)}else{e._removeAt(h);h--;k--}}}function m(h,n){var j=h.topLeft().cellIndex(),l=h.topLeft().rowIndex(),k=h.bottomRight().cellIndex(),m=h.bottomRight().rowIndex(),i,d,f,g;if(n){i=e.length();for(d=l;d<=m;d++)if(b.dataTable[d].rowType&a.wijmo.wijgrid.rowType.data)for(f=j;f<=k;f++){g=new a.wijmo.wijgrid.cellInfo(f,d);if(i===0)e._appendUnsafe(g);else e._add(g)}}else{i=c.length();for(d=l;d<=m;d++)for(f=j;f<=k;f++){g=new a.wijmo.wijgrid.cellInfo(f,d);if(i===0)c._appendUnsafe(g);else c._add(g)}}}};a.wijmo.wijgrid.cellInfoOrderedCollection=function(c){if(!c)throw"argument is null";var b=[];this.item=function(a){return b[a]};this.length=function(){return b.length};this.indexOf=function(e,h){if(arguments.length===1){h=e.rowIndex();e=e.cellIndex()}var d=0,g=b.length-1,c,f,a;while(d<=g){c=d+(g-d>>1);f=b[c];a=f.rowIndex()-h;if(a===0)a=f.cellIndex()-e;if(a<0)d=c+1;else if(a>0)g=c-1;else return c}return~d};this.toString=function(){var d="",a,c;for(a=0,c=b.length;a<c;a++)d+=b[a].toString()+"\n";return d};this._add=function(a){var d=this.indexOf(a);if(d<0){b.splice(~d,0,a);a._setGridView(c);return true}return false};this._addFrom=function(d){if(d){var e=d.length(),f=b.length,a;if(f===0){b.length=e;for(a=0;a<e;a++){b[a]=d.item(a);b[a]._setGridView(c)}}else for(a=0;a<e;a++)this._add(d.item(a))}};this._appendUnsafe=function(a){b[b.length]=a;a._setGridView(c)};this._insertUnsafe=function(c,a){b.splice(a,0,c)};this._clear=function(){b.length=0};this._remove=function(c){var a=this.indexOf(c);if(a>=0){b.splice(a,1);return true}return false};this._removeAt=function(a){b.splice(a,1)};this._getColumnsIndicies=function(){var e=[],d=b.length,c,a,f;if(d){c=[];for(a=0;a<d;a++)c[b[a].cellIndex()]=1;d=c.length;f=0;for(a=0;a<d;a++)if(c[a])e[f++]=a}return e};this._getSelectedRowsIndicies=function(){var f=[],d=b.length,c,a,e;if(d){c=[];for(a=0;a<d;a++)c[b[a].rowIndex()]=1;d=c.length;e=0;for(a=0;a<d;a++)if(c[a])f[e++]=a}return f};this._rectangulate=function(){var i=b.length,e=4294967295,g=4294967295,f=0,h=0,d,c;if(i){for(d=0;d<i;d++){c=b[d];e=Math.min(e,c.cellIndex());g=Math.min(g,c.rowIndex());f=Math.max(f,c.cellIndex());h=Math.max(h,c.rowIndex())}return new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(e,g),new a.wijmo.wijgrid.cellInfo(f,h))}return null}}})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{selectionui:function(b){var q=10,u="{0}."+b.widgetName+".selectionui",c=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),k,f,h,e,i=false,j=false,d=b._view(),t=b._field("visibleLeaves").length,r=d.focusableElement();r.bind(g("mousedown"),p);this.dispose=function(){r.unbind(g("mousedown"),p);l()};function p(e){if(!b._canInteract()||b.options.selectionMode.toLowerCase()==="none")return;var c=d.getVisibleAreaBounds(),g={x:e.pageX,y:e.pageY},i=e.target&&e.target.tagName!==undefined?e.target.tagName.toLowerCase():undefined,h=a(e.target);if((!i||h.is("td.wijgridtd, th.wijgridtd, div.wijmo-wijgrid-innercell"))&&g.x>c.left&&g.x<c.left+c.width&&g.y>c.top&&g.y<c.top+c.height){s();k=g;f=m(k)}}function n(B){if(!f||!f._isValid())return;var x={x:B.pageX,y:B.pageY},y,j,s,r,A,z,u,l,n,t,g,p,v,o,w,C=a.wijmo.wijgrid.renderState;if(!i)i=Math.abs(k.x-x.x)>q||Math.abs(k.y-x.y)>q;if(i){y=m(x);if(!y._isValid())return;h=y;j=new a.wijmo.wijgrid.cellInfoRange(f,h);j._normalize();j._clip(b._getDataCellsRange());if(j._isValid()&&!j.isEqual(e)){s=b._getDataToAbsOffset();e=j;r=new a.wijmo.wijgrid.cellInfoOrderedCollection(b);A=j.bottomRight().rowIndex();z=j.bottomRight().cellIndex();for(u=j.topLeft().rowIndex();u<=A;u++)if(b.dataTable[u].rowType&a.wijmo.wijgrid.rowType.data)for(l=j.topLeft().cellIndex();l<=z;l++)r._appendUnsafe(new a.wijmo.wijgrid.cellInfo(l,u));o=-1;for(n=0,t=c.length();n<t;n++){g=c.item(n);if(r.indexOf(g)<0){if(b.selection().selectedCells().indexOf(g)<0){l=d.getCell(g.cellIndex()+s.x,g.rowIndex()+s.y);if(l){if(o!==g.rowIndex()){v=b._createRowInfo(g._row());o=g.rowIndex()}p=a(l);w=b._changeRenderState(p,C.selected,false);b.cellStyleFormatter.format(p,g.cellIndex(),g.column(),v,w)}}c._removeAt(n);n--;t--}}o=-1;for(n=0,t=r.length();n<t;n++){g=r.item(n);if(c.indexOf(g)<0&&b.selection().selectedCells().indexOf(g)<0)if(c._add(g)){l=d.getCell(g.cellIndex()+s.x,g.rowIndex()+s.y);if(l){if(o!==g.rowIndex()){v=b._createRowInfo(g._row());o=g.rowIndex()}p=a(l);w=b._changeRenderState(p,C.selected,true);b.cellStyleFormatter.format(p,g.cellIndex(),g.column(),v,w)}}}}}}function o(k){l();if(i){i=false;if(e&&e._isValid()){b._changeCurrentCell(h);(!k.shiftKey||!b.selection()._multipleRangesAllowed()&&b.options.selectionMode.toLowerCase()!=="singleRange")&&b.selection()._startNewTransaction(f);b.selection().beginUpdate();b.selection()._selectRange(e,k.shiftKey,k.ctrlKey,0,h);b.selection().endUpdate();var s=b._view(),o=b._getDataToAbsOffset(),g,r,d,m,j,n=-1,p,q,t=a.wijmo.wijgrid.renderState;for(g=0,r=c.length();g<r;g++){d=c.item(g);if(b.selection().selectedCells().indexOf(d)<0){m=s.getCell(d.cellIndex()+o.x,d.rowIndex()+o.y);if(m!==null){if(n!==d.rowIndex()){p=b._createRowInfo(d._row());n=d.rowIndex()}j=a(m);q=b._changeRenderState(j,t.selected,false);b.cellStyleFormatter.format(j,d.cellIndex(),d.column(),p,q)}}}c._clear();f=h=e=null;return false}}}function s(){if(!j)try{a(document).bind(g("mousemove"),n).bind(g("mouseup"),o)}finally{j=true}}function l(){if(j)try{a(document).unbind(g("mousemove"),n).unbind(g("mouseup"),o)}finally{j=false}}function g(b){return a.wijmo.wijgrid.stringFormat(u,b)}function m(k){var f=0,g=t-1,c=0,m=-1,e,h=new a.wijmo.wijgrid.rowAccessor(d,2,0,0),i,j,l,n;while(f<=g){c=(g-f>>1)+f;e=a.wijmo.wijgrid.bounds(d.getHeaderCell(c));if(!e){j=h.item(0);e=a.wijmo.wijgrid.bounds(h.getCell(j,c))}if(!e)break;if(k.x<e.left)g=c-1;else if(k.x>e.left+e.width)f=c+1;else{m=c;break}}if(m===-1)return a.wijmo.wijgrid.cellInfo.prototype.outsideValue;h=new a.wijmo.wijgrid.rowAccessor(d,0,0,0);i=-1;f=0;g=h.length()-1;c=0;while(f<=g){c=(g-f>>1)+f;j=h.item(c);e=a.wijmo.wijgrid.bounds(h.getCell(j,0));if(k.y<e.top)g=c-1;else if(k.y>e.top+e.height)f=c+1;else{i=c;break}}if(i===-1)return a.wijmo.wijgrid.cellInfo.prototype.outsideValue;l=b._getDataToAbsOffset();n=new a.wijmo.wijgrid.cellInfo(m-l.x,i-l.y);n._clip(b._getDataCellsRange());return n}}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.rowAccessor=function(d,c,a,b){if(!a)a=0;if(!b)b=0;this.item=function(b){var e=this.length();return b<e?d.getJoinedRows(b+a,c):null};this.length=function(){var g=d.getJoinedTables(true,0),e=0,f;if(f=g[0])e=f.getSectionLength(c);if(f=g[1])e+=f.getSectionLength(c);e-=a+b;if(e<0)e=0;return e};this.iterateCells=function(d,e,j){if(d&&e){var i=0,b,h,a,c,f,g;for(b=0,h=d.length;b<h;b++){a=d[b];if(a)for(c=0,f=a.cells.length;c<f;c++){g=e(a.cells[c],i++,j);if(g!==true)return}}}};this.getCell=function(d,b){var a,c;if(d&&(a=d[0])){c=a.cells.length;if(b<c)return a.cells[b];b-=c;if(a=d[1]){c=a.cells.length;if(b<c)return a.cells[b]}}return null};this.cellsCount=function(b){var c=0,a;if(b&&(a=b[0])){c=a.cells.Length;if(a=b[1])c+=a.cells.Length}return c}}})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{cellEditorHelper:function(){this.currentCellEditStart=function(e,j){var g=false,b=e.currentCell(),d,h,f,i;if(b._isValid()&&!b._isEdit()&&b.column().dataIndex>=0){d=b._row();if(d&&d.length){i=a.wijmo.wijgrid.dataPrefix(d[0],e._data$prefix,"rowType");if(i&a.wijmo.wijgrid.rowType.data){h={cell:b,event:j,handled:false};if(g=e._trigger("beforeCellEdit",null,h))if(!h.handled)g=c(e,h);if(g){b._isEdit(true);if(e.options.showRowHeader){f=a(d[0].cells[0]).children("div.wijmo-wijgrid-innercell");if(f.length){f.empty();f.append(a("<div>&nbsp;</div>").addClass("ui-icon ui-icon-pencil"))}}}}}}return g};this.currentCellEditEnd=function(f,j){var b=f.currentCell(),g=false,h,l,k,c,i,m,n;if(!b._isValid()||!b._isEdit())return;h=b._row();if(h&&h.length){l=a.wijmo.wijgrid.dataPrefix(h[0],f._data$prefix,"rowType");if(!(l&a.wijmo.wijgrid.rowType.data))return g;k=j&&j.which===a.ui.keyCode.ESCAPE;if(!j||!k){c={cell:b,value:undefined};if(g=f._trigger("beforeCellUpdate",null,c)){if(c.value===undefined)c.value=e(f,b);i=false;if(c.cell.column().dataType==="datetime"){m=c.value?c.value.getTime():null;n=b.value()?b.value().getTime():null;i=m!==n}else i=c.value!==b.value();if(i){try{b.value(c.value)}catch(o){g=false;f._trigger("invalidCellValue",null,{cell:b,value:c.value})}g&&f._trigger("afterCellUpdate",null,{cell:b})}}}else g=true;if(g){c={cell:b,event:j,handled:false};f._trigger("afterCellEdit",null,c);if(!c.handled)g=d(f,c);g&&b._isEdit(false);f.options.showRowHeader&&a(h[0].cells[0]).children("div.wijmo-wijgrid-innercell").html("&nbsp;");f.element.focus();a(f._view().focusableElement()).focus();b.tableCell().focus()}}return g};function c(k,d){var j=d.cell.column(),h=false,f,g,c,i,e;if(j.dataIndex>=0){f=d.cell.value();h=true;try{g=d.cell.container();if(j.dataType==="boolean"){c=g.children("input");c.focus();if(d.event&&d.event.type==="keypress")c.one("keyup",function(b){if(b.which===a.ui.keyCode.SPACE){b.preventDefault();c[0].checked=!f}})}else{c=a("<input />").attr("type","text").addClass("wijgridinput wijmo-wijinput ui-state-focus").bind("keydown",k,b);c.bind(a.support.selectstart?"selectstart":"mousedown",function(a){a.stopPropagation()});if(d.event&&d.event.type==="keypress"&&d.event.which)c.val(String.fromCharCode(d.event.which));else switch(d.cell.column().dataType){case"currency":case"number":if(f!==null){c.val(f);break}default:c.val(k._toStr(d.cell.column(),f))}g.empty().append(c);i=c.val().length;new a.wijmo.wijgrid.domSelection(c[0]).setSelection({start:i,end:i});c.focus();a.browser.msie&&setTimeout(function(){c.focus()},0);if(a.browser.mozilla&&document.createEvent&&c[0].dispatchEvent){e=document.createEvent("KeyboardEvent");e.initKeyEvent("keypress",false,true,null,false,false,false,false,0,a.ui.keyCode.SPACE);c[0].dispatchEvent(e);e=document.createEvent("KeyboardEvent");e.initKeyEvent("keypress",false,true,null,false,false,false,false,a.ui.keyCode.BACKSPACE,0);c[0].dispatchEvent(e)}}}catch(l){alert(l.message);h=false}}return h}function d(c,b){var a=b.cell.column(),g=false,d,e,f,i,h;if(a.dataIndex>=0){g=true;try{d=b.cell.container();e=c._toStr(a,b.cell.value());f=c.dataTable[b.cell.rowIndex()];i=c.data()[f.originalRowIndex];if(a.dataType==="boolean"){h=d.children("input");if(e==="true")h.attr("checked","checked");else h.removeAttr("checked")}else c.cellFormatter.format(d,a,e,f.rowType,i)}catch(j){alert("defaultAfterCellEdit: "+j.message);g=false}}return g}function b(b){if(b.which===a.ui.keyCode.ENTER){var c=b.data;if(c){c._endEditInternal(b);return false}}}function e(d,c){var a=c.container().find(":input:first"),b=null;if(a.length){b=a.attr("type")==="checkbox"?a[0].checked:a.val();b=d._parse(c.column(),b)}return b}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{resizer:function(h){var i=[],t=10,s=1,v="{0}."+h.widgetName+".resizer",e=false,b=null,r,g=null,d=null,f=null;this.addElement=function(a){if(a&&a.element){a.element.bind(c("mousemove"),q).bind(c("mousedown"),p).bind(c("mouseout"),j);i.push(a)}};this.dispose=function(){a.each(i,function(b,a){a.element.unbind(c("mousemove"),q).unbind(c("mousedown"),p).unbind(c("mouseout"),j)});m()};this.inProgress=function(){return e};function q(c){if(!e){var a=o({x:c.pageX,y:c.pageY});if(a&&a._canSize()&&h._canInteract()){a.element.css("cursor","e-resize");b=a}else j(c)}}function j(){if(!e)if(b){b.element.css("cursor","");b=null}}function p(c){b=o({x:c.pageX,y:c.pageY});if(b&&b._canSize()&&h._canInteract())try{b.element.css("cursor","");r=document.body.style.cursor;document.body.style.cursor="e-resize";g=d=a.wijmo.wijgrid.bounds(b.element);f=a('<div class="wijmo-wijgrid-resizehandle ui-state-highlight">&nbsp;</div>');f.css({left:c.pageX,top:g.top,height:h._view().getVisibleAreaBounds().height});a(document.body).append(f)}finally{u();e=true}}function k(a){var b=s*Math.round((a.pageX-d.left)/s);d={left:d.left+b,top:a.pageY};f.css("left",d.left)}function l(){try{document.body.style.cursor=r;f.remove();g!==d&&h._fieldResized(b,g.width,d.left-g.left)}finally{b=null;f=null;m();e=false}}function n(a){a.preventDefault()}function u(){if(!e){a(document).bind(c("mousemove"),k).bind(c("mouseup"),l);a(document.body).disableSelection();a.browser.msie&&a(document.body).bind("selectstart",n)}}function m(){if(e){a(document).unbind(c("mousemove"),k).unbind(c("mouseup"),l);a(document.body).enableSelection();a.browser.msie&&a(document.body).unbind("selectstart",n)}}function o(e){var c,f,d,b,g;for(c=0,f=i.length;c<f;c++){d=i[c];b=a.wijmo.wijgrid.bounds(d.element);g=a.ui.isOver(e.y,e.x,b.top,b.left+b.width-t,b.height,t);if(g)return d}return null}function c(b){return a.wijmo.wijgrid.stringFormat(v,b)}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{cellFormatterHelper:function(){this.format=function(j,b,g,i){if(i.type&a.wijmo.wijgrid.rowType.footer)if(b.aggregate&&b.aggregate!=="none")g=a.wijmo.wijgrid.stringFormat(b.footerText||"{0}",b._totalsValue||"");else g=b.footerText||b._footerTextDOM||"";var h=true,f=null,e={$container:j,column:b,formattedValue:g,row:i,afterDefaultCallback:null};if(a.isFunction(b.cellFormatter))h=!b.cellFormatter(e);if(h){switch(b.dataType){case"boolean":f=c;break;default:f=d}if(f){f(e);a.isFunction(e.afterDefaultCallback)&&e.afterDefaultCallback(e)}}};function d(c){switch(c.row.type){case a.wijmo.wijgrid.rowType.filter:b(c);break;default:c.$container.html(c.formattedValue?c.formattedValue:"&nbsp;")}}function c(c){var d,g,i="disabled='disabled'",f,h,e=a.wijmo.wijgrid.rowType;switch(c.row.type){case e.data:case e.data|e.dataAlt:d=c.column.owner;g=d.options.allowEditing&&c.column.readOnly!==true;if(g)i="";if(d._parse(c.column,c.row.data[c.column.dataKey])===true)c.$container.html("<input class='wijgridinput' type='checkbox' checked='checked' "+i+" />");else c.$container.html("<input class='wijgridinput' type='checkbox' "+i+" />");g&&c.$container.children("input").bind("mousedown",function(){f=c.$container.parent()[0];h=d.currentCell();h.tableCell()!==f&&d._onClick({target:f});!h._isEdit()&&d.beginEdit()}).bind("keydown",function(b){if(b.which===a.ui.keyCode.ENTER){d._endEditInternal(b);return false}});break;case e.filter:b(c)}}function b(a){if(a.column.dataIndex>=0&&!a.column.isBand&&a.column.showFilter)a.$container.html('<div class="wijmo-wijgrid-filter ui-widget ui-state-default ui-corner-all"><span class="wijmo-wijgrid-filtericon"></span><input type="text" class="wijmo-wijgrid-filter-input" style="width:1px" /><a class="wijmo-wijgrid-filter-trigger ui-corner-right ui-state-default" href="#"><span class="ui-icon ui-icon-triangle-1-s"></span></a></div>');else a.$container.html("&nbsp;")}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{dragAndDropHelper:function(c){var i="scope_"+ +new Date,d=null,e=null,b=null,g=false,h,p='<div class="ui-widget wijmo-wijgrid ui-widget-content ui-corner-all"><table class="wijmo-wijgrid-root wijmo-wijgrid-table"><tr class="wijmo-wijgrid-headerrow"></tr></table></div>';this.attachGroupArea=function(e){var d;e.droppable({scope:i,tolerance:"pointer",greedy:true,accept:function(b){if(c.options.allowColMoving){d=f(b);if(d)return d instanceof a.wijmo.c1groupedfield&&d.options.groupedIndex===c._field("groupedColumns").length-1?false:!d.options.isBand&&(d.options.groupedIndex===undefined||d instanceof a.wijmo.c1groupedfield)}return false},drop:function(b,a){if(!l(b,a.draggable)&&(d=f(a.draggable)))g=true},over:function(){var a=c._field("groupedWidgets").length;h=a>0;b=a>0?c._field("groupedWidgets")[a-1]:e;e.data("thisDroppableWijField",b)},out:function(){if(b===e.data("thisDroppableWijField"))b=null}})};this.attach=function(d){var e,j;if(!d||!(e=d.element))return;e.draggable({helper:function(){return d instanceof a.wijmo.c1groupedfield?e.clone().addClass("wijmo-wijgrid-dnd-helper"):e.clone().wrap(p).width(e.width()).height(e.height()).closest(".wijmo-wijgrid").addClass("wijmo-wijgrid-dnd-helper")},appendTo:"body",scope:i,drag:function(c,f){m();if(b&&!l(c,e)){var a=b.element;if(!a)a=b;o(a,k(d,b,c,f))}},start:function(){if(c._canInteract()&&c.options.allowColMoving&&!c._field("resizer").inProgress()){var b=d.options,g=d.options.travIdx,e=d instanceof a.wijmo.c1groupedfield,f=e?"groupArea":"columns";if(e){b=a.wijmo.wijgrid.search(c.columns(),function(a){return a.options.travIdx===g});b=!b.found?a.wijmo.wijgrid.getColumnByTravIdx(c.options.columns,g).found:b.found.options}if(d._canDrag()&&c._trigger("columnDragging",null,{drag:b,dragSource:f})){c._trigger("columnDragged",null,{drag:b,dragSource:f});return true}}return false},stop:function(f,e){m();try{if(g)if(!b.element)c._handleDragnDrop(d.options.travIdx,-1,"left",d instanceof a.wijmo.c1groupedfield,true);else c._handleDragnDrop(d.options.travIdx,b.options.travIdx,k(d,b,f,e),d instanceof a.wijmo.c1groupedfield,b instanceof a.wijmo.c1groupedfield)}finally{b=null;g=false}}}).droppable({hoverClass:"ui-state-hover",scope:i,tolerance:"pointer",greedy:true,accept:function(a){if(c.options.allowColMoving)if(e[0]!==a[0]){j=f(a);if(j)return j._canDropTo(d)}return false},drop:function(b,a){if(j=f(a.draggable))g=true},over:function(){h=false;b=d;e.data("thisDroppableWijField",b)},out:function(){if(b===d.element.data("thisDroppableWijField"))b=null}})};this.detach=function(b){var a;if(b&&(a=b.element)){a.data("draggable")&&a.draggable("destroy");a.data("droppable")&&a.droppable("destroy")}};this.dispose=function(){if(e){e.remove();e=null}if(d){d.remove();d=null}};function f(b){var c=b.data(a.wijmo.c1basefield.prototype._data$prefix+"widgetName");return!c?b.data(a.wijmo.c1groupedfield.prototype._data$prefix):b.data(c)}function o(a,b){n().show().position({my:"center",at:b+" top",of:a});j().show().position({my:"center",at:b+" bottom",of:a})}function m(){n().hide();j().hide()}function n(){if(!e)e=a("<div />").addClass("wijmo-wijgrid-dnd-arrow-top").append(a("<span />").addClass("ui-icon ui-icon-arrowthick-1-s")).hide().appendTo(document.body);return e}function j(){if(!d)d=a("<div />").addClass("wijmo-wijgrid-dnd-arrow-bottom").append(a("<span />").addClass("ui-icon ui-icon-arrowthick-1-n")).hide().appendTo(document.body);return d}function l(c,d){var b=a.wijmo.wijgrid.bounds(d,false);return c.pageX>b.left&&c.pageX<b.left+b.width&&c.pageY>b.top&&c.pageY<b.top+b.height}function k(e,b,i){if(!b.element)return"left";if(h)return"right";var f=a.wijmo.wijgrid.bounds(b.element,false),j=f.width/6,g=f.left+f.width/2,d="right",c;if(i.pageX<g)d="left";if(b instanceof a.wijmo.c1groupedfield){if(e instanceof a.wijmo.c1groupedfield){c=b.options.groupedIndex-e.options.groupedIndex;if(Math.abs(c)===1)d=c<0?"left":"right"}return d}c=b.options.linearIdx-e.options.linearIdx;if(b.options.isBand&&e.options.parentIdx!==b.options.travIdx&&Math.abs(i.pageX-g)<j)return"center";if(e.options.parentIdx===b.options.parentIdx&&Math.abs(c)===1)d=c<0?"left":"right";return d}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{cellStyleFormatterHelper:function(b){if(!b)throw"invalid arguments";this.format=function(q,l,i,m,j,h,p){var k=a.wijmo.wijgrid.renderState,o=a.wijmo.wijgrid.rowType,n=m.type,f,g=null;if(l===0&&b.options.showRowHeader)i=null;if(n===o.groupHeader||n===o.groupFooter){i=null;if(h&&(g=h.groupInfo)){i=b._field("leaves")[g.leafIndex];delete h.groupInfo}}f={$cell:q,state:j,row:m,column:i,_cellIndex:l,_purpose:g?g.purpose:undefined};if(j===k.rendering)c(f,h,p);else{e(f,j&k.current);d(f,j&k.selected)}a.isFunction(b.options.cellStyleFormatter)&&b.options.cellStyleFormatter(f)};function c(c,i,h){var e=a.wijmo.wijgrid.rowType,d,j,g=c.column,f=c.row.type;if(f!==e.header&&f!==e.filter)c.$cell.addClass("wijgridtd");else f===e.header&&c.$cell.addClass("wijgridth");if(i)for(d in i)if(i.hasOwnProperty(d)){j=i[d];if((d==="colSpan"||d==="rowSpan")&&!(j>1))continue;if(d==="class")c.$cell.addClass(j);else c.$cell.attr(d,j)}if(h)for(d in h)if(h.hasOwnProperty(d)){if(d==="paddingLeft"){c.$cell.children(".wijmo-wijgrid-innercell").css(d,h[d]);continue}c.$cell.css(d,h[d])}if(c._cellIndex===0&&b.options.showRowHeader)c.$cell.attr({role:"rowheader",scope:"row"}).addClass(f===e.header?"ui-state-default":"").addClass("wijmo-wijgrid-rowheader");else switch(f){case e.header:c.$cell.attr({role:"columnheader",scope:"col"});break;case e.footer:c.$cell.attr({role:"columnfooter",scope:"col"});break;default:c.$cell.attr("role","gridcell")}if(f&e.data)if(c._cellIndex>=0&&g&&g.dataParser){c.$cell.attr("headers",escape(g.headerText));g.readOnly&&c.$cell.attr("aria-readonly",true);g.dataIndex>=0&&c.$cell.addClass("wijdata-type-"+(g.dataType||"string"))}if(f===e.groupHeader||f===e.groupFooter)g&&c._purpose===a.wijmo.wijgrid.groupRowCellPurpose.aggregateCell&&c.$cell.addClass("wijdata-type-"+(g.dataType||"string"))}function e(b,d){var c=a.wijmo.wijgrid.rowType;if(d){b.$cell.addClass("ui-state-active");if(b.row.type===c.header)b.$cell.addClass("wijmo-wijgrid-current-headercell");else b.$cell.addClass("wijmo-wijgrid-current-cell")}else{b.$cell.removeClass("ui-state-active");if(b.row.type===c.header)b.$cell.removeClass("wijmo-wijgrid-current-headercell");else b.$cell.removeClass("wijmo-wijgrid-current-cell")}}function d(a,b){if(b)a.$cell.addClass("ui-state-highlight").attr("aria-selected","true");else a.$cell.removeClass("ui-state-highlight").removeAttr("aria-selected")}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{rowStyleFormatterHelper:function(b){if(!b)throw"invalid arguments";this.format=function(j,l,k){var i=a.wijmo.wijgrid.renderState,h=j.state,g=j;if(h===i.rendering)c(g,l,k);else{e(g,h&i.current);f(g,h&i.hovered);d(g,h&i.selected)}a.isFunction(b.options.rowStyleFormatter)&&b.options.rowStyleFormatter(g)};function c(e,f,h){var c="wijmo-wijgrid-row ui-widget-content",g="wijmo-wijgrid-row ui-widget-content",d=a.wijmo.wijgrid.rowType,b;e.$rows.attr("role","row");if(f)for(b in f)if(f.hasOwnProperty(b))if(b==="class")e.$rows.addClass(f[b]);else e.$rows.attr(b,f[b]);if(h)for(b in h)h.hasOwnProperty(b)&&e.$rows.css(b,h[b]);switch(e.type&~d.dataAlt){case d.header:c="wijmo-wijgrid-headerrow";break;case d.data:c=g+" wijmo-wijgrid-datarow";if(e.type&d.dataAlt)c+=" wijmo-wijgrid-alternatingrow";break;case d.emptyDataRow:c=g+" wijmo-wijgrid-emptydatarow";break;case d.filter:c="wijmo-wijgrid-filterrow";break;case d.groupHeader:c=g+" wijmo-wijgrid-groupheaderrow";break;case d.groupFooter:c=g+" wijmo-wijgrid-groupfooterrow";break;case d.footer:c="wijmo-wijgrid-footerrow ui-state-highlight";break;default:throw a.wijmo.wijgrid.stringFormat("unknown rowType: {0}",e.row.type);}e.$rows.addClass(c)}function e(c,d){if(b.options.showRowHeader)if(d)a(c.$rows[0].cells[0]).addClass("ui-state-active wijmo-wijgrid-current-rowheadercell");else a(c.$rows[0].cells[0]).removeClass("ui-state-active wijmo-wijgrid-current-rowheadercell")}function f(a,b){if(b)a.$rows.addClass("ui-state-hover");else a.$rows.removeClass("ui-state-hover")}function d(b,a){a}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{tally:function(){var h=0,i=0,a=0,b=0,f=0,g=0,d,c;this.add=function(e){if(e===null||e==="")return;b++;if(typeof e==="string"){if(d===undefined||e<d)d=e;if(c===undefined||e>c)c=e}if(typeof e==="number"){if(a===0){g=e;f=e}a++;h+=e;i+=e*e;if(e<g)g=e;if(e>f)f=e}};this.getValueString=function(f){if(a){var h=e(f.aggregate),g=f.owner;return g._toStr(f,h)}if(b)switch(f.aggregate){case"max":return c;case"min":return d;case"count":return b.toString()}return""};function e(d){switch(d){case"average":return a===0?0:h/a;case"count":return b;case"max":return f;case"min":return g;case"sum":return h;case"std":return a<=1?0:Math.sqrt(e("var"));case"stdPop":return a<=1?0:Math.sqrt(e("varPop"));case"var":return a<=1?0:e("varPop")*a/(a-1);case"vapPop":if(a<=1)return 0;var c=h/a;return i/a-c*c}return 0}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{columnsGenerator:function(){this.generate=function(f,b,e){switch(f){case"append":c(b,e);break;case"merge":d(b,e);break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported value: "{0}"',f);}};function c(f,g){var c=f.getFieldNames(),a,e,d;for(a=0,e=c.length;a<e;a++){d=b(c[a]);g.push(d)}}function d(l,i){var g=[],h=l.getFieldNames(),d={},e,k,c,j,f;for(e=0,k=h.length;e<k;e++)d[j=h[e]]=j;a.wijmo.wijgrid.traverse(i,function(b){if(b.isLeaf&&!b.isBand){c=b.dataKey;if(a.wijmo.wijgrid.validDataKey(c)){if(d[c]!==undefined)delete d[c]}else c!==null&&g.push(b)}});if(g.length){e=0;for(c in d)if(d.hasOwnProperty(c)){f=g[e++];if(f){f.dataKey=d[c];delete d[c]}}}for(c in d)if(d.hasOwnProperty(c)){f=b(d[c]);i.push(f)}}function b(b){return a.wijmo.wijgrid.createDynamicField({dataKey:b})}}})})(jQuery);
(function(){"use strict";if(!window.Raphael)return;Raphael.prototype.htmlText=function(k,l,a,i,e,d){function h(b,a,d){var f=/<(b|strong)>/,e=/<(i|em)>/,c=/href=[\"\']([^\"\']+)[\"\']/,g=/<a/;d&&b.attr(d);f.test(a)&&b.attr("font-weight","bold");e.test(a)&&b.attr("font-style","italic");if(g.test(a))a.match(c)[1]&&b.attr("href",a.match(c)[1])}var j=a.toString().split(/<br\s?\/>|\\r/i),g=this,b=g.set(),c=0,f=0;e=e||3;d=d||5;$.each(j,function(m,k){var j=0,l=k.split("|||");k=k.replace(/<([A-Za-z]+(.|\n)*?)>/g,"|||<$1>").replace(/<\/([A-Za-z]*)>/g,"</$1>|||");$.each(l,function(o,l){var k=null,d=null,m=0,n=0;if(l!==""){k=l;k=$.trim(k.replace(/<(.|\n)*?>/g,""));a=g.text(0,0,k);h(a,l,i);d=a.wijGetBBox();m=d.width/2+c;n=-d.height/2+f;c=c+d.width+e;a.translate(m,n);b.push(a);if(j<d.height)j=d.height}});f+=j+d;c=j=0});f=0;b.translate(k-b.getBBox().x,l-b.getBBox().y);return b};var b={content:"",contentStyle:{},title:"",titleStyle:{},style:{fill:"white","fill-opacity":.5},closeBehavior:"auto",mouseTrailing:true,triggers:"hover",animated:"fade",showAnimated:null,hideAnimated:null,duration:500,showDuration:500,hideDuration:500,easing:null,showEasing:null,hideEasing:null,showDelay:150,hideDelay:150,relativeTo:"mouse",compass:"east",offsetX:0,offsetY:0,showCallout:true,calloutFilled:false,calloutFilledStyle:{fill:"black"},calloutLength:12,calloutOffset:0,calloutAnimation:{easing:null,duration:500},windowCollisionDetection:true,calloutSide:null,width:null,height:null,beforeShowing:null};Raphael.fn.closeBtn=function(c,d,b){var a=Math.cos(Math.PI/4)*b,f=this.set(),h=["M",c-a,d-a,"L",c+a,d+a,"M",c-a,d+a,"L",c+a,d-a],g=this.path(h.concat(" ")),e=null;g.attr({cursor:"pointer"});f.push(g);e=this.rect(c-b,d-b,b*2,b*2);e.attr({fill:"white","fill-opacity":0,cursor:"pointer",stroke:"none"});f.push(e);return f};Raphael.fn.tooltip=function(l,U){var a=$.extend(true,{},b,U),e=this,x=null,K=0,L=0,g,k,f,d,c,q=null,p=null,n=null,m=5,j=null,u=e.tooltip.animations,t=a.calloutOffset,z=a.width,y=a.height,r=a.calloutLength/2,o=0,h=0,i=0,Q=function(c,d){var a=c.getBBox(),b={x:0,y:0};switch(d.toLowerCase()){case"east":b.x=a.x+a.width;b.y=a.y+a.height/2;break;case"eastnorth":b.x=a.x+a.width;b.y=a.y;break;case"eastsouth":b.x=a.x+a.width;b.y=a.y+a.height;break;case"west":b.x=a.x;b.y=a.y+a.height/2;break;case"westnorth":b.x=a.x;b.y=a.y;break;case"westsouth":b.x=a.x;b.y=a.y+a.height;break;case"north":b.x=a.x+a.width/2;b.y=a.y;break;case"northeast":b.x=a.x+a.width;b.y=a.y;break;case"northwest":b.x=a.x;b.y=a.y;break;case"south":b.x=a.x+a.width/2;b.y=a.y+a.height;break;case"southeast":b.x=a.x+a.width;b.y=a.y+a.height;break;case"southwest":b.x=a.x;b.y=a.y+a.height}return b},s=function(a){if(a){window.clearTimeout(a);a=null}},w=function(h){if(j){var b,e,i;if(a.hideAnimated||a.animated){b=a.hideAnimated;if(!b)b=a.animated;if(b&&u[b]){i={animated:b,duration:a.hideDuration||a.duration,easing:a.hideEasing||a.easing,context:j,show:false};u[b](i)}}e=a.hideDuration;if(h)e=h;window.setTimeout(function(){var a,b;if(g){g.wijRemove();g=null}if(k){k.wijRemove();k=null}if(f){f.wijRemove();f=null}if(d){for(a=0,b=d.length;a<b;a++)d[a].unclick();d.wijRemove();d=null}if(c){c.wijRemove();c=null}n=null;j=null},e)}},A=function(){q&&s(q);p&&s(p);if(a.hideDelay)p=window.setTimeout(function(){w()},a.hideDelay);else w()},C=function(b){var a="";switch(b.toLowerCase()){case"east":a="right-middle";h=2;i=0;break;case"eastnorth":a="right-top";h=2;i=-2;break;case"eastsouth":a="right-bottom";h=2;i=2;break;case"west":a="left-middle";h=-2;i=0;break;case"westnorth":a="left-top";h=-2;i=-2;break;case"westsouth":a="left-bottom";h=-2;i=2;break;case"north":a="top-middle";h=0;i=-2;break;case"northeast":a="top-right";h=2;i=-2;break;case"northwest":a="top-left";h=-2;i=-2;break;case"south":a="bottom-middle";h=0;i=2;break;case"southeast":a="bottom-right";h=2;i=2;break;case"southwest":a="bottom-left";h=-2;i=2}return a},G=function(c,b){var d=[],e=a.compass;if(a.calloutSide)e=a.calloutSide;switch(e.toLowerCase()){case"east":case"eastsouth":case"eastnorth":d=["M",c.x+b,c.y+b,"l",-b,-b,"l",b,-b,"Z"];break;case"west":case"westsouth":case"westnorth":d=["M",c.x-b,c.y-b,"l",b,b,"l",-b,b,"Z"];break;case"north":case"northeast":case"northwest":d=["M",c.x-b,c.y-b,"l",b,b,"l",b,-b,"Z"];break;case"south":case"southeast":case"southwest":d=["M",c.x-b,c.y+b,"l",b,-b,"l",b,b,"Z"]}return d},H=function(c,b){if($.isFunction(c)){var e=null,a,d={target:null,fmt:c};if(b&&b.target){a=$(b.target).data("raphaelObj");if(!a)a=$(b.target.parentNode).data("raphaelObj");d.target=a}e=$.proxy(d.fmt,d);return e().toString()}return c},E=function(b){if(a.calloutSide){var d=r||o;switch(a.calloutSide){case"south":case"north":if(b)c.animate({translation:-z/2+d+t+",0"},b);else c.translate(-z/2+d+t,0);break;case"east":case"west":if(b)c.animate({translation:"0,"+(-y/2+d+t)},b);else c.translate(0,-y/2+d+t)}}},R=/\{([^\}]+)\}/g,N=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,S=function(c,d,b){var a=b;d.replace(N,function(f,b,e,c,d){b=b||c;if(a){if(a[b]!=="string")a=a[b];if(typeof a==="function"&&d)a=a()}});a=(a===null||a===b?c:a).toString();return a},W=function(b,a){return String(b).replace(R,function(b,c){return S(b,c,a)})},I=function(i,u,s,t,h){var o=u.split("-"),f=5,p=s.getBBox(),d=Math.round(p.width),c=Math.round(p.height),j=Math.round(p.x)-f,k=Math.round(p.y)-f,b=0,g=0,m=0,n=0,q=null,l=null,r=null;if(a.width)d=d>a.width?d:a.width;if(a.height)c=c>a.height?c:a.height;z=d;y=c;b=Math.min(c/4,d/4,t);if(h)h=Math.min(c/4,d/4,h);if(h){g=h;q={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{offset},0,-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{offset},0,{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom},0-{offset},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},0,{offset},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"}}else q={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"};l=([{x:j+f,y:k,w:d,w4:d/4,h4:c/4,left:0,right:d-b*2-g*2,top:0,bottom:c-b*2-g*2,r:f,h:c,gap:b,offset:g*2},{x:j+f,y:k,w:d,w4:d/4,h4:c/4,left:d/2-b-g,right:d/2-b-g,top:c/2-b-g,bottom:c/2-b-g,r:f,h:c,gap:b,offset:g*2},{x:j+f,y:k,w:d,w4:d/4,h4:c/4,right:0,left:d-b*2-g*2,bottom:0,top:c-b*2-g*2,r:f,h:c,gap:b,offset:g*2}])[o[1]==="middle"?1:(o[1]==="left"||o[1]==="top")*2];r=e.path(W(q[o[0]],l));switch(o[0]){case"top":m=i.x-(j+f+l.left+b+h);n=i.y-(k+f+c+f+b+h);break;case"bottom":m=i.x-(j+f+l.left+b+h);n=i.y-(k-b-h);break;case"left":m=i.x-(j+f+d+f+b+h);n=i.y-(k+f+l.top+b+h);break;case"right":m=i.x-(j-b-g);n=i.y-(k+f+l.top+b+g)}r.translate(m,n);s.translate(m,n);return r},D=function(m,n,c,d,o,p){var b=m.getBBox(),f=0,a=n,g=b.x+o,h=b.y+p,l=e.width,k=e.height,i=c,j=d;if(e.raphael.vml){l=$(e.canvas).width();k=$(e.canvas).height()}if(g+c<0)if(a.indexOf("west")===-1){if(g+b.width/2+b.width-c<=l){f++;a=a.toLowerCase()+"east";i=0-c}}else if(g+b.width+b.width-c<=l){f++;a=a.toLowerCase().replace("west","east");i=0-c}if(h+d<0)if(a.indexOf("north")===-1){if(h+b.height/2+b.height-d<=k){f++;a=a.toLowerCase()+"south";j=0-d}}else if(h+b.height+b.height-d<=k){f++;a=a.toLowerCase().replace("north","south");j=0-d}if(g+b.width+c>l)if(a.indexOf("east")===-1){if(g-b.width/2-c>=0){f++;a=a.toLowerCase()+"west";i=0-c}}else if(g-b.width-c>=0){f++;a=a.toLowerCase().replace("east","west");i=0-c}if(h+b.height+d>k)if(a.indexOf("south")===-1){if(h-b.height/2-d>=0){f++;a=a.toLowerCase()+"north";j=0-d}}else if(h-b.height-d>=0){f++;a=a.toLowerCase().replace("south","north");j=0-d}return f?{compass:a,offsetX:i,offsetY:j}:false},v=function(J,B,z,O,L,M,N){var t,s,F,p=e.set(),H=null,q=null,Q=null,w=0,x=0,y=250,K=0,P=0,b,l={x:J.x,y:J.y};F=C(L);l.x+=M+h;l.y+=N+i;j=e.set();k&&k.wijRemove();if(B&&B.length>0){k=e.htmlText(-1e3,-1e3,B,a.titleStyle);j.push(k);t=k.getBBox()}else t={left:-1e3,top:-1e3,width:0,height:0};g&&g.wijRemove();if(z&&z.length>0){g=e.htmlText(-1e3,-1e3,z,a.contentStyle);j.push(g);s=g.getBBox()}else s={left:-1e3,top:-1e3,width:0,height:0};if(d){for(K=0,P=d.length;K<P;K++)d[K].unclick();d.wijRemove()}g&&g.translate(0,t.height/2+s.height/2);if(a.closeBehavior==="sticky"){d=e.closeBtn(-1e3,-1e3,m);j.push(d);if(a.width&&a.width>t.width+m*2&&a.width>s.width+m*2)d.translate(a.width-m,m);else if(t.width>=s.width-m*2)d.translate(t.width+m,m);else d.translate(s.width-m,m);$.each(d,function(){this.click(function(a){A(a)})})}k&&p.push(k);g&&p.push(g);d&&p.push(d);if(!a.showCallout)r=0;if(a.calloutSide||a.calloutFilled){r=0;o=a.calloutLength/2;if(a.calloutSide)F=C(a.calloutSide)}if(a.calloutSide&&p.length===0){g=e.htmlText(-1e3,-1e3," ");p.push(g)}c&&c.wijRemove();f&&f.wijRemove();f=e.path();if(n){if(a.calloutSide||a.calloutFilled){H=G(n,o);c=e.path(H.concat(" "));a.calloutFilled&&c.attr(a.calloutFilledStyle);a.calloutSide&&E(0)}f=I(n,F,p,r,o);if(O){b=D(f,L,M,N,l.x-n.x,l.y-n.y);if(b){v(J,B,z,false,b.compass,b.offsetX,b.offsetY);return}}j.push(c);j.push(f);w=l.x-n.x;x=l.y-n.y;k&&k.animate({translation:w+","+x},y);g&&g.animate({translation:w+","+x},y);d&&d.animate({translation:w+","+x},y);c&&c.animate({translation:w+","+x},y);f&&f.animate({translation:w+","+x},y)}else{if(a.calloutSide||a.calloutFilled){H=G(l,o);c=e.path(H.concat(" "));a.calloutFilled&&c.attr(a.calloutFilledStyle);a.calloutSide&&E(0)}f=I(l,F,p,r,o);if(O){b=D(f,L,M,N,0,0);if(b){v(J,B,z,false,b.compass,b.offsetX,b.offsetY);return}}j.push(c);j.push(f);if(a.showAnimated||a.animated){q=a.showAnimated;if(!q)q=a.animated;if(q&&u[q]){Q={animated:q,duration:a.showDuration||a.duration,easing:a.showEasing||a.easing,context:j,show:true};u[q](Q)}}}n=l;f.attr(a.style);f.toFront();p.toFront()},F=function(h,b){var f=a.title,d=a.content,g=null,e=null,c;if($.isFunction(a.beforeShowing)){g=null;e={target:null,options:a,fmt:a.beforeShowing};if(b&&b.target){c=$(b.target).data("raphaelObj");if(!c)c=$(b.target.parentNode).data("raphaelObj");e.target=c}g=$.proxy(e.fmt,e);g()}f=H(f,b);d=H(d,b);if(!f&&!d)return;v(h,f,d,a.windowCollisionDetection,a.compass,a.offsetX,a.offsetY)},M=function(b,c){q&&s(q);p&&s(p);if(a.showDelay)q=window.setTimeout(function(){F(b,c)},a.showDelay);else F(b,c)},B=function(b){x=$(e.canvas.parentNode).offset();K=x.left;L=x.top;var f=a.relativeTo,d={x:0,y:0},c=null;switch(f){case"mouse":d.x=b.pageX-K;d.y=b.pageY-L;break;case"element":c=$(b.target).data("raphaelObj");if(!c)c=$(b.target.parentNode).data("raphaelObj");d=Q(c,a.compass)}M(d,b)},J=function(b){$(b.node).data("raphaelObj",b);switch(a.triggers){case"hover":$(b.node).bind("mouseover.Rtooltip",function(a){B(a)}).bind("mouseout.Rtooltip",function(b){a.closeBehavior==="auto"&&A(b)});a.mouseTrailing&&a.relativeTo==="mouse"&&$(b.node).bind("mousemove.Rtooltip",function(a){B(a)});break;case"click":$(b.node).bind("click.Rtooltip",function(a){B(a)})}},P=function(){var a,b;if(l)if(l.length)for(a=0,b=l.length;a<b;a++)J(l[a]);else J(l)},O=function(){var a,b;if(l)if(l.length)for(a=0,b=l.length;a<b;a++)$(l[a].node).unbind(".Rtooltip");else $(l.node).unbind(".Rtooltip")},T=function(){O();w(0)},V=function(){this.hide=function(){A()};this.showAt=function(a){M(a)};this.resetCalloutOffset=function(e){var f=a.calloutOffset,b=a.calloutSide,d=a.calloutAnimation;if(c)if(b==="south"||b==="north")c.animate({translation:e-f+",0"},d.duration,d.easing);else(b==="east"||b==="west")&&c.animate({translation:"0,"+(e-f)},d.duration,d.easing);a.calloutOffset=e};this.destroy=function(){T()};this.getOptions=function(){return a}};l&&P();return new V};Raphael.fn.tooltip.animations={fade:function(a){var b=a.context;if(a.show){b.attr({opacity:0});b.animate({opacity:1},a.duration,a.easing)}else b.animate({opacity:0},a.duration,a.easing)}};Raphael.fn.wij={moveTo:function(a,b){return this.path("M "+a+" "+b)},lineTo:function(a,b){return this.path("M "+this.wij.lastX+" "+this.wij.lastY+"L "+a+" "+b)},line:function(a,b,c,d){return this.path(["M",a,b,"L",c,d])},sector:function(b,c,a,d,e){var f=this.wij.getPositionByAngle(b,c,a,d),g=this.wij.getPositionByAngle(b,c,a,e);return this.path(["M",b,c,"L",f.x,f.y,"A",a,a,0,+(e-d>180),0,g.x,g.y,"z"])},donut:function(d,e,b,a,f,g){var c=this.wij.getPositionByAngle(d,e,b,f),k=this.wij.getPositionByAngle(d,e,b,g),j=this.wij.getPositionByAngle(d,e,a,f),i=this.wij.getPositionByAngle(d,e,a,g),h=g-f>180;return this.path(["M",c.x,c.y,"A",b,b,0,+h,0,k.x,k.y,"L",i.x,i.y,"A",a,a,0,+h,1,j.x,j.y,"L",c.x,c.y,"z"])},roundRect:function(l,m,e,d,k,i,h,j){var a=[],c=[-1,1,1,1,1,-1,-1,-1],g=["v","h","v","h"],b=null,f=null;$.each([k,i,h,j],function(c,b){if(typeof b==="number")a=a.concat({x:b,y:b});else if(typeof b==="object")a=a.concat(b);else a=a.concat({x:0,y:0})});b=["M",l+a[0].x,m];f=[d-a[0].y-a[1].y,e-a[1].x-a[2].x,a[2].y+a[3].y-d,a[3].x+a[0].x-e];$.each(a,function(d,a){if(a.x&&a.y)b=b.concat("a",a.x,a.y,0,0,0,c[2*d]*a.x,c[2*d+1]*a.y);b=b.concat(g[d],f[d])});b.push("z");return this.path(b)},wrapText:function(n,o,m,h,l,g){var e=this,d=g.rotation,j=d?$.extend(true,{},g,{rotation:0}):g,f=o,c=e.set(),a=null,b=null,i=[];function k(j,i,h){var b=null,g=null,a=j.split(" "),f=[],c=[],d="";while(a.length){d+=" "+a[0];b=e.text(-1e3,-1e3,d);b.attr(h);g=b.wijGetBBox();if(g.width>i){if(c.length){f.push(c);d=a[0]}c=[a.shift()]}else c.push(a.shift());a.length===0&&f.push(c);b.wijRemove();b=null}return f}$.each(k(m,h,j),function(p,o){var k=o.join(" "),m=l||"near",g=e.text(n,f,k),b=0,d=0;g.attr(j);a=g.wijGetBBox();switch(m){case"near":b=h-a.width/2;d+=a.height/2;f+=a.height;break;case"center":b+=h/2;d+=a.height/2;f+=a.height;break;case"far":b+=a.width/2;d+=a.height/2;f+=a.height}a.x+=b;a.y+=d;g.translate(b,d);c.push(g);i.push(a)});if(d)if(c.length>1){a=c.wijGetBBox();b={x:a.x+a.width/2,y:a.y+a.height/2};$.each(c,function(m,l){var g=Math,h=i[m],c={x:h.x+h.width/2,y:h.y+h.height/2},k=g.sqrt(g.pow(c.x-b.x,2)+g.pow(c.y-b.y,2)),a=0,f=null,j=null;l.attr({rotation:d});if(k===0)return true;a=Raphael.deg(g.asin(g.abs(c.y-b.y)/k));if(c.y>b.y)if(c.x>b.x)a-=360;else a=-1*(a+180);else if(c.x>b.x)a*=-1;else a=-1*(180-a);j=e.wij.getPositionByAngle(b.x,b.y,k,-1*(d+a));f=l.wijGetBBox();l.translate(j.x-f.x-f.width/2,j.y-f.y-f.height/2)})}else c[0].attr({rotation:d});return c},getPositionByAngle:function(e,f,c,d){var a={},b=Raphael.rad(d);a.x=e+c*Math.cos(-1*b);a.y=f+c*Math.sin(-1*b);return a},getSVG:function(){function l(e,b){var a="<"+e+" ",c=null,d=false;$.each(b,function(b,c){if(b==="text"||b==="opacity"||b==="transform"||b==="path"||b==="w"||b==="h"||b==="translation")return true;if(c){if(b==="stroke"&&c===0)c="none";a+=b+"='"+c+"' "}});if(b.opacity){c=b.opacity;a+="opacity='"+c+"' style='opacity:"+c+";";d=true}if(b.transform&&b.transform.length>0){c=b.transform;if(d)a+="transform:"+c;else{a+="style='transform:"+c;d=true}}if(d)a+="'";if(b.text){c=b.text;a+="><tspan>"+c+"</tspan>"}else a+=">";a+="</"+e+">";return a}for(var g=this,j='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+g.canvas.offsetWidth+'" height="'+g.canvas.offsetHeight+'"><desc>Created with Raphael</desc><defs></defs>',c="",h,f,d,e=0,k=0,b=0,i=0,a=g.bottom;a;a=a.next)if(a&&a.type)switch(a.type){case"path":for(e=0,k=a.attrs.path.length;e<k;e++){f=a.attrs.path[e];for(b=0,i=f.length;b<i;b++){d=f[b];if(b<1)c+=d;else if(b===i-1)c+=d;else c+=d+","}}if(c&&c.length>0)a.attrs.d=c.replace(/,/g," ");break;case"text":if(!a.attrs["text-anchor"])a.attrs["text-anchor"]="middle";break;case"image":h=a.transformations;a.attrs.transform=h?h.join(" "):"";break;case"ellipse":case"rect":j+=l(a.type,a.attrs)}j+="</svg>";return j}};Raphael.el.wijRemove=function(){if(this.removed)return;this.node.parentNode&&this.remove()};Raphael.st.wijRemove=function(){$.each(this,function(b,a){a.wijRemove&&a.wijRemove()})};Raphael.el.wijGetBBox=function(){var a=this.getBBox(),d=null,c=[],e,f,j,i,g,b={left:0,right:0,top:0,bottom:0},h=0;if(this.attrs&&this.attrs.rotation){d=this._.rt.deg*Math.PI/180;c.push({x:0,y:0});c.push({x:a.width,y:0});c.push({x:0,y:a.height});c.push({x:a.width,y:a.height});for(h=0;h<c.length;h++){g=c[h];e=parseInt(g.x*Math.cos(d)+g.y*Math.sin(d),10);f=parseInt(g.x*Math.sin(d)+g.y*Math.cos(d),10);b.left=Math.min(b.left,e);b.right=Math.max(b.right,e);b.top=Math.min(b.top,f);b.bottom=Math.max(b.bottom,f)}j=parseInt(Math.abs(b.right-b.left),10);i=parseInt(Math.abs(b.bottom-b.top),10);e=a.x+a.width/2-j/2;f=a.y+a.height/2-i/2;return{x:e,y:f,width:j,height:i}}a=this.getBBox();if(Raphael.vml&&this.type==="text"){this.shape.style.display="inline";a.width=this.shape.scrollWidth;a.height=this.shape.scrollHeight}return a};Raphael.el.wijAnimate=function(a,g,b,e){if(!a||$.isEmptyObject(a))return;var d=this.shadow,c=0,f={easeInCubic:">",easeOutCubic:"<",easeInOutCubic:"<>",easeInBack:"backIn",easeOutBack:"backOut",easeOutElastic:"elastic",easeOutBounce:"bounce"};if(f[b])b=f[b];this.animate(a,g,b,e);if(d&&d.offset){c=d.offset;if(a.x)a.x+=c;if(a.y)a.y+=c;this.shadow.animate(a,g,b,e)}};Raphael.el.wijAttr=function(a,c){this.attr(a,c);if(this.shadow)if(typeof a==="object"){var b=$.extend(true,{},a);if(b.fill)delete b.fill;if(b.stroke)delete b.stroke;if(b["stroke-width"])delete b["stroke-width"];this.shadow.attr(b,c)}else if(typeof a==="string")switch(a){case"clip-rect":case"cx":case"cy":case"fill-opacity":case"font":case"font-family":case"font-size":case"font-weight":case"height":case"opacity":case"path":case"r":case"rotation":case"rx":case"ry":case"scale":case"stroke-dasharray":case"stroke-linecap":case"stroke-linejoin":case"stroke-miterlimit":case"stroke-opacity":case"stroke-width":case"translation":case"width":this.shadow.attr(a,c);break;case"x":this.shadow.attr(a,c);this.shadow.attr("translation","1 0");break;case"y":this.shadow.attr(a,c);this.shadow.attr("translation","0 1")}};Raphael.st.wijAttr=function(b,a){$.each(this.items,function(d,c){c.wijAttr(b,a)});return this};Raphael.st.wijAnimate=function(f,g,e,d){var a=0,c=0,b=null;for(a=0,c=this.items.length;a<c;a++){b=this.items[a];b.wijAnimate(f,g,e,d)}return this};Raphael.st.wijGetBBox=function(){for(var b=[],c=[],j=[],i=[],g=Math.max,h=Math.min,e="push",d="apply",a=null,f=0,f=this.items.length-1;f>=0;f--){a=this.items[f].wijGetBBox();b[e](a.x);c[e](a.y);j[e](a.x+a.width);i[e](a.y+a.height)}b=h[d](0,b);c=h[d](0,c);return{x:b,y:c,width:g[d](0,j)-b,height:g[d](0,i)-c}};function a(a){var b="http://www.w3.org/2000/svg";return a.nodeType===1&&a.namespaceURI===b}$.expr.filter.CLASS=function(b,d){var c=!a(b)?b.className:b.className?b.className.baseVal:b.getAttribute("class");return(" "+c+" ").indexOf(d)>-1};$.expr.preFilter.CLASS=function(d,f,g,h,j,i){var c=0,b=null,e=null;d=" "+d[1].replace(/\\/g,"")+" ";if(i)return d;for(c=0,b={};b;c++){b=f[c];if(!b)try{b=f.item(c)}catch(k){}if(b){e=!a(b)?b.className:(b.className?b.className.baseVal:"")||b.getAttribute("class");if(j^(e&&(" "+e+" ").indexOf(d)>-1))!g&&h.push(b);else if(g)f[c]=false}}return false}})();(function(a){"use strict";a.widget("wijmo.wijchartcore",{options:{width:null,height:null,seriesList:[],seriesStyles:[{stroke:"#77b3af",opacity:.9,"stroke-width":1},{stroke:"#67908e",opacity:.9,"stroke-width":1},{stroke:"#465d6e",opacity:.9,"stroke-width":1},{stroke:"#5d3f51",opacity:.9,"stroke-width":1},{stroke:"#682e32",opacity:.9,"stroke-width":1},{stroke:"#8c5151",opacity:.9,"stroke-width":1},{stroke:"#ce9262",opacity:.9,"stroke-width":1},{stroke:"#ceb664",opacity:.9,"stroke-width":1},{stroke:"#7fb34f",opacity:.9,"stroke-width":1},{stroke:"#2a7b5f",opacity:.9,"stroke-width":1},{stroke:"#6079cb",opacity:.9,"stroke-width":1},{stroke:"#60a0cb",opacity:.9,"stroke-width":1}],seriesHoverStyles:[{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5}],marginTop:25,marginRight:25,marginBottom:25,marginLeft:25,textStyle:{fill:"#888","font-size":"10pt",stroke:"none"},header:{text:"",style:{fill:"none",stroke:"none"},textStyle:{"font-size":"18pt",fill:"#666",stroke:"none"},compass:"north",orientation:"horizontal",visible:true},footer:{text:"",style:{fill:"#fff",stroke:"none"},textStyle:{fill:"#000",stroke:"none"},compass:"south",orientation:"horizontal",visible:false},legend:{text:"",textMargin:{left:2,top:2,right:2,bottom:2},style:{fill:"none",stroke:"none"},textStyle:{fill:"#333",stroke:"none"},titleStyle:{"font-weight":"bold",fill:"#000",stroke:"none"},compass:"east",orientation:"vertical",visible:true},axis:{x:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:true,textVisible:true,text:"",textStyle:{fill:"#888","font-size":"15pt","font-weight":"bold"},labels:{style:{fill:"#333","font-size":"11pt"},textAlign:"near",width:null},compass:"south",autoMin:true,autoMax:true,min:null,max:null,origin:null,autoMajor:true,autoMinor:true,unitMajor:null,unitMinor:null,gridMajor:{visible:false,style:{stroke:"#CACACA","stroke-dasharray":"- "}},gridMinor:{visible:false,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]},y:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:false,textVisible:true,text:"",textStyle:{fill:"#888","font-size":"15pt","font-weight":"bold"},labels:{style:{fill:"#333","font-size":"11pt"},textAlign:"center",width:null},compass:"west",autoMin:true,autoMax:true,min:null,max:null,origin:null,autoMajor:true,autoMinor:true,unitMajor:null,unitMinor:null,gridMajor:{visible:true,style:{stroke:"#999999","stroke-width":"0.5","stroke-dasharray":"none"}},gridMinor:{visible:false,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]}},hint:{enable:true,content:null,contentStyle:{fill:"#d1d1d1","font-size":"16pt"},title:null,titleStyle:{fill:"#d1d1d1","font-size":"16pt"},style:{fill:"270-#333333-#000000","stroke-width":"2"},animated:"fade",showAnimated:"fade",hideAnimated:"fade",duration:120,showDuration:120,hideDuration:120,easing:"",showEasing:"",hideEasing:"",showDelay:150,hideDelay:150,compass:"north",offsetX:0,offsetY:0,showCallout:true,calloutFilled:false,calloutFilledStyle:{fill:"#000"}},showChartLabels:true,chartLabelStyle:{},chartLabelFormatString:"",disableDefaultTextStyle:false,shadow:true,beforeSeriesChange:null,seriesChanged:null,beforePaint:null,painted:null},innerState:{},_setOption:function(b,f){var e=this,c=e.options,j=null,i=0,d=0,h,g;if(b==="seriesList"){if(!f)f=[];j=a.Event("beforeserieschange");if(e._trigger("beforeSeriesChange",j,{oldSeriesList:c.seriesList,newSeriesList:f})===false)return false;c.seriesList=f;e._trigger("seriesChanged",null,f);e.seriesTransition=true}else if(a.isPlainObject(c[b]))a.extend(true,c[b],f);else a.Widget.prototype._setOption.apply(e,arguments);b==="disabled"&&e._handleDisabledOption(f,e.element);if(b==="seriesTransition"||b==="animation"||b==="disabled")return;i=c.seriesList.length;if(b==="seriesList"||b==="seriesStyles")for(h=c.seriesStyles.length,d=h;d<i;d++)c.seriesStyles[d]=c.seriesStyles[d%h];if(b==="seriesList"||b==="seriesHoverStyles"){g=c.seriesHoverStyles.length;for(d=g;d<i;d++)c.seriesHoverStyles[d]=c.seriesHoverStyles[d%g]}e.redraw()},_create:function(){var b=this,f=b.options,e=f.width||b.element.width(),d=f.height||b.element.height(),c=null;b.updating=0;b.innerState={};if(b.element.length>0){if(b.element.is("table")){b._parseTable();c=a("<div></div>");e&&c.css("width",e);d&&c.css("height",d);b.element.after(c);b.chartElement=c}else b.chartElement=b.element;f.disabled&&b.disable();b.chartElement.addClass("ui-widget");b.canvas=new Raphael(b.chartElement[0],e,d)}b.headerEles=[];b.footerEles=[];b.legendEles=[];b.axisEles=[];b.legends=[];b.legendIcons=[];b.chartLabelEles=[]},_handleDisabledOption:function(b,c){var a=this;if(b){if(!a.disabledDiv)a.disabledDiv=a._createDisabledDiv(c);a.disabledDiv.appendTo("body")}else if(a.disabledDiv){a.disabledDiv.remove();a.disabledDiv=null}},_createDisabledDiv:function(d){var g=this,b=d?d:g.element,c=b.offset(),f=b.outerWidth(),e=b.outerHeight();return a("<div></div>").addClass("ui-disabled").css({"z-index":"99999",position:"absolute",width:f,height:e,left:c.left,top:c.top})},_init:function(){var a=this;if(!a.rendered){a._paint();a.rendered&&a._bindLiveEvents()}},destroy:function(){var b=this;b._unbindLiveEvents();b._clearChartElement();b.chartElement.removeClass("ui-widget");b.element!==b.chartElement&&b.chartElement.remove();b.element.empty();if(b.disabledDiv){b.disabledDiv.remove();b.disabledDiv=null}a.Widget.prototype.destroy.apply(b,arguments)},getCanvas:function(){return this.canvas},addSeriesPoint:function(c,e,f){var b=this.options.seriesList,d=null,a=null;if(c>=b.length)return;d=b[c];a=d.data||[];a.x.push(e.x);a.y.push(e.y);if(f){a.x.shift();a.y.shift()}this._setOption("seriesList",b)},beginUpdate:function(){var a=this;a.updating++},endUpdate:function(){var a=this;a.updating--;a.redraw()},redraw:function(e){var a=this,d=a.options,c=0,b=0;if(a.updating>0)return;if(e&&a.rendered)return;c=d.width||a.element.width();b=d.height||a.element.height();if(c<1||b<1)return;a.canvas.setSize(c,b);a._unbindLiveEvents();a._paint();a._bindLiveEvents()},getSVG:function(){return Raphael.type==="SVG"?this.chartElement.html():this.canvas.wij.getSVG()},exportChart:function(){var b=document.createElement("form"),c=this.getSVG();b.action="http://export.highcharts.com/";b.method="post";b.style.display="none";document.body.appendChild(b);a.each(["filename","type","width","svg"],function(f,e){var d=document.createElement("input");a(d).attr("name",e).attr("type","hidden").attr("value",({filename:"chart",type:"image/png",width:600,svg:c})[e]);b.appendChild(d)});b.submit();document.body.removeChild(b)},round:function(d,c){var b=Math.pow(10,c),a=d*b;a=Math.round(a);return a/b},_parseTable:function(){if(!this.element.is("table"))return;var d=this,e=d.element,b=d.options,c=a("caption",e),g=a("thead th",e),f=[],h=a("tbody tr",e);if(c.length){b.header=a.extend({visible:true,text:a.trim(a(c[0]).text())},b.header);if(c.length>1)b.footer=a.extend({visibel:true,text:a.trim(a(c[1]).text())},b.footer)}b.legend=a.extend({visible:true},b.legend);d._getSeriesFromTR(g,h,f);d.options.seriesList=f},_getSeriesFromTR:function(d,h,l){var e=[],i=null,k=null,g=null,b=null,c=null,j=null,f=null;d.length&&d.each(function(){i=a.trim(a(this).text());e.push(i)});h.length&&h.each(function(){k=a("th",a(this));g=a.trim(k.text());b=[];c=a("td",a(this));c.length&&c.each(function(){j=a(this);b.push(parseFloat(a.trim(j.text())))});f={label:g,legendEntry:true,data:{x:e,y:b}};l.push(f)})},_clearChartElement:function(){var b=this;if(b.headerEles.length){a.each(b.headerEles,function(b,a){a.wijRemove();a=null});b.headerEles=[]}if(b.footerEles.length){a.each(b.footerEles,function(b,a){a.wijRemove();a=null});b.footerEles=[]}if(b.legendEles.length){a.each(b.legendEles,function(b,a){a.wijRemove();a=null});b.legendEles=[]}if(b.legends.length){a.each(b.legends,function(b,a){a.wijRemove();a=null});b.legends=[]}if(b.legendIcons.length){a.each(b.legendIcons,function(b,a){a.wijRemove();a=null});b.legendIcons=[]}if(b.axisEles.length){a.each(b.axisEles,function(b,a){a.wijRemove();a=null});b.axisEles=[]}if(b.chartLabelEles.length){a.each(b.chartLabelEles,function(b,a){a.wijRemove();a=null});b.chartLabelEles=[]}b.canvas.clear();b.innerState={}},_text:function(c,d,b){var a=this.canvas.text(c,d,b);if(this.options.disableDefaultTextStyle)a.node.style.cssText="";return a},_getDiffAttrs:function(d,b){var c={};a.each(b,function(a){if(typeof d==="undefined")return c;else if(typeof d[a]==="undefined")c[a]=b[a];else if(d[a]!==b[a])c[a]=b[a]});return c},_paintShadow:function(c,a,d){if(this.options.shadow){a=a||1;d=d||"#CCCCCC";var b=c.clone();b.insertBefore(c);b.attr({translation:a+" "+a,stroke:d,"stroke-width":a});b.toBack();b.offset=a;c.shadow=b}},_paint:function(){var b=this,f=b.options,a=b.element,e=a.css("display")==="none"||a.css("visibility")==="hidden",d={},c=null;if(e){d=a.css("left");c=a.css("position");a.css("left","-10000px");a.css("position","absolute");a.show()}if(a.is(":hidden")){if(e){a.css("left",d);a.css("position",c);a.hide()}return}b._clearChartElement();if(b._trigger("beforePaint")===false)return;b.canvasBounds={startX:0,endX:f.width||a.width(),startY:0,endY:f.height||a.height()};b._paintHeader();b._paintFooter();b._paintLegend();b._paintChartArea();b._paintChartLabels();b._trigger("painted");b.rendered=true;if(e){a.css("left",d);a.css("position",c);a.hide()}},_calculatePosition:function(g,f,e){var b={x:0,y:0},c=5,d=5,a=this.canvasBounds;switch(g){case"north":b.x=(a.endX-a.startX)/2;b.y=a.startY+e/2+d;a.startY=a.startY+d*2+e;break;case"south":b.x=(a.endX-a.startX)/2;b.y=a.endY-e/2-d;a.endY=a.endY-d*2-e;break;case"east":b.x=a.endX-f/2-c;b.y=(a.endY-a.startY)/2;a.endX=a.endX-c*2-f;break;case"west":b.x=a.startX+f/2+c;b.y=(a.endY-a.startY)/2;a.startX=a.startX+c*2+f}return b},_paintHeader:function(){var g=2,c=this,m=c.options,b=m.header,h=null,d=null,k=null,j=null,i=null,e=null,l=0,f=null;if(b.text&&b.text.length>0&&b.visible){h=b.compass;d=c._text(0,0,b.text);l=c._getRotationByCompass(h);k=a.extend(true,{},m.textStyle,{rotation:l},b.textStyle);d.attr(k);j=d.wijGetBBox();i=c._calculatePosition(h,j.width,j.height);d.translate(i.x,i.y);e=d.wijGetBBox();f=c.canvas.rect(e.x-g,e.y-g,e.width+2*g,e.height+2*g);f.attr(b.style);f.toBack();c.headerEles.push(d);c.headerEles.push(f)}},_paintFooter:function(){var g=2,c=this,m=c.options,b=m.footer,h=null,d=null,k=null,j=null,i=null,e=null,l=0,f=null;if(b.text&&b.text.length>0&&b.visible){h=b.compass;d=c._text(0,0,b.text);l=c._getRotationByCompass(h);k=a.extend(true,{},m.textStyle,{rotation:l},b.textStyle);d.attr(k);j=d.wijGetBBox();i=c._calculatePosition(h,j.width,j.height);d.translate(i.x,i.y);e=d.wijGetBBox();f=c.canvas.rect(e.x-g,e.y-g,e.width+2*g,e.height+2*g);f.attr(b.style);f.toBack();c.footerEles.push(d);c.footerEles.push(f)}},_getRotationByCompass:function(b){var a=0;if(b==="east")a=270;else if(b==="west")a=-90;return a},_paintLegend:function(){var d=this,s=d.options,f={size:{width:22,height:10}},g=2,F=s.seriesList,I=s.seriesStyles,E=F,m,o,i,G,e,b,u=d.canvasBounds,w=u.endX-u.startX,v=u.endY-u.startY,h=0,A=0,j=0,l=0,k=0,q=0,p=0,c=1,H=0,r=0,x=0,B=0,n=0,C,y,z,t,D=[];a.extend(true,f,s.legend);if(!f.visible)return;m=f.compass;o=f.orientation;h=f.size.width;A=f.size.height;if(f.text&&f.text.length){i=d._text(0,0,f.text);G=a.extend(true,{},s.textStyle,f.textStyle,f.titleStyle);i.attr(G);d.legendEles.push(i)}if(f.reversed)E=[].concat(F).reverse();a.each(E,function(l,b){b=a.extend({legendEntry:true},b);var j=I[l],k=a.extend(true,{fill:"none",opacity:1,stroke:"black"},j),g,i,c,e;if(b.legendEntry){g=d._text(0,0,b.label);i=a.extend(true,{},s.textStyle,f.textStyle);g.attr(i);d.legends.push(g);c=a.extend(k,{"stroke-width":1});e=d.canvas.rect(0,0,h,A);e.attr(c);d.legendIcons.push(e);D.push(c)}});e=d.legends.length;b=f.textMargin;if(i)j=i.wijGetBBox().height;a.each(d.legends,function(c,b){var a=b.wijGetBBox();if(a.width>l)l=a.width;if(a.height>k)k=a.height});if(m==="east"||m==="west"){if(o==="horizontal"){q=e*(l+h+g)+e*(b.left+b.right);if(q>w/2){c=Math.floor(w/2/l);if(c<1)c=1}else c=e}else if(o==="vertical"){p=k*e+j+e*(b.top+b.bottom);if(p>v)c=Math.ceil(p/v);else c=1}}else if(m==="south"||m==="north")if(o==="horizontal"){q=(l+h+g)*e+e*(b.left+b.right);if(q>w){c=Math.floor(e/q*w);if(c<1)c=1}else c=e}else if(o==="vertical"){p=k*e+j+e*(b.top+b.bottom);if(p>v/2){H=Math.floor(v-j)/2/k;c=Math.ceil(e/H)}else c=1}r=c*(l+h+g)+c*(b.left+b.right);x=k*Math.ceil(e/c)+j+Math.ceil(e/c)*(b.top+b.bottom);C=d._calculatePosition(m,r,x);y=C.x-r/2;z=C.y-x/2;t=d.canvas.rect(y-g,z-g,r+2*g,x+2*g);t.attr(f.style);t.toBack();d.legendEles.push(t);i&&i.translate(y+r/2,z+j/2);B=j;a.each(d.legends,function(i,f){var o=f.wijGetBBox(),a=d.legendIcons[i],j=y+n*(h+l+g)+(n+1)*b.left+n*b.right,m=z+B+o.height/2+b.top,p=m-a.wijGetBBox().height/2,e;a.translate(j,m-a.wijGetBBox().height/2);a.remove();a=d.canvas.rect(j,p,h,A);d.legendIcons[i]=a;e=D[i];e&&a.attr(e);f.translate(j+h+g+o.width/2,m);f.toFront();n++;if(n===c){n=0;B+=k+b.top+b.bottom}})},_hasAxes:function(){return this.widgetName==="wijpiechart"?false:true},_applyAxisText:function(h){var i=this,j=h.text,c=null,g=null,b=null,e=0,d=0,f=i.canvasBounds;if(j&&j.length>0){g=i._text(-100,-100,j);b=a.extend(true,{},i.options.textStyle,h.textStyle);g.attr(b);c=g.wijGetBBox();if(b["margin-left"])d+=parseFloat(b["margin-left"]);if(b["margin-top"])e+=parseFloat(b["margin-top"]);if(b["margin-right"])d+=parseFloat(b["margin-right"]);if(b["margin-bottom"])e+=parseFloat(b["margin-bottom"]);switch(h.compass){case"north":f.startY+=c.height+e;break;case"south":f.endY-=c.height+e;break;case"east":f.endX-=c.height+d;break;case"west":f.startX+=c.height+d}g.wijRemove()}return c},_paintChartArea:function(){var b=this,m=b.options,c=m.axis,i=m.seriesList,j=2,k=null,l=null,d=null,h=5,g=false,e=0,f=0;b._applyMargins();if(!i||i.length===0)return;a.each(i,function(c,a){if(b._isPieChart()){if(!a.data||!a.label||a.label.length===0)g=true}else if(!a.data||(!a.data.x||!a.data.y)&&!a.data.xy)g=true});if(g)return;if(b._hasAxes()){if(b.innerState.axisInfo){b.axisInfo=b.innerState.axisInfo;b.canvasBounds=b.innerState.canvasBounds}else{k=b._applyAxisText(c.x,{});l=b._applyAxisText(c.y,{});b.axisInfo={x:{id:"x",tprec:0,isTime:false,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:k,axisTextOffset:j,autoMax:true,autoMin:true,autoMajor:true,autoMinor:true},y:{id:"y",tprec:0,isTime:false,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:l,axisTextOffset:j,autoMax:true,autoMin:true,autoMajor:true,autoMinor:true}};d=b._getDataExtreme();if(c.x.autoMin&&b.axisInfo.x.autoMin)c.x.min=d.txn;else if(c.x.min&&b._isDate(c.x.min))c.x.min=b._toOADate(c.x.min);if(c.x.autoMax&&b.axisInfo.x.autoMax)c.x.max=d.txx;else if(c.x.max&&b._isDate(c.x.max))c.x.max=b._toOADate(c.x.max);if(c.y.autoMin&&b.axisInfo.y.autoMin)c.y.min=d.tyn;else if(c.y.min&&b._isDate(c.y.min))c.y.min=b._toOADate(c.y.min);if(c.y.autoMax&&b.axisInfo.y.autoMax)c.y.max=d.tyx;else if(c.y.max&&b._isDate(c.y.max))c.y.max=b._toOADate(c.y.max);do{f=b._autoPosition(b.axisInfo,c,"y");e=b._autoPosition(b.axisInfo,c,"x");if(f===b.axisInfo.y.offset&&e===b.axisInfo.x.offset){h=0;break}if(f!==b.axisInfo.y.offset){b.axisInfo.y.offset=f;b.axisInfo.y.vOffset=e}if(e!==b.axisInfo.x.offset){b.axisInfo.x.offset=e;b.axisInfo.x.vOffset=f}h--}while(h>0);b._adjustPlotArea(c.x,b.axisInfo.x);b._adjustPlotArea(c.y,b.axisInfo.y);b.innerState.axisInfo=b.axisInfo;b.innerState.canvasBounds=b.canvasBounds}b._paintAxes();b._paintPlotArea()}else b._paintPlotArea()},_adjustPlotArea:function(c,a){var b=this.canvasBounds;c.max=a.max;c.min=a.min;switch(c.compass){case"north":b.startY+=a.offset;break;case"south":b.endY-=a.offset;break;case"east":b.endX-=a.offset;break;case"west":b.startX+=a.offset}},_autoPosition:function(b,a,c){return this._autoPositionCartesianAxis(b,a,c)},_autoPositionCartesianAxis:function(g,j,d){var i=this,m=null,c=i.canvasBounds,l=j[d].compass,k=d==="x"?"y":"x",a=j[k].origin,e=g[k].max,f=g[k].min,h=0,b;if(a!==null&&i._isDate(a))a=i._toOADate(a);i._calculateParameters(g[d],j[d]);m=i._getMaxExtents(g[d],j[d]);switch(l){case"north":case"south":b=m.height;g[d].maxExtent=b;if(a!==null&&a>=f&&a<=e){if(l==="south")h=(a-f)/(e-f)*(c.endY-c.startY);else h=(e-a)/(e-f)*(c.endY-c.startY);b-=h;if(b<0)b=0}return b;case"east":case"west":b=m.width;g[d].maxExtent=b;if(a!==null&&a>=f&&a<=e){if(l==="west")h=(a-f)/(e-f)*(c.endX-c.startX);else h=(e-a)/(e-f)*(c.endX-c.startX);b-=h;if(b<0)b=0}return b}},_getMaxExtents:function(b,c,n){var e=this,o=e.options,i=null,f={width:0,height:0},t=b.min,s=b.max,r=b.isTime,d=c.annoFormatString,q=o.is100Percent,k=0,p=c.compass,h=c.labels,g,l=false,m=e.canvasBounds,j;b.majorTickRect=e._getTickRect(b,c,true,true,n);b.minorTickRect=e._getTickRect(b,c,false,true,n);i=e._getMajorTickValues(b,c);if(!d||d.length===0)d=b.annoFormatString;g=a.extend(true,{},o.textStyle,c.textStyle,h.style);l=typeof g.rotation!=="undefined";g=a.extend(true,g,b.textStyle);j=m.endX-m.startX-b.vOffset-b.axisTextOffset;if(i&&i.length){j=j/(i.length-1);a.each(i,function(o,a){var i,m,n;if(a<t||a>s)return true;if(c.annoMethod==="valueLabels"){if(a<0)return true;if(k>=c.valueLabels.length)return false;a=c.valueLabels[k];if(d&&d.length)a=Globalize.format(a,d)}else if(c.annoMethod==="values")if(d&&d.length){if(r)a=e._fromOADate(a);a=Globalize.format(a,d)}else if(q&&b.id==="y")a=Globalize.format(a,"p0");if(h.width)i=e.canvas.wij.wrapText(-100,-100,a,h.width,h.textAlign,g);else i=e._text(-100,-100,a).attr(g);m=i.wijGetBBox();if(!e._isVertical(p)&&!l&&c.annoMethod==="valueLabels"){if(m.width>j)if(!i.attr().rotation){i.attr({rotation:-45});g.rotation=-45;b.textStyle={rotation:-45};m=i.wijGetBBox()}if(o===0&&i.attr().rotation&&i.attr().rotation===-45){n=i.clone();n.attr({rotation:0});m=n.wijGetBBox();if(Math.sqrt(2)*m.height>j){i.attr({rotation:-90});g.rotation=-90;b.textStyle={rotation:-90}}n.wijRemove();m=i.wijGetBBox()}}i.wijRemove();if(m.width>f.width)f.width=m.width;if(m.height>f.height)f.height=m.height;k++})}if(f.width<h.width)f.width=h.width;b.labelWidth=f.width;return f},_getMajorTickValues:function(a,b){var c=[];if(b.annoMethod==="valueLabels"){c=this._getSortedDataValues(a,b);return c}c=this._getTickValues(a.max,a.min,b.unitMajor,a.tprec,!a.isTime,b.autoMajor);return c},_getSortedDataValues:function(f,d){var c=this,b=[],e=d.valueLabels;a.each(e,function(d,a){if(c._isDate(a))b.push(c._toOADate(a));else if(typeof a==="number")b.push(a);else b.push(d)});return b},_getMinorTickValues:function(a,b){var c=[];c=this._getTickValues(a.max,a.min,b.unitMinor,a.tprec,!a.isTime,b.autoMinor);return c},_getTickValues:function(e,a,b,f,o,l){var h=this,i=[],n=a,d=0,g=0,m=0,k=0,c=0,j=0;try{if(b===0)i=[e,a];else{if(l){if(f+1<0)f=-1;else if(f+1>15)f=14;j=h.round(h._signedCeiling(a/b)*b,f+1);if(j<e)a=j;m=parseInt(h.round(e/b,5),10);k=parseInt(h.round(a/b,5),10);c=parseInt(m-k+1,10);if(c>1){g=k*b;if(g<a){c--;a+=b}g=a+(c-1)*b;if(g>e)c--}if(c<1){c=2;a=n;b=e-a}}else{c=parseInt((e-a)/b+1,10);if(c>1){g=a+(c-1)*b;if(g>e)c--}if(c<1){c=2;b=e-a}}for(d=0;d<c;d++)if(o)if(l)i[d]=h.round(a+d*b,f+1);else i[d]=a+d*b;else i[d]=a+d*b}}catch(p){}return i},_getTickRect:function(k,d,j,e){var c=d.compass,f=0,a=null,h=3,i=2,g=2,b={x:0,y:0,width:0,height:0};if(j){a=d.tickMajor.position;f=h*d.tickMajor.factor}else{a=d.tickMinor.position;f=i*d.tickMinor.factor}if(a==="none"||a==="inside"&&e)f=0;if(c==="east"||c==="west"){b={x:0,y:-1,width:f*g,height:g};if(c==="east"&&(a==="outside"||a==="cross"&&e)||c==="west"&&a==="inside")b.width+=2;else if(!e){if(a==="corss")b.width<<=1;b.width+=2}}else{b={x:-1,y:0,width:g,height:f*g};if(c==="south"&&(a==="outside"||a==="corss"&&e)||c==="north"&&a==="inside")b.height+=2;else if(!e){if(a==="cross")b.height<<=1;b.height+=2}}return b},_applyMargins:function(){var c=this,b=c.options,a=c.canvasBounds;a.startX+=b.marginLeft;a.endX-=b.marginRight;a.startY+=b.marginTop;a.endY-=b.marginBottom},_paintAxes:function(){var a=this,h=a.options.axis,g=a.axisInfo,b=h.x,c=h.y,e=g.x,f=g.y,d;d=a._paintAxis(b,e);c.origin!==null&&a._translateAxisIfNeeded(d,b.compass,c.origin,c.compass,f.max,f.min);d=a._paintAxis(c,f);b.origin!==null&&a._translateAxisIfNeeded(d,c.compass,b.origin,b.compass,e.max,e.min)},_translateAxisIfNeeded:function(h,i,l,j,e,f){var g=this,k=j==="west"||j==="east",b=g.canvasBounds,c=l,d;if(g._isDate(c))c=g._toOADate(c);if(!k){if(i==="west")d=(c-f)/(e-f)*(b.endX-b.startX);else d=(c-e)/(e-f)*(b.endX-b.startX);a.each(h,function(b,a){a.translate(d,0)})}else{if(i==="south")d=(f-c)/(e-f)*(b.endY-b.startY);else d=(e-c)/(e-f)*(b.endY-b.startY);a.each(h,function(b,a){a.translate(0,d)})}},_paintAxis:function(b,d){var g=this,A=g.options,c=g.canvasBounds,e={x:0,y:0},f={x:0,y:0},q=b.compass,k=2,o=true,t=null,n=[],u=[],v=[],l=d.max,m=d.min,I=b.unitMajor,J=b.unitMinor,H=b.tickMajor.position,y=b.tickMinor.position,z=d.maxExtent,B=b.tickMajor.style,C=b.tickMinor.style,D=d.majorTickRect,E=d.minorTickRect,w=d.axisTextOffset,F=b.gridMajor,G=b.gridMinor,j=b.labels,r=0,x=[],s=0,h=b.annoFormatString,p=null,i=[];if(!h||h.length===0)h=d.annoFormatString;n=g._getMajorTickValues(d,b);if(y!=="none"){u=g._getMinorTickValues(d,b);v=g._resetMinorTickValues(u,n)}switch(q){case"south":e.x=c.startX;e.y=c.endY;f.x=c.endX;f.y=c.endY;o=false;break;case"north":e.x=c.startX;e.y=c.startY-k;f.x=c.endX;f.y=c.startY-k;o=false;break;case"east":e.x=c.endX;e.y=c.endY;f.x=c.endX;f.y=c.startY;break;case"west":e.x=c.startX-k;e.y=c.endY;f.x=c.startX-k;f.y=c.startY}if(b.visible){t=g.canvas.wij.line(e.x,e.y,f.x,f.y).attr(b.style);g.axisEles.push(t);i.push(t)}a.each(n,function(v,k){var c=k,u=d.isTime,t=A.is100Percent,o,n;if(k<m||k>l)return true;if(b.annoMethod==="valueLabels"){if(k<0)return true;if(s>=b.valueLabels.length)return false;c=b.valueLabels[s];if(h&&h.length)c=Globalize.format(c,h)}else if(b.annoMethod==="values")if(h&&h.length){if(u)c=g._fromOADate(k);c=Globalize.format(c,h)}else if(t&&d.id==="y")c=Globalize.format(k,"p0");p=a.extend(true,{},A.textStyle,b.textStyle,j.style,d.textStyle);o=g._paintMajorMinor(l,m,k,H,I,D,q,e,f,z,w,B,c,F,b.textVisible,p,j.textAlign,j.width?d.labelWidth:null);if(o){if(o.elements)i=i.concat(o.elements);n=o.textInfo}if(n){x.push(n);if(r<n.len)r=n.len}s++});!j.width&&a.each(x,function(d,c){var b=c.text,a=(c.len-r)/2;a=j.textAlign==="near"?a*-1:a;if(o)b.translate(a,0);else b.translate(0,a)});a.each(v,function(h,c){var a;if(c>m&&c<l){a=g._paintMajorMinor(l,m,c,y,J,E,q,e,f,z,w,C,null,G,b.textVisible,p,j.textAlign,j.width?d.labelWidth:null);if(a&&a.elements)i=i.concat(a.elements)}});b.text&&b.text.length>0&&i.push(g._paintAxisText(b,d));return i},_paintAxisText:function(d,f){if(!d.text||d.text.length===0)return;var j=this,z=d.text,p=d.compass,x=d.alignment,l=j.canvasBounds,m=l.startX,n=l.startY,q=l.endX,r=l.endY,g=m,h=n,c=f.textBounds,o=j._isVertical(p),k=f.axisTextOffset,s=f.majorTickRect,y=d.tickMajor.position,e=o?s.width:s.height,b=null,i=null,w=0,v=0,u=0,t=0;b=a.extend(true,{},j.options.textStyle,d.textStyle);if(b["margin-top"])w=parseFloat(b["margin-top"]);if(b["margin-left"])v=parseFloat(b["margin-left"]);if(b["margin-right"])u=parseFloat(b["margin-right"]);if(b["margin-bottom"])t=parseFloat(b["margin-bottom"]);if(y==="cross")e=e/2;else if(y==="inside")e=0;if(o){switch(x){case"near":h=r-c.width/2;break;case"center":h=(n+r)/2;break;case"far":h=n+c.width/2}if(p==="west")g=m-(f.offset+k+e+c.height/2+u);else g=q+f.offset+k+e+c.height/2+v}else{switch(x){case"near":g=m+c.width/2;break;case"center":g=(m+q)/2;break;case"far":g=q-c.width/2}if(p==="north")h=n-(f.offset+k+e+c.height/2+t);else h=r+f.offset+k+e+c.height/2+w}i=j._text(g,h,z);j.axisEles.push(i);i.attr(b);o&&i.rotate(-90);return i},_resetMinorTickValues:function(a,d){for(var b=0,c=0,f=null,e=null,b=a.length-1;b>=0;b--){f=a[b];for(c=d.length-1;c>=0;c--){e=d[c];f===e&&a.splice(b,1)}}return a},_paintMajorMinor:function(G,u,H,e,J,b,p,r,D,m,h,x,A,t,I,C,B,i){var f=this,c=r.x,d=r.y,j=-1,l=-1,o=true,k=f.canvasBounds,E=null,q=null,y=[],s=[],n=null,z={"stroke-width":2},g=null,w=null,F={},v=[];switch(p){case"south":if(e==="inside")d-=b.height;else if(e==="cross")d-=b.height/2;if(i)l=d+h+b.height;else l=d+h+b.height+m/2;o=false;break;case"west":if(e==="outside")c-=b.width;else if(e==="cross")c-=b.width/2;if(i)j=c-(h+m);else j=c-(h+m/2);break;case"north":if(e==="outside")d-=b.height;else if(e==="cross")d-=b.height/2;if(i)l=d-(h+m);else l=d-(h+m/2);o=false;break;case"east":if(e==="inside")c-=b.width;else if(e==="cross")c-=b.width/2;if(i)j=c+h+b.width;else j=c+h+b.width+m/2}if(o){d+=(H-u)/(G-u)*(D.y-r.y);if(t.visible)if(d!==k.startY&&p==="east"||d!==k.endY&&p==="west"){s=["M",k.startX,d,"H",k.endX];n=f.canvas.path(s.concat(" "));n.attr(t.style);f.axisEles.push(n)}l=d;if(e!=="none"){y=["M",c,d,"h",b.width];x["stroke-width"]=b.height}}else{c+=(H-u)/(G-u)*(D.x-r.x);if(t.visible)if(c!==k.startX&&p==="south"||c!==k.endX&&p==="north"){s=["M",c,k.startY,"V",k.endY];n=f.canvas.path(s.concat(" "));n.attr(t.style);f.axisEles.push(n)}if(i)j=c-i/2;else j=c;if(e!=="none"){y=["M",c,d,"v",b.height];x["stroke-width"]=b.width}}if(e!=="none"){q=f.canvas.path(y.concat(" "));z=a.extend(z,x);q.attr(z);f.axisEles.push(q);v.push(q)}if(A!==null){if(i){g=f.canvas.wij.wrapText(j,l,A.toString(),i,B,C);o&&g.translate(0,-g.getBBox().height/2)}else{g=f._text(j,l,A.toString());g.attr(C)}f.axisEles.push(g);v.push(g);!I&&g.hide();if(B!=="center"){w=g.getBBox();E={text:g,len:o?w.width:w.height}}}F={textInfo:E,elements:v};return F},_paintPlotArea:function(){},_paintChartLabels:function(){var c=this,b=c.options.chartLabels;b&&b.length&&a.each(b,function(e,b){var d;b=a.extend(true,{compass:"east",attachMethod:"coordinate",attachMethodData:{seriesIndex:-1,pointIndex:-1,x:-1,y:-1},offset:0,visible:false,text:"",connected:false},b);if(b.visible){d=c._getChartLabelPointPosition(b);if(typeof d.x!=="number"||typeof d.y!=="number")return false;c._setChartLabel(b,d)}})},_getChartLabelPointPosition:function(){},_setChartLabel:function(d,e,o,l){var c=this,n=d.compass,k=c.options,m=a.extend(true,{},k.textStyle,k.chartLabelStyle),f=c._text(0,0,d.text).attr(m),h=d.offset,i=0,j=0,b=null,g=null;c.chartLabelEles.push(f);b=c._getCompassTextPosition(n,f.wijGetBBox(),h,e,o);if(h&&d.connected){g=c.canvas.path("M"+e.x+" "+e.y+"L"+b.endPoint.x+" "+b.endPoint.y);g.attr(l);c.chartLabelEles.push(g)}i=b.endPoint.x+b.offsetX;j=b.endPoint.y+b.offsetY;f.translate(i,j).toFront()},_getCompassTextPosition:function(g,b,h,f,a){var c=0,d=0,e={x:0,y:0};switch(g.toLowerCase()){case"east":a=0;break;case"west":a=180;break;case"north":a=90;break;case"south":a=270;break;case"northeast":a=45;break;case"northwest":a=135;break;case"southeast":a=315;break;case"southwest":a=225}if(a>=0&&a<45/2||a>675/2&&a<360)c=b.width/2;else if(a>=45/2&&a<135/2){c=b.width/2;d=b.height/-2}else if(a>=135/2&&a<225/2)d=b.height/-2;else if(a>=225/2&&a<315/2){c=b.width/-2;d=b.height/-2}else if(a>=315/2&&a<405/2)c=b.width/-2;else if(a>=405/2&&a<495/2){c=b.width/-2;d=b.height/2}else if(a>=495/2&&a<585/2)d=b.height/2;else{c=b.width/2;d=b.height/2}e=this.canvas.wij.getPositionByAngle(f.x,f.y,h,a);return{endPoint:e,offsetX:c,offsetY:d}},_getXSortedPoints:function(e){var b=e.data.x,f=[].concat(b),g=[].concat(e.data.y),d=[],c=b;if(b.length===0)return;function h(a,b){return a-b}if(typeof b[0]==="number")c=[].concat(b).sort(h);a.each(c,function(c,b){a.each(f,function(e,a){if(b===a){if(typeof a!=="number")a=c;d.push({x:a,y:g[e]});f.splice(e,1);g.splice(e,1);return false}})});return d},_bindLiveEvents:function(){},_unbindLiveEvents:function(){},_isBarChart:function(){return false},_isPieChart:function(){return false},_calculateParameters:function(c,f){var d=this,b=f.max,a=f.min,n=f.autoMax&&c.autoMax,o=f.autoMin&&c.autoMin,q=f.autoMajor&&c.autoMajor,r=f.autoMinor&&c.autoMinor,h=null,k=null,p=f.annoMethod==="valueLabels",g=0,i=0,j=0,e=0,l=0,m=c.isTime;if(n&&b!==Number.MIN_VALUE)if(c.id!=="x"&&d._isBarChart())if(b<0&&.5*(b-a)>-b)b=0;if(o&&a!==Number.MAX_VALUE)if(c.id!=="x"&&d._isBarChart())if(a>0&&.5*(b-a)>a)a=0;if(b===a){if(a!==0)a-=1;b+=1}e=b-a;if(m){h=f.annoFormatString;if(!h||h.length===0){h=d._getTimeDefaultFormat(b,a);c.annoFormatString=h}l=d._niceTimeUnit(0,h)}k=d._nicePrecision(e);c.tprec=k;if(n)if(m){i=d._roundTime(b,l,true);if(i<b)b=i+l;else b=i}else{i=d._precCeil(-k,b);if(typeof i==="number")b=i}if(o)if(m){j=d._roundTime(a,l,false);if(j>a)a=j-l;else a=j}else{j=d._precFloor(-k,a);if(typeof j==="number")a=j}c.max=b;c.min=a;c.annoFormatString=h;c.tinc=l;if(q||r){e=b-a;d._calculateMajorMinor(f,c);g=f.unitMajor;if(n&&g!==0&&!m&&!p){e=b-parseInt(b/g,10)*g;if(e!==0){b+=g-e;b=d._precCeil(-k,b)}}if(o&&g!==0&&!m&&!p){e=a-parseInt(a/g,10)*g;if(e!==0){if(e<0)e+=g;a-=Math.abs(e);a=d._precFloor(-k,a)}}}c.max=b;c.min=a},_roundTime:function(j,f,d){var b=this,c=f,e=b._fromOADate(j),a,g,i,h;if(c>0){a={year:e.getFullYear(),month:e.getMonth(),day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()};if(c<b._tmInc.minute){a.second=b._tround(a.second,c,d);return b._getTimeAsDouble(a)}a.second=0;if(c<b._tmInc.hour){c/=b._tmInc.minute;a.minute=b._tround(a.minute,c,d);return b._getTimeAsDouble(a)}a.minute=0;if(c<b._tmInc.day){c/=b._tmInc.hour;a.hour=b._tround(a.hour,c,d);return b._getTimeAsDouble(a)}a.hour=0;if(c<b._tmInc.month){c/=b._tmInc.day;a.day=b._tround(a.day,c,d);return b._getTimeAsDouble(a)}a.day=1;if(c<b._tmInc.year){c/=b._tmInc.month;a.month=b._tround(a.month,c,d);return b._getTimeAsDouble(a)}a.month=0;c/=b._tmInc.year;a.year=b._tround(a.year,c,d);return b._getTimeAsDouble(a)}else{g=e;i=g-c;h=parseInt(i/f,10)*f;if(d&&h!==i)h+=f;g=c+h;return g}},_tround:function(c,a,d){var b=parseInt(c/a*a,10);if(d&&b!==c)b+=parseInt(a,10);return b},_getTimeAsDouble:function(a){var d=0,c=0,b=null;if(a.day<1){c=-1-a.day;a.day=1}else if(a.day>28){c=a.day-28;a.day=28}if(a.month<0){d=-1-a.day;a.month=0}else if(a.month>11){d=a.month-11;a.month=11}b=new Date(a.year,a.month,a.day,a.hour,a.minute,a.second);b.setDate(b.getDate()+c);b.setMonth(b.getMonth()+d);return this._toOADate(b)},_getTimeDefaultFormat:function(d,e){var c=this,b=d-e,a="s";if(b>2*c._tmInc.year)a="yyyy";else if(b>c._tmInc.year)a="MMM yy";else if(b>3*c._tmInc.month)a="MMM";else if(b>2*c._tmInc.week)a="MMM d";else if(b>2*c._tmInc.day)a="ddd d";else if(b>c._tmInc.day)a="ddd H:mm";else if(b>c._tmInc.hour)a="H:mm";else if(b>=1e3)a="H:mm:ss";return a},_niceTimeUnit:function(c,b){var d=this,a=c;a=d._niceTimeSpan(a,b);return a},_niceTimeSpan:function(f,e){var a=this,c=a._manualTimeInc(e),d=0,b=0;d=Math.ceil(f);if(d===0)return a._timeSpanFromTmInc(c);b=1;if(c<a._tmInc.minute){if(d<a._tmInc.minute){b=a._getNiceInc([1,2,5,10,15,30],d,c);if(b!==0)return b}c=a._tmInc.minute}if(c<a._tmInc.hour){if(d<a._tmInc.hour){b=a._getNiceInc([1,2,5,10,15,30],d,c);if(b!==0)return b}c=a._tmInc.hour}if(c<a._tmInc.day){if(d<a._tmInc.day){b=a._getNiceInc([1,3,6,12],d,c);if(b!==0)return b}c=a._tmInc.day}if(c<a._tmInc.month){if(d<a._tmInc.month){b=a._getNiceInc([1,2,7,14],d,c);if(b!==0)return b}c=a._tmInc.month}if(c<a._tmInc.year){if(d<a._tmInc.year){b=a._getNiceInc([1,2,3,4,6],d,c);if(b!==0)return b}c=a._tmInc.year}b=100*a._tmInc.year;if(d<b){b=a._getNiceInc([1,2,5,10,20,50],d,c);if(b===0)b=100*a._tmInc.year}return b},_getNiceInc:function(c,f,d){for(var b=0,a=0,e=c.length,b=0;b<e;b++){a=c[b]*d;if(f<=a)return a}return 0},_timeSpanFromTmInc:function(a){var b=1e3,d=a,c=1;if(a!==this._tmInc.maxtime)if(a>this._tmInc.tickf1)b=a;else{a+=7;while(d>0){c*=10;d--}b=c}return b},_manualTimeInc:function(a){var c=this,b=c._tmInc.second;if(!a||a.length===0)return b;if(a.indexOf("s")>=0)b=c._tmInc.second;else if(a.indexOf("m")>=0)b=c._tmInc.minute;else if(a.indexOf("h")>=0||a.indexOf("H")>=0)b=c._tmInc.hour;else if(a.indexOf("d")>=0)b=c._tmInc.day;else if(a.indexOf("M")>=0)b=c._tmInc.month;else if(a.indexOf("y")>=0)b=c._tmInc.year;return b},_tmInc:{tickf7:-7e3,tickf6:-6e3,tickf5:-5e3,tickf4:-4e3,tickf3:-3e3,tickf2:-2e3,tickf1:-1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:26784e5,year:31536e6,maxtime:2147483647},_niceTickNumber:function(a){if(parseFloat(a)===0)return a;else if(a<0)a=-a;var e=Math.log(a)/Math.log(10),d=parseInt(this._signedFloor(e),10),c=a/Math.pow(10,d),b=10;if(c<=1)b=1;else if(c<=2)b=2;else if(c<=5)b=5;return b*Math.pow(10,d)},_niceNumber:function(c,d,e){if(parseFloat(c)===0)return c;else if(c<0)c=-c;var b=c/Math.pow(10,d),a=10;if(e){if(b<1.5)a=1;else if(b<3)a=2;else if(b<7)a=5}else if(b<=1)a=1;else if(b<=2)a=2;else if(b<=5)a=5;return a*Math.pow(10,d)},_nicePrecision:function(a){if(a<=0||typeof a!=="number")return 0;var c=Math.log(a)/Math.log(10),b=parseInt(this._signedFloor(c),10),d=a/Math.pow(10,b);if(d<3)b=-b+1;return b},_precCeil:function(d,c){var b=Math.pow(10,d),a=c/b;a=Math.ceil(a);return a*b},_precFloor:function(d,c){var b=Math.pow(10,d),a=c/b;a=Math.floor(a);return a*b},_signedCeiling:function(a){return a<0?Math.floor(a):Math.ceil(a)},_signedFloor:function(a){return a<0?Math.ceil(a):Math.floor(a)},_getDataExtreme:function(){var a={txx:0,txn:0,tyx:0,tyn:0};this._getDataExtremes(a);if(a.txn>a.txx){a.txn=0;a.txx=1}return a},_getDataExtremes:function(b){var g=this,i=g.options,j=i.seriesList,l=i.stacked,k=i.is100Percent,e=i.axis,f=g.axisInfo,d=[],c=[],h=[];if(!j||j.length===0)return b;a.each(j,function(m,o){var e=o.data,k=0,i=0,j=[].concat(e.xy),n=j.length,f,h;d=[].concat(e.x);c=[].concat(e.y);if(e.xy&&n){d=[];c=[];while(i<n){d[k]=j[i];c[k]=j[i+1];i+=2;k++;e.x=d;e.y=c}}else if(!e.x){d=[];a.each(c,function(a){d.push(a)});e.x=d}l&&m>0&&a.each(c,function(a){if(a===0)return true;c[a]+=c[a-1]});f=g._getMinMaxValue(d);h=g._getMinMaxValue(c);if(m===0){b.txx=f.max;b.txn=f.min;b.tyx=h.max;b.tyn=h.min}else{if(b.txx<f.max)b.txx=f.max;if(b.txn>f.min)b.txn=f.min;if(b.tyx<h.max)b.tyx=h.max;if(b.tyn>h.min)b.tyn=h.min}});if(k){b.tyx=1;b.tyn=0}if(d.length)if(g._isDate(d[0]))f.x.isTime=true;else if(typeof d[0]!=="number"){a.each(d,function(b,a){h.push(a)});e.x.annoMethod="valueLabels";e.x.valueLabels=h;e.x.max=d.length-1;e.x.min=0;e.x.unitMajor=1;e.x.unitMinor=.5;f.x.autoMax=false;f.x.autoMin=false;f.x.autoMajor=false;f.x.autoMinor=false}if(c.length)if(g._isDate(c[0]))f.y.isTime=true;else if(typeof c[0]!=="number"){a.each(c,function(d,c){var b=e.y.annoFormatString,a=c;if(b&&b.length>0)a=Globalize.format(a,b);else a=a.toString();h.push(a)});e.y.annoMethod="valueLabels";e.y.valueLabels=h;e.x.max=c.length-1;e.x.min=0;e.y.unitMajor=1;e.x.unitMinor=.5;f.y.autoMax=false;f.y.autoMin=false;f.y.autoMajor=false;f.y.autoMinor=false}return b},_isDate:function(a){return typeof a==="object"&&a.constructor===Date},_getMinMaxValue:function(b){var d=this,a={min:0,max:0},c=0;if(!b.length)return;if(typeof b[0]!=="number")if(d._isDate(b[0])){a.min=b[0];a.max=b[0]}else{a.min=0;a.max=b.length-1;return a}else{a.min=b[0];a.max=b[0]}for(c=0;c<b.length;c++)if(b[c]<a.min)a.min=b[c];else if(b[c]>a.max)a.max=b[c];if(d._isDate(a.min)){a.min=d._toOADate(a.min);a.max=d._toOADate(a.max)}return a},_toOADate:function(b){return b-new Date(1900,0,1)+2*this._tmInc.day},_fromOADate:function(a){return new Date(a-2*this._tmInc.day+ +new Date(1900,0,1))},_isVertical:function(a){return a==="west"||a==="east"},_calculateMajorMinor:function(f,d){var b=this,A=b.options,n=b.canvasBounds,y=f.autoMajor,z=f.autoMinor,p=d.max,q=d.min,v=d.isTime,x=d.tinc,r=d.annoFormatString,s=null,t=null,g=null,h=null,l=null,k=null,o=null,j=null,m=null,e=p-q,w=0,u=0,i=0,c=0;if(y){m=a.extend(true,{},A.textStyle,f.textStyle,f.labels.style);if(v){s=Globalize.format(b._fromOADate(p),r);t=Globalize.format(b._fromOADate(q),r);l=b._text(-1e3,-1e3,s).attr(m);k=b._text(-1e3,-1e3,t).attr(m);g=l.wijGetBBox();h=k.wijGetBBox();l.wijRemove();k.wijRemove()}else{o=b._nicePrecision(e);j=o+1;if(j<0||j>15)j=0;l=b._text(-1e3,-1e3,b.round(p,j)).attr(m);k=b._text(-1e3,-1e3,b.round(q,j)).attr(m);g=l.wijGetBBox();h=k.wijGetBBox();l.wijRemove();k.wijRemove()}if(g.width<h.width)g.width=h.width;if(g.height<h.height)g.height=h.height;if(!b._isVertical(f.compass)){w=n.endX-n.startX-d.vOffset-d.axisTextOffset;c=w/g.width;if(Number.POSITIVE_INFINITY===c)i=0;else i=parseInt(c,10)}else{u=n.endY-n.startY-d.vOffset-d.axisTextOffset;c=u/g.height;if(Number.POSITIVE_INFINITY===c)i=0;else i=parseInt(c,10)}c=e;if(i>0){e/=i;if(v)if(e<x)c=x;else c=b._niceTimeUnit(e,d.annoFormatString);else{d.tprec=b._nicePrecision(e);c=b._niceNumber(2*e,-o,true);if(c<e)c=b._niceNumber(e,-o+1,false);if(c<e)c=b._niceTickNumber(e)}}f.unitMajor=c}if(z&&f.unitMajor&&!isNaN(f.unitMajor))f.unitMinor=f.unitMajor/2},_getScaling:function(b,d,e,c){var a=d-e;if(a===0)a=1;if(b)a=-a;return c/a},_getTranslation:function(d,b,e,f,c){var a=0;if(d){a=b.y;a-=c*e}else{a=b.x;a-=c*f}return a},_isSVGElem:function(a){var b="http://www.w3.org/2000/svg";return a.nodeType===1&&a.namespaceURI===b},_addClass:function(d,b){var c=this;b=b||"";a.each(d,function(){if(c._isSVGElem(this)){var d=this;a.each(b.split(/\s+/),function(e,c){var b=d.className?d.className.baseVal:d.getAttribute("class");if(a.inArray(c,b.split(/\s+/))===-1){b+=(b?" ":"")+c;if(d.className)d.className.baseVal=b;else d.setAttribute("class",b)}})}else a(this).addClass(b)})}})})(jQuery);
(function(a){"use strict";a.widget("wijmo.wijbarchart",a.wijmo.wijchartcore,{options:{horizontal:true,stacked:false,is100Percent:false,clusterOverlap:0,clusterWidth:85,clusterRadius:0,clusterSpacing:0,animation:{enabled:true,duration:400,easing:">"},seriesTransition:{enabled:true,duration:400,easing:">"},mouseDown:null,mouseUp:null,mouseOver:null,mouseOut:null,mouseMove:null,click:null},_create:function(){var d=["0-#8ac4c0-#77b3af","0-#73a19e-#67908e","0-#4f687b-#465d6e","0-#69475b-#5d3f51","0-#7a3b3f-#682e32","0-#9d5b5b-#8c5151","0-#e5a36d-#ce9262","0-#e6cc70-#ceb664","0-#8ec858-#7fb34f","0-#3a9073-#2a7b5f","0-#6c88e3-#6079cb","0-#6cb4e3-#60a0cb"],b=this,c=b.options;c.horizontal&&a.extend(true,c.axis,{x:{compass:"west"},y:{compass:"south"}});a.extend(true,{compass:"east"},c.hint);a.each(c.seriesStyles,function(b,a){if(!a.fill)a.fill=d[b]});b.bars=[];b.animatedBars=[];b.chartLabels=[];a.wijmo.wijchartcore.prototype._create.apply(b,arguments);b.chartElement.addClass("wijmo-wijbarchart")},_setOption:function(c,b){c==="horizontal"&&!b&&a.extend(true,this.options.axis,{x:{compass:"south"},y:{compass:"west"}});a.wijmo.wijchartcore.prototype._setOption.apply(this,arguments)},destroy:function(){var b=this;b.chartElement.removeClass("wijmo-wijbarchart ui-helper-reset");a.wijmo.wijchartcore.prototype.destroy.apply(this,arguments);if(b.aniBarsAttr&&b.aniBarsAttr.length){a.each(b.aniBarsAttr,function(b,a){a=null});b.aniBarsAttr=null}},_isBarChart:function(){return true},getBar:function(a){return this.bars[a]},_paint:function(){var c=this,d=c.options,b=d.seriesList,e=false,g,f;if(b.length&&b[0].data&&b[0].data.x&&b[0].data.x.length){g=b[0].data.x[0];if(c._isDate(g))e=true}if(e){c.seriesList=b;f=c._cloneSeriesList(b,d.axis.x.annoFormatString);d.seriesList=f}a.wijmo.wijchartcore.prototype._paint.apply(c,arguments);if(e)d.seriesList=c.seriesList},_cloneSeriesList:function(d,b){var c=[];a.each(d,function(f,e){var d=a.extend(true,{},e);d.data&&d.data.x&&d.data.x.length&&a.each(d.data.x,function(e,c){var a;if(b&&b.length)a=Globalize.format(c,b);else a=c.toString();d.data.x[e]=a});c.push(d)});return c},_clearChartElement:function(){var b=this;if(b.bars&&b.bars.length){a.each(b.bars,function(b,a){if(a.shadow){a.shadow.wijRemove();a.shadow=null}if(a){a.wijRemove();a=null}});b.bars=[]}if(b.animatedBars&&b.animatedBars.length){a.each(b.animatedBars,function(b,a){if(a){a.stop();a.wijRemove();a=null}});b.animatedBars=[]}if(b.chartLabels&&b.chartLabels.length){a.each(b.chartLabels,function(b,a){if(a){a.wijRemove();a=null}});b.chartLabels=[]}a.wijmo.wijchartcore.prototype._clearChartElement.apply(b,arguments)},_adjustToLimits:function(a,c,b){return a<c?c:a>b?b:a},_transformPoints:function(c,d,e,f,g,b){a.each(b,function(j,a){var h=a.x,i=a.y,b=0;a.x=d*h+f;a.y=e*i+g;if(c){b=a.x;a.x=a.y;a.y=b}});return b},_paintPlotArea:function(){var a=this,c=a.options,b=c.horizontal,s=c.stacked,i=[].concat(c.seriesList),j=i.length,p=[].concat(c.seriesStyles.slice(0,j)),o=[].concat(c.seriesHoverStyles.slice(0,j)),h=a.canvasBounds,g={x:h.startX,y:h.startY},n=h.endX-g.x,k=h.endY-g.y,e=c.axis.x,f=c.axis.y,d,l=a._getScaling(b,e.max,e.min,b?k:n),m=a._getScaling(!b,f.max,f.min,b?n:k),q=a._getTranslation(b,g,e.max,e.min,l),r=a._getTranslation(!b,g,f.max,f.min,m);if(b&&!s){i.reverse();p.reverse();o.reverse()}if(j===0)return;d=a._paintClusters(i,p,o,{min:e.min,max:e.max,late:q,scale:l},{min:f.min,max:f.max,late:r,scale:m},n,k,g);a.chartElement.data("plotInfos",{xscale:l,xlate:q,yscale:m,ylate:r,rects:d.rects});a._playAnimation(d.animatedBars);a.bars=d.bars;a.animatedBars=d.animatedBars;a.chartLabels=d.chartLabels},_paintClusters:function(f,w,s,x,y,A,p,u){var b=this,e=b.options,k=e.stacked,d=e.clusterOverlap/100,v=e.clusterWidth/100,m=1,t=e.clusterSpacing+m,n=e.animation,z=n&&n.enabled,j=f.length,c,g,i=[],r=[],l=[],h=[],o=b.axisInfo.y.isTime,q=[];if(o){a.each(f,function(e,d){var c=a.extend(true,{},d);c.data&&c.data.y&&c.data.y.length&&a.each(c.data.y,function(d,a){c.data.y[d]=b._toOADate(a)});q.push(c)});c=b._barPointList(q)}else c=b._barPointList(f);if(k)c=b._stackValues(c);g=b._getMinDX(c)*v;if(j>1&&!k){d-=c.length*(j-1)*t/(e.horizontal?p:A);g/=j*(1-d)+d}a.each(c,function(q,v){var e=v.paSpec,A=e.length,n,t,j,c;if(k)n=g;else n=g*(A*(1-d)+d);t={x:v.x-n/2,y:0,width:g,height:e[0].y};a.each(e,function(g,v){if(!h[g])h[g]=[];var k=v.sIdx,n=w[k];c=b._paintBar(t,v.y,p,x,y,n,z,m,u,d,g>0?e[g-1].y:null,e[e.length-1].y,o,f[k].textStyle);j=c.bar;b._addClass(a(j.node),"wijchart-canvas-object");a(j.node).data("wijchartDataObj",a.extend(true,{index:q,bar:j,type:"bar",style:n,hoverStyle:s[k]},f[k]));r.push(j);c.animatedBar&&l.push(c.animatedBar);c.dcl&&i.push(c.dcl);h[g][q]=c.rect})});a.each(i,function(b,a){a.toFront()});return{bars:r,animatedBars:l,rects:h,chartLabels:i}},_paintBar:function(e,w,O,o,p,l,B,z,N,G,j,y,I,F){var i=this,m=i.options,J=m.stacked,H=m.is100Percent,x=m.horizontal,t=o.min,s=o.max,v=p.min,u=p.max,L=o.scale,M=o.late,C=p.scale,E=p.late,r,b,A,c,n=null,h,D=l,d=l["stroke-width"],K=l.stroke,g,f,k=i.canvas,q=C*m.axis.y.origin+E;if(J)if(H){if(y>0)e.height=w/y;if(j||j===0){e.y=j/y;e.height-=e.y}}else{e.height=w;if(j||j===0){e.height-=j;e.y=j}}else if(j||j===0){e.x+=e.width*(1-G);e.height=w}b=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y+e.height}];A=(t<=b[0].x&&b[0].x<=s||t<=b[1].x&&b[1].x<=s)&&(v<=b[0].y&&b[0].y<=u||v<=b[1].y&&b[1].y<=u);b[0].x=i._adjustToLimits(b[0].x,t,s);b[0].y=i._adjustToLimits(b[0].y,v,u);b[1].x=i._adjustToLimits(b[1].x,t,s);b[1].y=i._adjustToLimits(b[1].y,v,u);b=i._transformPoints(x,L,C,M,E,b);if(b[0].x>b[1].x){r=b[0].x;b[0].x=b[1].x;b[1].x=r}if(b[0].y>b[1].y){r=b[0].y;b[0].y=b[1].y;b[1].y=r}c={x:b[0].x,y:b[0].y,width:b[1].x-b[0].x,height:b[1].y-b[0].y};if(A){if(c.width===0)c.width=.5;if(c.height===0)c.height=.5}if(m.showChartLabels)n=i._paintDefaultChartLabel(c,w,I,F);h=l.r?l.r:m.clusterRadius;if(h)D=a.extend(true,{},l,{r:0});if(K!=="none"&&d)d=parseInt(d,10);if(!d||isNaN(d))d=0;if(B){if(h){if(x){g=k.wij.roundRect(c.x,c.y,c.width-d,c.height-d,0,0,h,h).hide();f=k.rect(q,c.y,0,c.height-d)}else{g=k.wij.roundRect(c.x,c.y,c.width-d,c.height-d,h,0,0,h).hide();f=k.rect(c.x,q,c.width,0)}i._paintShadow(f,z);f.wijAttr(D);f.bar=g}else{if(x)g=k.rect(q,c.y,0,c.height-d);else g=k.rect(c.x,q,c.width,0);f=g}if(n){n.attr({opacity:0});f.chartLabel=n}f.left=c.x;f.top=c.y;f.width=c.width-d;f.height=c.height-d;f.r=h}else if(h)g=k.wij.roundRect(c.x,c.y,c.width-d,c.height-d,0,0,h,h);else g=k.rect(c.x,c.y,c.width-d,c.height-d);i._paintShadow(g,z);B&&h&&g.shadow.hide();g.wijAttr(l);return{rect:c,dcl:n,animatedBar:f,bar:g}},_playAnimation:function(j){var b=this,e=b.options,d=e.animation,f=e.seriesTransition,g,h,i=[],c;if(d&&d.enabled){g=d.duration||2e3;h=d.easing||"linear";a.each(j,function(j,d){var k=e.horizontal?{width:d.width,x:d.left}:{height:d.height,y:d.top};if(b.aniBarsAttr&&f.enabled){c=b._getDiffAttrs(b.aniBarsAttr[j],d.attr());if(e.horizontal){c.left=b.aniBarsAttr[j].left;c.width=b.aniBarsAttr[j].width}else{c.top=b.aniBarsAttr[j].top;c.height=b.aniBarsAttr[j].height}if(c.path)delete c.path;d.attr(c);g=f.duration;h=f.easing}i.push(a.extend(true,{},d.attr(),k));d.stop().wijAnimate(k,g,h,function(){var a=this,c=a.r,b=a;a.chartLabel&&a.chartLabel.wijAnimate({opacity:1},250);if(c){b=a.bar;b.show();b.shadow&&b.shadow.show();if(a.shadow){a.shadow.wijRemove();a.shadow=null}a.wijRemove();a=null}})});b.aniBarsAttr=i}},_paintDefaultChartLabel:function(b,l,m,j){var f=this,c=f.options,k=c.horizontal,h=a.extend(true,{},c.textStyle,c.chartLabelStyle),g=k?{x:b.x+b.width,y:b.y+b.height/2}:{x:b.x+b.width/2,y:b.y},i,d,e;if(j)h=a.extend(true,h,j);if(m)e=f._fromOADate(l);else e=f.round(l,2);if(c.chartLabelFormatString&&c.chartLabelFormatString.length)e=Globalize.format(e,c.chartLabelFormatString);d=f._text(g.x,g.y,e).attr(h);i=d.getBBox();if(k)d.attr({x:g.x+i.width/2});else d.attr({y:g.y-i.height/2});return d},_getChartLabelPointPosition:function(k){var a=this,n=k.attachMethod,e=k.attachMethodData,g={x:0,y:0},b,f,i,c,d,j,m,h,l;switch(n){case"coordinate":g.x=e.x;g.y=e.y;break;case"dataCoordinate":b=a.chartElement.data("plotInfos");c=e.x;d=e.y;if(a._isDate(c))c=a._toOADate(c);if(a._isDate(d))d=a._toOADate(d);g=a._transformPoints(b.xscale,b.yscale,b.xlate,b.ylate,{x:c,y:d});break;case"dataIndex":f=e.seriesIndex;i=e.pointIndex;b=a.chartElement.data("plotInfos");if(f>-1){j=b.rects;if(j.length>f){m=j[f];h=m[i];g.x=h.x+h.width;g.y=h.y+h.height/2}}break;case"dataIndexY":f=e.seriesIndex;i=e.pointIndex;if(f>-1){l=a.options.seriesList[f].data;c=l.x[i];d=e.y;b=a.chartElement.data("plotInfos");if(a._isDate(c))c=a._toOADate(c);if(a._isDate(d))d=a._toOADate(d);g=a._transformPoints(b.xscale,b.yscale,b.xlate,b.ylate,{x:c,y:d})}}return g},_getTooltipText:function(h,g){var d=a(g.node).data("wijchartDataObj"),c=d.index,b=d.data,e,f,i;if(b.x){e=b.x[c];f=b.y[c]}else{e=b.xy[2*c];f=b.xy[2*c+1]}i={x:e,y:f,data:d,target:g,fmt:h};return a.proxy(h,i)()},_bindLiveEvents:function(){var b=this,d=b.options,h=d.hint.enable,e=b.tooltip,c,g,f;if(h&&!e){c=a.extend(true,{},d.hint);c.offsetY=c.offsetY||-2;g=c.title;f=c.content;if(a.isFunction(g))c.title=function(){return b._getTooltipText(g,this.target)};if(a.isFunction(f))c.content=function(){return b._getTooltipText(f,this.target)};c.beforeShowing=function(){if(this.target)this.options.style.stroke=this.target.attrs.stroke||this.target.attrs.fill};e=b.canvas.tooltip(b.bars,c);b.tooltip=e}a(".wijchart-canvas-object",b.chartElement[0]).live("mousedown.wijbarchart",function(c){if(d.disabled)return;b._trigger("mouseDown",c,a(c.target).data("wijchartDataObj"))}).live("mouseup.wijbarchart",function(c){if(d.disabled)return;b._trigger("mouseUp",c,a(c.target).data("wijchartDataObj"))}).live("mouseover.wijbarchart",function(c){if(d.disabled)return;b._trigger("mouseOver",c,a(c.target).data("wijchartDataObj"))}).live("mouseout.wijbarchart",function(g){if(d.disabled)return;var c=a(g.target).data("wijchartDataObj"),f=c.bar;b._trigger("mouseOut",g,c);if(!c.hoverStyle)f&&f.attr({opacity:"1"});else f.attr(c.style);e&&e.hide()}).live("mousemove.wijbarchart",function(f){if(d.disabled)return;var c=a(f.target).data("wijchartDataObj"),e=c.bar;b._trigger("mouseMove",f,c);if(!c.hoverStyle)e&&e.attr({opacity:"0.8"});else e.attr(c.hoverStyle)}).live("click.wijbarchart",function(c){if(d.disabled)return;b._trigger("click",c,a(c.target).data("wijchartDataObj"))})},_unbindLiveEvents:function(){var b=this;a(".wijchart-canvas-object",b.chartElement[0]).die("wijbarchart");if(b.tooltip){b.tooltip.destroy();b.tooltip=null}},_calculateParameters:function(c,e){a.wijmo.wijchartcore.prototype._calculateParameters.apply(this,arguments);if(c.id==="x"){var d=e.unitMinor,b=this._getBarAdjustment(c);if(b===0)b=d;else if(d<b&&d!==0)b=Math.floor(b/d)*d;c.min-=b;c.max+=b;this._calculateMajorMinor(e,c)}},_getBarAdjustment:function(c){for(var a=0,h=this.options,e=c.max,b=c.min,g=h.seriesList,f=0,d=0,f=0;f<g.length;f++){d=g[f].data.x.length;if(a<d)a=d}if(a>1)return(e-b)/a*h.clusterWidth*.0125;else if(a===1){if(b===0&&e===1){b=-1;c.min=b}return(e-b)*.0125}else return 0}});a.extend(a.wijmo.wijbarchart.prototype,{_barPointList:function(f){var b=[],d=this._getXSortedPoints;function c(b){this.x=b;this.paSpec=[];this.stackValues=function(){var c=this.paSpec.length,b;if(c>1){b=this.paSpec[0];a.each(this.paSpec,function(c,a){if(c===0)return true;a.y+=b.y;b=a})}}}function e(n,m){var h=d(m),l=m.length,f=null,o=0,e=0,g=0,k=true,i=0,j=false;if(h)o=h.length;if(b)g=b.length;a.each(h,function(d,a){if(k){k=false;i=a.x}else{if(i===a.x)j=true;else j=false;i=a.x}while(e<g&&b[e].x<a.x)e++;if(e<g)if(b[e].x!==a.x){f=new c(a.x,l);b.splice(e,0,f);g=b.length}else f=b[e];else{f=new c(a.x,l);b.push(f);g=b.length}f.paSpec.push({y:a.y,sIdx:n,pIdx:d,dupl:j})})}a.each(f,function(b,a){e(b,a)});return b},_getSpecWithValue:function(b){var c=null;a.each(b,function(d,a){if(a.x>=b){if(a.x===b)c=a;return false}});return c},_getMinDX:function(d){for(var a=Number.MAX_VALUE,e=d.length,c,b=1;b<e;b++){c=d[b].x-d[b-1].x;if(c<a&&c>0)a=c}return a===Number.MAX_VALUE?2:a},_stackValues:function(b){a.each(b,function(b,a){a.stackValues()});return b}})})(jQuery);
(function(){"use strict";if(!window.Raphael)return;Raphael.fn.tri=function(b,c,e){var g=b,j=c-e,a=Math.cos(Math.PI/6)*e,d=Math.tan(Math.PI/3)*a,h=b+a,k=c+d,i=b-a,l=c+d,f=["M",g,j,"L",h,k,"L",i,l,"z"];return this.path(f.concat(" "))};Raphael.fn.invertedTri=function(b,c,e){var g=b,j=c+e,a=Math.cos(Math.PI/6)*e,d=Math.tan(Math.PI/3)*a,h=b+a,k=c-d,i=b-a,l=c-d,f=["M",g,j,"L",h,k,"L",i,l,"z"];return this.path(f.concat(" "))};Raphael.fn.box=function(b,c,e){var a=Math.cos(Math.PI/4)*e,d=["M",b-a,c-a,"L",b+a,c-a,"L",b+a,c+a,"L",b-a,c+a,"z"];return this.path(d.concat(" "))};Raphael.fn.diamond=function(b,c,a){var d=["M",b,c-a,"L",b+a,c,"L",b,c+a,"L",b-a,c,"z"];return this.path(d.concat(" "))};Raphael.fn.cross=function(b,c,e){var a=Math.cos(Math.PI/4)*e,d=["M",b-a,c-a,"L",b+a,c+a,"M",b-a,c+a,"L",b+a,c-a];return this.path(d.concat(" "))}})();(function(a){"use strict";a.widget("wijmo.wijlinechart",a.wijmo.wijchartcore,{options:{animation:{enabled:true,direction:"horizontal",duration:2e3,easing:">"},seriesTransition:{enabled:true,duration:2e3,easing:">"},zoomOnHover:true,mouseDown:null,mouseUp:null,mouseOver:null,mouseOut:null,mouseMove:null,click:null},_create:function(){var b=this;a.wijmo.wijchartcore.prototype._create.apply(b,arguments);b.chartElement.addClass("wijmo-wijlinechart");b.paths=[];b.shadowPaths=[];b.markersSet=[];b.animationSet=b.canvas.set();b.symbols=[];b.hoverPoint=null;b.hoverLine=null;b.linesStyle=[];b.shadow=true},destroy:function(){var b=this;b.chartElement.removeClass("wijmo-wijlinechart");a.wijmo.wijchartcore.prototype.destroy.apply(b,arguments);if(b.aniPathsAttr&&b.aniPathsAttr.length){a.each(b.aniPathsAttr,function(b,a){a=null});b.aniPathsAttr=null}},getLinePath:function(a){return this.paths[a]},getLineMarkers:function(a){var b=this.options,c;return b.seriesList&&b.seriesList[a].markers&&b.seriesList[a].markers.visible?this.markersSet[a]:c},_getAnchors:function(j,k,a,b,l,m){var n=(a-j)/2,o=(l-a)/2,c=Math.atan((a-j)/Math.abs(b-k)),d=Math.atan((l-a)/Math.abs(b-m)),e=0,f=0,h=0,g=0,i=0;c=k<b?Math.PI-c:c;d=m<b?Math.PI-d:d;e=Math.PI/2-(c+d)%(Math.PI*2)/2;f=n*Math.sin(e+c);h=n*Math.cos(e+c);g=o*Math.sin(e+d);i=o*Math.cos(e+d);return{x1:a-f,y1:b+h,x2:a+g,y2:b+i}},_paintLegend:function(){var j=this.options,b=0,l=0,p=0,g=null,k=j.seriesList,o=j.seriesStyles,c=null,h=null,d=null,m=0,n=0,e=null,f=null,i=null;a.extend(true,j,{legend:{size:{width:30,height:3}}});a.wijmo.wijchartcore.prototype._paintLegend.apply(this,arguments);if(j.legend.visible){if(this.legends.length&&this.legendIcons.length)for(b=0,l=this.legendIcons.length;b<l;b++){g=this.legendIcons[b];g.attr({fill:g.attr("stroke")})}if(!j.legend.reversed)for(b=0,l=k.length;b<l;b++){c=k[b];h=o[b];if(c.legendEntry){if(c.markers&&c.markers.visible){g=this.legendIcons[b];d=g.wijGetBBox();m=d.x+d.width/2;n=d.y+d.height/2;e=c.markerStyle;e=a.extend({fill:h.stroke,stroke:h.stroke,opacity:1},e);f=c.markers.type;if(!f)f="circle";i=this._paintMarker(f,m,n,3);i.attr(e);this.legendEles.push(i)}p++}}else for(b=k.length-1;b>=0;b--){c=k[b];h=o[b];if(c.legendEntry&&c.markers.visible){if(c.markers.visible){g=this.legendIcons[b];d=g.wijGetBBox();m=d.x+d.width/2;n=d.y+d.height/2;e=c.markerStyle;e=a.extend({fill:h.stroke,stroke:h.stroke,opacity:1},e);f=c.markers.type;if(!f)f="circle";i=this._paintMarker(f,m,n,3);i.attr(e)}p++}}}},_clearChartElement:function(){var b=this;b.linesStyle=[];if(b.paths.length){a.each(b.paths,function(b,a){a.wijRemove();a=null});b.paths=[]}if(b.shadowPaths.length){a.each(b.shadowPaths,function(b,a){a.wijRemove();a=null});b.shadowPaths=[]}if(b.markersSet.length){a.each(b.markersSet,function(c,b){a.each(b,function(b,a){a.wijRemove();a=null});b=null});b.markersSet=[]}if(b.animationSet.length){a.each(b.animationSet,function(b,a){a.wijRemove();a=null});b.animationSet=b.canvas.set()}if(b.symbols.length){a.each(b.symbols,function(b,a){a.wijRemove();a=null});b.symbols=[]}a.wijmo.wijchartcore.prototype._clearChartElement.apply(b,arguments)},_paintMarker:function(f,d,e,b){var c=this,a=null;switch(f){case"circle":a=c.canvas.circle(d,e,b);break;case"tri":a=c.canvas.tri(d,e,b);break;case"invertedTri":a=c.canvas.invertedTri(d,e,b);break;case"box":a=c.canvas.box(d,e,b);break;case"diamond":a=c.canvas.diamond(d,e,b);break;case"cross":a=c.canvas.cross(d,e,b)}return a},_getPathArrByFitType:function(a,n,b,u,e,q,r,c,d,y,z,g,t){var j=null,k=null,w=0,x=0,o=0,p=0,h=null,i=null,f=null,s=g.minY,l=g.minX,m=g.kx,v=g.ky;if(n==="line")a=a.concat([b?"L":"M",c,d]);else if(n==="spline")if(!b)a=["M",c,d,"C",c,d];else if(b&&b<u-1){j=r[b-1];k=r[b+1];if(z){j=this._toOADate(j);k=this._toOADate(k)}w=e.endY-(j-s)*v;x=e.endY-(k-s)*v;if(isNaN(t)||typeof t==="string"){o=e.startX+(b-1-l)*m;p=e.startX+(b+1-l)*m}else{h=q[b-1];i=q[b+1];if(y){h=this._toOADate(h);i=this._toOADate(i)}o=e.startX+(h-l)*m;p=e.startX+(i-l)*m}f=this._getAnchors(o,w,c,d,p,x);a=a.concat([f.x1,f.y1,c,d,f.x2,f.y2])}else a=a.concat([c,d,c,d]);else if(n==="bezier")if(!b)a=a.concat(["M",c,d]);else if(b===u-1&&b%2===1)a=a.concat(["Q",c,d,c,d]);else if(b%2===0)a=a.concat([c,d]);else a=a.concat(["Q",c,d]);return a},_paintPlotArea:function(){var b=this,f=b.options,q=f.animation,l=q.duration,o=q.easing,h=f.seriesTransition,g=b.canvasBounds,W=g.endX-g.startX,I=g.endY-g.startY,Q=f.seriesList,ob=f.seriesStyles,L,kb,j,Y,i,lb,M,nb,r,A,c,bb,T,y,O,w,ab,D=f.axis.x.min,J=f.axis.y.min,X=f.axis.x.max,jb=f.axis.y.max,mb=W/(X-D),Z=I/(jb-J),fb={minX:D,minY:J,maxX:X,maxY:jb,width:W,height:I,kx:mb,ky:Z},hb=b.axisInfo.x.isTime,C=b.axisInfo.y.isTime,V,n,m,H,gb,R,u,p,t,G,v,ib,e,S,U,eb,db,k,d,s,cb=[],N,P,z,B,F,x,K,E;b.plotInfos=[];for(i=0,lb=Q.length;i<lb;i++){N=[];P=[];x=[];c=Q[i];bb=ob[i];c=a.extend(true,{fitType:"line",markers:{visible:false,type:"circle"},visible:true},c);T=c.data;y=a.extend({stroke:"black",opacity:1,fill:"none","stroke-linejoin":"round","stroke-linecap":"round"},bb);w=c.markerStyle;w=a.extend({fill:y.stroke,stroke:y.stroke,opacity:1,width:3},w);O=f.seriesHoverStyles[i];ab=a.extend(true,{},O,{scale:"1.5 1.5","stroke-width":1},Q.markerHoverStyle);V=T.x;n=T.y;b.plotInfos.push(fb);m=b.canvas.set();H=[];gb=c.fitType;R=false;if(c.markers.symbol&&c.markers.symbol.length)R=true;u=b.canvas.set();if(!b.aniPathsAttr||q.enabled&&!h.enabled)if(n.length>0){B=n[0];if(C)B=b._toOADate(B);F=n[n.length-1];if(C)F=b._toOADate(F)}for(j=0,Y=n.length;j<Y;j++){p=V[j];if(hb)p=b._toOADate(p);t=n[j];if(C)t=b._toOADate(t);if(p===undefined)break;r=0;if(isNaN(p)||typeof p==="string")K=j;else K=p;r=g.startX+(K-D)*mb;A=g.endY-(t-J)*Z;if(!b.aniPathsAttr||q.enabled&&!h.enabled){z=B+(F-B)/(X-D)*(K-D);z=g.endY-(z-J)*Z;if(j===0)x.push("M");else x.push("L");x.push(r);x.push(z)}H=b._getPathArrByFitType(H,gb,j,Y,g,V,n,r,A,hb,C,fb,p,t);if(f.showChartLabels){G=C?b._fromOADate(t):t;if(f.chartLabelFormatString&&f.chartLabelFormatString.length)G=Globalize.format(G,f.chartLabelFormatString);v=b.canvas.text(r,A,G);b.chartLabelEles.push(v);ib=v.wijGetBBox();v.translate(0,-ib.height);u.push(v);P.push(a.extend(true,{},v.attr()))}e=null;S=false;if(R){U=c.markers.symbol;for(M=0,nb=U.length;M<nb;M++){s=U[M];if(s.index===j){e=b.canvas.image(s.url,r-s.width/2,A-s.height/2,s.width,s.height);b.symbols.push(e);S=true;if(!b.aniPathsAttr||q.enabled&&!h.enabled)e.straight=z;break}}}if(e===null){eb=c.markers.type;db=w.width;e=b._paintMarker(eb,r,A,db);c.markers.visible&&e.attr(w);if(!b.aniPathsAttr||q.enabled&&!h.enabled)e.straight=z}b._addClass(a(e.node),"wijchart-canvas-object wijchart-canvas-marker");k={};k.marker=e;k.index=j;k.type="marker";k.lineSeries=c;k.x=r;k.y=A;k.isSymbol=S;a(e.node).data("wijchartDataObj",k);m.push(e);N.push(a.extend(true,{},e.attr()));b.animationSet.push(e)}d=b.canvas.path(H.join(" "));d.straight=x.join(" ");b._paintShadow(d);d.wijAttr(y);cb.push({path:a.extend(true,{},d.attr()),markers:N,labels:P});d.markers=m;b.paths[i]=d;if(d.shadow)b.shadowPaths[i]=d.shadow;b.animationSet.push(d);b.linesStyle[i]={lineStyle:y,lineHoverStyle:O,markerStyle:w,markerHoverStyle:ab};!c.markers.visible&&m.hide();if(!c.visible){d.hide();d.shadow&&d.shadow.hide()}c.markers.style&&m.attr(c.markers.style);m.toFront();if(u.length){E=a.extend(true,{},f.chartLabelStyle);if(c.textStyle)E=a.extend(true,E,c.textStyle);u.attr(E);u.toFront();d.labels=u}b.markersSet[i]=m;c.index=i;c.type="line";c.path=d;c.lineMarkers=m;c.lineStyle=y;b._addClass(a(d.node),"wijchart-canvas-object");a(d.node).data("wijchartDataObj",c)}if(q.enabled||h.enabled&&b.seriesTransition)if(q.direction==="horizontal"){if(h.enabled&&b.seriesTransition){l=h.duration;o=h.easing}b.animationSet.wijAttr("clip-rect",g.startX+" "+g.startY+" 0 "+I);b.animationSet.wijAnimate({"clip-rect":g.startX+" "+g.startY+" "+W+" "+I},l,o,function(){if(Raphael.vml)for(L=0,kb=b.animationSet.length;L<kb;L++){var c=b.animationSet[L],e=null,f=null,d=null;if(c.node.clipRect){e=c.attrs;delete e["clip-rect"];c.node.clipRect=null;f=a(c.node).parent();d=f.parent();d.before(f);d.remove();c.attr(e)}}})}else a.each(b.paths,function(g,c){var d,e,f;if(b.aniPathsAttr&&h.enabled){l=h.duration;o=h.easing;c.shadow&&c.shadow.hide();d=b.aniPathsAttr[g];e=b._getDiffAttrs(d.path,c.attr());c.attr(d.path);c.wijAnimate(e,l,o,function(){c.shadow&&c.shadow.show()});a.each(c.markers,function(c,a){var e=b._getDiffAttrs(d.markers[c],a.attr());a.attr(d.markers[c]);a.wijAnimate(e,l,o)});c.labels&&a.each(c.labels,function(e,c){var f=b._getDiffAttrs(d.labels[e],c.attr()),a=d.labels[e];if(a&&a.text)delete a.text;c.attr(a);c.wijAnimate(f,l,o)})}else if(c.straight){c.shadow&&c.shadow.hide();d=c.straight;f=c.attr().path;c.attr({path:d});c.wijAnimate({path:f},l,o,function(){c.shadow&&c.shadow.show()});a.each(c.markers,function(c,a){if(a.straight){var b=a.attr().cy;a.attr({cy:a.straight});a.wijAnimate({cy:b},l,o)}})}});b.aniPathsAttr=cb},_getChartLabelPointPosition:function(m){var b=this,n=b.options,o=m.attachMethod,f=m.attachMethodData,h={x:0,y:0},e=null,g=null,c=0,d=0,i=0,j=0,a=null,l=null,k=null;switch(o){case"coordinate":h.x=f.x;h.y=f.y;break;case"dataCoordinate":e=f.seriesIndex;if(e>-1){g=b.plotInfos;if(g.length>e){c=f.x;d=f.y;if(b._isDate(c))c=b._toOADate(c);if(this._isDate(d))d=b._toOADate(d);a=g[e];i=a.width/(a.maxX-a.minX);h.x=b.canvasBounds.startX+(c-a.minX)*i;j=a.height/(a.maxY-a.minY);h.y=b.canvasBounds.startY+a.height-(d-a.minY)*j}}break;case"dataIndex":e=f.seriesIndex;k=f.pointIndex;l=n.seriesList[e].data;c=l.x[k];d=l.y[k];if(b._isDate(c))c=b._toOADate(c);if(this._isDate(d))d=b._toOADate(d);if(e>-1){g=b.plotInfos;if(g.length>e){a=g[e];i=a.width/(a.maxX-a.minX);h.x=b.canvasBounds.startX+(c-a.minX)*i;j=a.height/(a.maxY-a.minY);h.y=b.canvasBounds.startY+a.height-(d-a.minY)*j}}break;case"dataIndexY":e=f.seriesIndex;k=f.pointIndex;l=n.seriesList[e].data;c=l.x[k];d=f.y;if(b._isDate(c))c=b._toOADate(c);if(b._isDate(d))d=b._toOADate(d);if(e>-1){g=b.plotInfos;if(g.length>e){a=g[e];i=a.width/(a.maxX-a.minX);h.x=b.canvasBounds.startX+(c-a.minX)*i;j=a.height/(a.maxY-a.minY);h.y=b.canvasBounds.startY+a.height-(d-a.minY)*j}}}return h},_bindLiveEvents:function(){var b=this,f=false,e=this.options,c={element:this.chartElement,mousedown:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("mouseDown",c,d);else b._trigger("mouseDown",c,f)}else b._trigger("mouseDown",c,f)},mouseup:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("mouseUp",c,d);else b._trigger("mouseUp",c,f)}else b._trigger("mouseUp",c,f)},mouseover:function(i){if(e.disabled)return;var j=a(i.target),d=a(i.target).data("wijchartDataObj"),h=null,c=null,g=0;if(j.hasClass("wijchart-canvas-marker")){h=d.lineSeries;if(!h.markers.visible)b._trigger("mouseOver",i,h);else b._trigger("mouseOver",i,d);if(b.hoverLine!==h){f=true;if(b.hoverLine){g=b.hoverLine.index;c=b.linesStyle[g];b.hoverLine.path.wijAttr(c.lineStyle);if(b.hoverPoint&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr(c.markerStyle);b.hoverPoint.marker.scale(1,1)}}g=h.index;c=b.linesStyle[g];c&&c.lineHoverStyle&&h.path.wijAttr(c.lineHoverStyle);b.hoverLine=h;b.hoverPoint=null}}else{b._trigger("mouseOver",i,d);if(d.type!=="line")return;if(b.hoverLine!==d){f=true;if(b.hoverLine){g=b.hoverLine.index;c=b.linesStyle[g];b.hoverLine.path.wijAttr(c.lineStyle);if(b.hoverPoint&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr(c.markerStyle);b.hoverPoint.marker.scale(1,1)}}g=d.index;c=b.linesStyle[g];c&&c.lineHoverStyle&&d.path.wijAttr(c.lineHoverStyle);b.hoverLine=d;b.hoverPoint=null}}},mouseout:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("mouseOut",c,d);else b._trigger("mouseOut",c,f)}else b._trigger("mouseOut",c,f)},mousemove:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("mouseMove",c,d);else b._trigger("mouseMove",c,f)}else b._trigger("mouseMove",c,f)},click:function(c){if(e.disabled)return;var g=a(c.target),f=a(c.target).data("wijchartDataObj"),d=null;if(g.hasClass("wijchart-canvas-marker")){d=f.lineSeries;if(!d.markers.visible)b._trigger("click",c,d);else b._trigger("click",c,f)}else b._trigger("click",c,f)}},d=e.hint,i=null,g=b.canvasBounds,h=b.chartElement.offset();a(".wijchart-canvas-object",this.chartElement[0]).live("mousedown.wijlinechart",a.proxy(c.mousedown,c)).live("mouseup.wijlinechart",a.proxy(c.mouseup,c)).live("mouseover.wijlinechart",a.proxy(c.mouseover,c)).live("mouseout.wijlinechart",a.proxy(c.mouseout,c)).live("mousemove.wijlinechart",a.proxy(c.mousemove,c)).live("click.wijlinechart",a.proxy(c.click,c));if(d.enable){i=a.extend(true,d,{closeBehavior:"none",mouseTrailing:false,triggers:"custom",compass:d.compass});if(!this.tooltip)this.tooltip=this.canvas.tooltip(null,i)}this.chartElement.bind("mousemove",function(B){if(e.disabled)return;h=b.chartElement.offset();var m={left:B.pageX-h.left,top:B.pageY-h.top},v=null,c=0,u=0,z=0,j=null,r=0,q=0,n=null,t=null,l=null,o,p,k=null,C=null,i=null,s=null,A=d.title,y=d.content,x=a.isFunction(A),w=a.isFunction(y);if(b.tooltip)s=b.tooltip.getOptions();if(m.left>=g.startX&&m.left<=g.endX&&m.top>=g.startY&&m.top<=g.endY){if(b.hoverLine){if(f){d.enable&&b.tooltip&&b.tooltip.hide();f=false}v=b.hoverLine.lineMarkers;c=-1;t={x:0,y:0};a.each(v,function(a,b){j=b.wijGetBBox();r=j.x+j.width/2;q=Math.abs(r-m.left);if(a===0){u=q;c=a;t={x:r,y:j.y+j.height/2}}else if(q<u){u=q;c=a;t={x:r,y:j.y+j.height/2}}});if(b.hoverPoint&&b.hoverPoint.index===c)return;if(c>-1){n=a(v[c].node).data("wijchartDataObj");if(n){z=b.hoverLine.index;l=b.linesStyle[z];if(b.hoverPoint&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr(l.markerStyle);b.hoverPoint.marker.scale(1,1)}!n.isSymbol&&n.marker.wijAttr(l.markerHoverStyle)}b.hoverPoint=n}if(d.enable&&b.tooltip){k=b.hoverLine.data;if(k.x){o=k.x[c];p=k.y[c]}else{o=k.xy[2*c];p=k.xy[2*c+1]}i=b.hoverPoint;if(x||w){if(x)s.title=function(){var b={pointIndex:c,lineIndex:i.lineSeries.index,x:o,y:p,label:i.lineSeries.label,data:i,fmt:A},d=a.proxy(b.fmt,b),e=d();return e};if(w)s.content=function(){var b={pointIndex:c,lineIndex:i.lineSeries.index,x:o,y:p,label:i.lineSeries.label,data:i,fmt:y},e=a.proxy(b.fmt,b),d=e();return d}}C=a.extend({stroke:b.hoverLine.path.attr("stroke")},d.style);s.style.stroke=C.stroke;b.tooltip.showAt(t)}}}else{d.enable&&b.tooltip&&b.tooltip.hide();if(b.hoverLine){c=b.hoverLine.index;l=b.linesStyle[c];b.hoverLine.path.wijAttr(l.lineStyle);if(b.hoverPoint&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr(l.markerStyle);b.hoverPoint.marker.scale(1,1)}}b.hoverLine=null;b.hoverPoint=null}})},_unbindLiveEvents:function(){a(".wijchart-canvas-object",this.chartElement[0]).die("wijlinechart")}})})(jQuery);
(function(a){"use strict";a.widget("wijmo.wijpiechart",a.wijmo.wijchartcore,{options:{radius:null,innerRadius:0,animation:{enabled:true,duration:400,easing:">",offset:10},seriesTransition:{enabled:true,duration:1e3,easing:"bounce"},mouseDown:null,mouseUp:null,mouseOver:null,mouseOut:null,mouseMove:null,click:null},_create:function(){var b=this,c=["0-#8ac4c0-#77b3af","0-#73a19e-#67908e","0-#4f687b-#465d6e","0-#69475b-#5d3f51","0-#7a3b3f-#682e32","0-#9d5b5b-#8c5151","0-#e5a36d-#ce9262","0-#e6cc70-#ceb664","0-#8ec858-#7fb34f","0-#3a9073-#2a7b5f","0-#6c88e3-#6079cb","0-#6cb4e3-#60a0cb"];a.wijmo.wijchartcore.prototype._create.apply(b,arguments);b.chartElement.addClass("wijmo-wijpiechart");a.each(this.options.seriesStyles,function(b,a){if(!a.fill)a.fill=c[b]});b.canvas.customAttributes.segment=function(h,i,d,a,g,f){var e=null,c=.01;if(a-d>360-c)a-=c;else if(a-d<c)a+=c;if(f)e=b._donut(h,i,g,f,d,a);else e=b._sector(h,i,g,d,a);return{path:e}}},destroy:function(){var b=this;b.chartElement.removeClass("wijmo-wijpiechart ui-helper-reset");a.wijmo.wijchartcore.prototype.destroy.apply(this,arguments);if(b.aniSectors&&b.aniSectors.length){a.each(b.aniSectors,function(b,a){a=null});b.aniSectors=null}if(b.aniLabels&&b.aniLabels.length){a.each(b.aniLabels,function(b,a){a=null});b.aniLabels=null}},_isPieChart:function(){return true},getSector:function(a){return this.sectors[a]},_getSeriesFromTR:function(i,e,h){var d=null,g=null,b=null,f=null,c=null;e.length&&e.each(function(){g=a("th",a(this));d=a.trim(g.text());b=a("td",a(this));if(b.length)f=parseFloat(a.trim(a(b[0]).text()));c={label:d,legendEntry:true,data:f};h.push(c)})},_paintPlotArea:function(){var c=this,b=c.options,d=c.canvasBounds,i=d.endX-d.startX,h=d.endY-d.startY,p=b.seriesList,u=b.seriesStyles,t=b.seriesHoverStyles,n=0,l=[],k=[],q=[],f=0,m=c.canvas,j=m.wij.getPositionByAngle,g,r,s,o,e;if(!b.radius)b.radius=Math.min(i,h)/2;else{if(i<2*b.radius)b.radius=i/2;if(h<2*b.radius)b.radius=h/2}d.startX+=i/2-b.radius;d.endX=d.startX+2*b.radius;d.startY+=h/2-b.radius;d.endY=d.startY+2*b.radius;a.each(p,function(b,a){if(a&&typeof a.data==="number")n+=a.data});r=d.startX;s=d.startY;c.total=n;g=b.radius;a.each(p,function(p,h){var v=a.extend({opacity:1,stroke:"gray","stroke-width":1},u[p]),A=360*h.data/n,x=r+g,y=s+g,B,d,w,z,i;h=a.extend(true,{offset:0},h);if(h.offset){B=j(x,y,h.offset,f+A/2);x=B.x;y=B.y}o=[x,y,f,f+A,g,b.innerRadius].concat(" ");if(c.aniSectors&&b.seriesTransition.enabled){v.segment=o;if(p<c.aniSectors.length){e=c.aniSectors[p].attr();c.aniSectors[p].stop()}else{e=a.extend(true,{},v);e.segment=[x,y,0,360,g,b.innerRadius].concat(" ")}d=c.canvas.path().attr(e);v=c._getDiffAttrs(e,v);d.wijAnimate(v,b.seriesTransition.duration,b.seriesTransition.easing,function(){c._paintShadow(d);delete v.segment})}else{d=c.canvas.path().attr({segment:o});c._paintShadow(d);d.wijAttr(v)}d.angles={start:f,end:f+A};d.getOffset=function(b){var a=j(x,y,b,(d.angles.start+d.angles.end)/2);return{x:a.x-x,y:a.y-y}};d.center={x:x,y:y};d.radius=g;if(b.innerRadius)d.innerRadius=b.innerRadius;c._addClass(a(d.node),"wijchart-canvas-object");a(d.node).data("wijchartDataObj",h);if(b.showChartLabels){z=j(x,y,h.offset+g*2/3,f+A/2);i=a.extend(true,{},b.textStyle,b.chartLabelStyle);if(h.textStyle)i=a.extend(true,i,h.textStyle);if(c.aniLabels&&b.seriesTransition.enabled)if(p<c.aniLabels.length){e=c.aniLabels[p].attr();c.aniLabels[p].stop();e.text=h.label;w=c.canvas.text(0,0,"").attr(e);i=c._getDiffAttrs(e,i);i.x=z.x;i.y=z.y;w.wijAnimate(i,b.seriesTransition.duration,b.seriesTransition.easing)}else w=m.text(z.x,z.y,h.label).attr(i);else w=m.text(z.x,z.y,h.label).attr(i);c._addClass(a(w.node),"wijchart-canvas-object");a(w.node).data("wijchartDataObj",h);k.push(w);q.push(w)}l.push(d);k.push(d);h.style=v;h.hoverStyle=t[p];h.index=p;h.type="pie";f+=A});c.aniSectors=l;c.aniLabels=q;c.sectors=l;c.tooltipTars=k},_paintChartLabels:function(){var b=this,c=b.options,d=c.chartLabels,e=0,f=c.radius;if(!d||!d.length)return;a.each(d,function(v,u){var o=b.canvasBounds.startX+f,p=b.canvasBounds.startY+f,i=a.extend(true,{compass:"east",attachMethod:"coordinate",attachMethodData:{seriesIndex:-1,x:-1,y:-1},offset:0,visible:false,text:"",connected:false},u),r,t,g,d,n,h,j,s,l,k,m,q=b.canvas.wij.getPositionByAngle;if(!i.visible)return true;r=i.attachMethod;t=i.attachMethodData;g={x:0,y:0};d=0;n=null;if(r==="dataIndex"){h=t.seriesIndex;if(h>-1){j=c.seriesList[h];s=j.data;l=360*s/b.total;k=c.seriesStyles[h];n={stroke:k.stroke||k.fill};d=e+l/2;if(j.offset){m=q(o,p,j.offset,d);o=m.x;p=m.y}g=q(o,p,f,d);e=e+l}}if(isNaN(g.x)||isNaN(g.y))return false;b._setChartLabel(i,g,d,n)})},_getTooltipText:function(d,c){var b=a(c.node).data("wijchartDataObj"),f=b.data,e;e={value:f,total:this.total,data:b,target:c,fmt:d};return a.proxy(d,e)()},_bindLiveEvents:function(){var b=this,c=this.options,l=c.hint.enable,h=b.tooltip,e={x:0,y:0},d,k,j,g=[],f=[],i=[];if(l&&!h){d=a.extend(true,{},c.hint);d.offsetY=d.offsetY||-2;k=c.hint.title;j=c.hint.content;if(a.isFunction(k))d.title=function(){return b._getTooltipText(k,this.target)};if(a.isFunction(j))d.content=function(){return b._getTooltipText(j,this.target)};d.beforeShowing=function(){if(this.target)this.options.style.stroke=this.target.attrs.stroke||this.target.attrs.fill};h=b.canvas.tooltip(b.tooltipTars,d);b.tooltip=h}a(".wijchart-canvas-object",this.chartElement[0]).live("mousedown.wijpiechart",function(e){if(c.disabled)return;var d=a(e.target).data("wijchartDataObj");if(!d)d=a(e.target.parentNode).data("wijchartDataObj");b._trigger("mouseDown",e,d)}).live("mouseup.wijpiechart",function(e){if(c.disabled)return;var d=a(e.target).data("wijchartDataObj");if(!d)d=a(e.target.parentNode).data("wijchartDataObj");b._trigger("mouseUp",e,d)}).live("mouseover.wijpiechart",function(o){if(c.disabled)return;var k=a(o.target).data("wijchartDataObj"),j=c.animation,p=j&&j.enabled,d,l,h,n,m;if(!k)k=a(o.target.parentNode).data("wijchartDataObj");d=k.index;l=b.getSector(d);h=g[d];n=f[d];m=i[d];l.wijAttr(k.hoverStyle);b._trigger("mouseOver",o,k);if(p){if(n){window.clearTimeout(n);n=null;f[d]=null}if(h){window.clearTimeout(h);h=null;g[d]=null}if(m)return;h=window.setTimeout(function(){var a=j.duration,b=j.easing;if(l.removed)return;e=l.getOffset(j.offset);l.wijAnimate({translation:e.x+" "+e.y},a,b);m=true;i[d]=m},150);g[d]=h}}).live("mouseout.wijpiechart",function(p){if(c.disabled)return;var j=a(p.target).data("wijchartDataObj"),n=c.animation,q=n&&n.enabled,d,o,m,k,l;if(!j)j=a(p.target.parentNode).data("wijchartDataObj");d=j.index;o=b.getSector(d);m=g[d];k=f[d];l=i[d];b._trigger("mouseOut",p,j);if(j.style.segment)delete j.style.segment;o.wijAttr(j.style);h&&h.hide();if(q){if(k){window.clearTimeout(k);k=null;f[d]=null}if(m){window.clearTimeout(m);m=null;g[d]=null}if(!l)return;k=window.setTimeout(function(){var a=n.duration,b=n.easing;o.wijAnimate({translation:-e.x+" "+-e.y},a,b);e={x:0,y:0};l=false;i[d]=l},150);f[d]=k}}).live("mousemove.wijpiechart",function(e){if(c.disabled)return;var d=a(e.target).data("wijchartDataObj");if(!d)d=a(e.target.parentNode).data("wijchartDataObj");b._trigger("mouseMove",e,d)}).live("click.wijpiechart",function(e){if(c.disabled)return;var d=a(e.target).data("wijchartDataObj");if(!d)d=a(e.target.parentNode).data("wijchartDataObj");b._trigger("click",e,d)})},_unbindLiveEvents:function(){var b=this;a(".wijchart-canvas-object",b.chartElement[0]).die("wijpiechart");if(b.tooltip){b.tooltip.destroy();b.tooltip=null}},_sector:function(b,c,a,d,e){var g=this,f=g._getPositionByAngle(b,c,a,d),h=g._getPositionByAngle(b,c,a,e);return["M",b,c,"L",f.x,f.y,"A",a,a,0,+(e-d>180),0,h.x,h.y,"z"]},_donut:function(e,f,b,a,g,h){var d=this,c=d._getPositionByAngle(e,f,b,g),l=d._getPositionByAngle(e,f,b,h),k=d._getPositionByAngle(e,f,a,g),j=d._getPositionByAngle(e,f,a,h),i=h-g>180;return["M",c.x,c.y,"A",b,b,0,+i,0,l.x,l.y,"L",j.x,j.y,"A",a,a,0,+i,1,k.x,k.y,"L",c.x,c.y,"z"]},_getPositionByAngle:function(e,f,c,d){var a={},b=Raphael.rad(d);a.x=e+c*Math.cos(-1*b);a.y=f+c*Math.sin(-1*b);return a}})})(jQuery);
(function(a){"use strict";a.widget("wijmo.wijtree",{options:{allowDrag:false,allowDrop:false,allowEdit:false,allowSorting:true,allowTriState:true,autoCheckNodes:true,autoCollapse:false,disabled:false,expandCollapseHoverUsed:false,showCheckBoxes:false,showExpandCollapse:true,expandAnimation:{effect:"blind",easing:"easeOutExpo",duration:200},expandDelay:0,collapseAnimation:{effect:"blind",easing:"easeOutExpo",duration:200},collapseDelay:0,draggable:null,droppable:null,dropVisual:null,nodeBlur:null,nodeClick:null,nodeCheckChanged:null,nodeCollapsed:null,nodeExpanded:null,nodeDragging:null,nodeDragStarted:null,nodeBeforeDropped:null,nodeDropped:null,nodeMouseOver:null,nodeMouseOut:null,nodeTextChanged:null,selectedNodeChanged:null},_create:function(){this._initState();this._createTree();this._attachEvent();this._attachNodeEvent()},_setOption:function(f,c){var b=this,e=false,d;switch(f){case"allowDrag":b._setAllowDrag(c);break;case"allowDrop":b._setAllowDrop(c);break;case"showCheckBoxes":b._setCheckBoxes(c);break;case"showExpandCollapse":if(b.options.showExpandCollapse!==c)e=true;break;case"disabled":if(c)b.widgetDom.addClass("ui-state-disabled");else b.widgetDom.removeClass("ui-state-disabled");d=b.element.find(":wijmo-wijtreecheck");d.length&&d.wijtreecheck("option","disabled",c)}a.Widget.prototype._setOption.apply(b,arguments);e===true&&b._setHitArea(c)},_initState:function(){var a=this;a._selectedNodes=[];a._checkedNodes=[];a._enabled=true;a._insertPosition="unKnown";a.nodeWidgetName="wijtreenode"},_createTree:function(){var b=this,e=b.options,c=[],d="wijmo-wijtree ui-widget ui-widget-content ui-helper-clearfix ui-corner-all";if(b.element.is("ul")){b.$nodes=b.element;b.element.wrap("<div></div>");b.widgetDom=b.element.parent()}else if(b.element.is("div")){b.widgetDom=b.element;b.$nodes=b.widgetDom.children("ul:eq(0)")}if(b.$nodes.length){b.widgetDom.addClass(d).attr({role:"tree","aria-multiselectable":true});b.$nodes.addClass("wijmo-wijtree-list ui-helper-reset");c=b._createChildNodes();b._hasChildren=c.length>0;b._setField("nodes",c);b.nodes=c;b.widgetDom.append(a("<div>").css("clear","both"))}e.disabled&&b.disable()},_createChildNodes:function(){var b=this,d={},c=[];b.$nodes.children("li").each(function(){var e=a(this);b._createNodeWidget(e,d);c.push(b._getNodeWidget(a(this)))});return c},_createNodeWidget:function(c,b){var e=this,d=e.nodeWidgetName;if(a.fn[d]){c.data("owner",this);if(!!b&&a.isPlainObject(b)){a.extend(b,{treeClass:this.widgetBaseClass});c[d](b)}else c[d]({treeClass:this.widgetBaseClass})}return c},_attachEvent:function(){var b=this;b.element.bind(a.browser.msie?"focusin.":"focus."+b.widgetName,a.proxy(b._onFocus,b)).bind("mouseover."+this.widgetName,a.proxy(b._onMouseOver,b));b.options.allowDrop&&b._attachDroppable()},_attachDroppable:function(){var b=this,e=b.options,d={accept:"li",scope:"tree"},f=function(a){e.showCheckBoxes&&e.allowTriState&&!a.element.is(":"+b.widgetBaseClass)&&a._getField("nodes").length>0&&a._getField("nodes")[0]._setParentCheckState()},c=e.droppable;a.extend(d,c);d.drop=function(o,d){var l=d.draggable,g=b._getNodeWidget(l),j,k,e,h,p,m,n,i=-1;if(b._trigger("nodeBeforeDropped",o,d)===false||!g)return;j=g._dropTarget;k=g._insertPosition;if(j&&k!=="unKnown"){e=l.data("owner");if(e)n=l.index();if(k==="end"){i=j._getField("nodes").length;h=j}else if(k==="before"||k==="after"){h=j._getField("owner");p=h._getField("nodes");m=a.inArray(j,p);if(m!==-1)i=k==="before"?m:m+1}if(c&&a.isFunction(c.drop)){d.oldParent=e.element;d.newParent=h.element;d.oldIndex=n;d.newIndex=i;c.drop.call(b.element,o,d)}else{e&&e.remove(l);i!==-1&&h.add(l,i)}a("a:eq(0)",l).blur();g._tree._isDragging=false;g.options.selected&&g._setSelected(false);f(e);f(h);a.extend(d,{sourceParent:e?e.element:null,sIndex:n,targetParent:h.element,tIndex:i,widget:g});b._trigger("nodeDropped",o,d)}};b.widgetDom.droppable(d)},_attachNodeEvent:function(){this.element.bind("click."+this.widgetName,a.proxy(this._onClick,this)).bind("mouseout."+this.widgetName,a.proxy(this._onMouseOut,this)).bind("keydown."+this.widgetName,a.proxy(this._onKeyDown,this))},_onClick:function(b){this._callEvent(b,"_onClick");a.browser.webkit&&this.widgetDom.focus()},_onFocus:function(a){this._callEvent(a,"_onFocus")},_onKeyDown:function(a){this._callEvent(a,"_onKeyDown")},_onMouseOut:function(a){this._callEvent(a,"_onMouseOut")},_onMouseOver:function(a){this._callEvent(a,"_onMouseOver")},_callEvent:function(b,d){var c=b.target,a;if(c){a=this._getNodeWidgetByDom(c);if(a===null)return;a[d](b)}},_nodeSelector:function(){return":wijmo-wijtreenode"},getSelectedNodes:function(){return this._selectedNodes},getCheckedNodes:function(){var b=this,d=[],c=b.nodeWidgetName;a(b._nodeSelector(),b.element).each(function(){a(this)[c]("option","checked")&&a(this)[c]("option","checkState")!=="indeterminate"&&d.push(a(this))});return d},destroy:function(){var b=this,c=b.$nodes,d="wijmo-wijtree ui-widget ui-widget-content ui-helper-clearfix ui-corner-all";b.widgetDom.removeClass(d);b.widgetDom.data("droppable")&&b.widgetDom.droppable("destroy");c.removeData("nodes").removeClass("wijmo-wijtree-list ui-helper-reset");c.children("li").each(function(){var c=b._getNodeWidget(a(this));c&&c.destroy()});a.Widget.prototype.destroy.apply(this)},add:function(b,f){var c=null,k={},d,g,e=this,h,i,l="<li><a href='{0}'>{1}</a></li>",j;if(typeof b==="string"){d=a(l.replace(/\{0\}/,"#").replace(/\{1\}/,b));e._createNodeWidget(d,k);c=d.data(d.data("widgetName"))}else if(b.jquery){!b.data("widgetName")&&e._createNodeWidget(b,k);c=b.data(b.data("widgetName"))}else if(b.nodeType){d=a(b);e._createNodeWidget(d,k);c=d.data(d.data("widgetName"))}else if(a.isPlainObject(b)){d=a(l.replace(/\{0\}/,b.url).replace(/\{1\}/,b.text));e._createNodeWidget(d,b);c=d.data(d.data("widgetName"))}if(c===null)return;g=e._getField("nodes");if(!f||f>g.length)f=g.length;j=c._getField("nodes");c._tree=e;for(h=0;h<j.length;h++)j[h]._tree=e;c._setField("owner",this);i=g.length;if(i>0&&i!==f)c.element.get(0)!==g[f].element.get(0)&&c.element.insertBefore(g[f].element);else e.$nodes.append(c.element);e._changeCollection(f,c);e._refreshNodesClass()},remove:function(b){var a=-1,d,c;if(b.jquery)a=b.index();else if(typeof b==="number")a=b;c=this._getField("nodes");if(a<0||a>=c.length)return;d=c[a];d.element.detach();this._changeCollection(a);this._refreshNodesClass()},_changeCollection:function(c,a){var b=this._getField("nodes");if(a)b.splice(c,0,a);else b.splice(c,1)},findNodeByText:function(c){var b=a(".wijmo-wijtree-node a>span",this.$nodes).filter(function(){return a(this).text()===c});return b.length?this._getNodeWidgetByDom(b.get(0)):null},_setAllowDrag:function(f){var c=this,b,d=c._nodeSelector(),e=c.nodeWidgetName;if(f){b=c.element.find(d);b.each(function(){var b=a(this).data(e);if(!a(this).data("draggable")&&!b.$navigateUrl.data("events").mousedown)b.$navigateUrl.one("mousedown",b,b._onMouseDown)})}else{b=c.element.find(d+":ui-draggable");b.draggable("destroy")}},_setAllowDrop:function(a){if(a)!this.widgetDom.data("droppable")&&this._attachDroppable();else this.widgetDom.droppable&&this.widgetDom.droppable("destroy")},_setCheckBoxes:function(c){var b=this;b.$nodes.children("li").each(function(){var d=b._getNodeWidget(a(this));d!==null&&d._setCheckBoxes(c)})},_setHitArea:function(c){var b=this;b.$nodes.children("li").each(function(){var d=b._getNodeWidget(a(this));d!==null&&d._setHitArea(c)})},_getNodeWidget:function(a){return a.is(this._nodeSelector())?a.data(a.data("widgetName")):null},_getNodeWidgetByDom:function(b){var a=this._getNodeByDom(b);return this._getNodeWidget(a)},_getNodeByDom:function(b){return a(b).closest(this._nodeSelector())},_refreshNodesClass:function(){for(var b=this._getField("nodes"),a=0;a<b.length;a++)b[a]._initNodeClass()},_getField:function(a){return this.element.data(a)},_setField:function(b,a){return this.element.data(b,a)}})})(jQuery);(function(a){a.widget("wijmo.wijtreenode",{options:{accessKey:"",checked:false,collapsedIconClass:"",expanded:false,expandedIconClass:"",itemIconClass:"",navigateUrl:"",selected:false,text:"",toolTip:""},_setOption:function(e,c){var b=this,d;switch(e){case"accessKey":b.$navigateUrl!==null&&b.$navigateUrl.attr("accesskey",c);break;case"checked":b._checkState=c?"checked":"unChecked";b._setChecked(c);break;case"collapsedIconClass":case"expandedIconClass":case"itemIconClass":b.options[e]=c;b._initNodeImg();break;case"expanded":b._setExpanded(c);break;case"selected":b._setSelected(c);break;case"text":b._setText(c);break;case"toolTip":b._setToolTip(c);break;case"navigateUrl":b._setNavigateUrlHref(c);break;case"disabled":if(b._isClosestDisabled()&&c===true)return;d=b.element.find(":wijmo-wijtreecheck");d.length&&d.wijtreecheck("option","disabled",c)}a.Widget.prototype._setOption.apply(b,arguments)},_initState:function(){this._tree=null;this._dropTarget=null;this._checkState="unChecked";this._value=this._text=this._navigateUrl="";this._insertPosition="unKnown";this._hasNodes=false},_create:function(){this._initState();this._createTreeNode();this._initNode();this.element.data("widgetName",this.widgetName)},_createTreeNode:function(){var c=this.element,b=this,d=[];this.$navigateUrl=c.children("a");if(b._tree===null)b._tree=b._getTree();b.$nodeBody=null;b.$checkBox=null;b.$nodeImage=a("<span>");b.$hitArea=null;b.$nodes=null;b.$nodeBody=a("<div>").attr({role:"treeitem","aria-expanded":false,"aria-checked":false,"aria-selected":false});if(b._tree.options.showCheckBoxes===true)b.$checkBox=a("<div>");if(b.$navigateUrl.length===0){b.$navigateUrl=c.children("div");b.$navigateUrl.addClass("wijmo-wijtree-template");b._isTemplate=true}if(b.$navigateUrl.length===0){b.$navigateUrl=a("<a>");b.$navigateUrl.attr("href","#")}if(!b._isTemplate){b.$text=b.$navigateUrl.find("span:eq(0)");if(b.$text.length===0){b.$navigateUrl.wrapInner("<span></span>");b.$text=b.$navigateUrl.find("span:eq(0)")}}b._hasChildren=b._getChildren();b.$inner=a("<span></span>").addClass("ui-helper-clearfix wijmo-wijtree-inner ui-corner-all");d=b._createChildNodes(c);b.$inner.append(b.$nodeImage);if(b.$checkBox!==null){b.$inner.append(b.$checkBox);b.$checkBox.wijtreecheck()}b.$inner.append(b.$navigateUrl);b.$nodeBody.append(b.$inner);b._setField("nodes",d);c.prepend(b.$nodeBody)},_createChildNodes:function(c){var b=this,d=[];if(b._hasChildren){c.addClass("wijmo-wijtree-parent");b.$nodeBody.addClass("wijmo-wijtree-node wijmo-wijtree-header ui-state-default");b.$hitArea=a("<span>");b.$inner.prepend(b.$hitArea);b.$nodes=c.find("ul:eq(0)").addClass("wijmo-wijtree-list ui-helper-reset wijmo-wijtree-child");d=b._createChildNode()}else{c.addClass("wijmo-wijtree-item");b.$nodeBody.addClass("wijmo-wijtree-node ui-state-default")}return d},_createChildNode:function(){var b=this,c=[];b.$nodes.children().filter("li").each(function(f){var e=a(this),d;e.data("owner",b);e.wijtreenode(b.options);d=b._getNodeWidget(e);d._index=f;c.push(d)});return c},_initNode:function(){var a=this,b=a.options;if(!a._initialized){a._initialized=true;a._initNavigateUrl();if(!a._isTemplate&&a.$text){a._text=a.$text.html();b.text=a.$text.html()}a._hasChildren=a._getChildren();a._initNodesUL();a._initNodeClass();a._initNodeImg();a._initCheckBox();a.$navigateUrl.one("mousedown",a,a._onMouseDown)}},_initNodeClass:function(){var b=this,c=b.options,d="ui-icon "+(c.expanded?"ui-icon-triangle-1-se":"ui-icon-triangle-1-e");if(b._tree.options.showExpandCollapse)if(b._hasChildren||!!c.hasChildren){if(b.$hitArea!==null)b.$hitArea.removeClass("ui-icon ui-icon-triangle-1-se ui-icon-triangle-1-e").addClass(d);else{b.$hitArea=a("<span>").addClass(d).prependTo(b.$inner);b.element.removeClass("wijmo-wijtree-node ui-state-default ui-corner-all").addClass("wijmo-wijtree-parent")}b._hasChildren&&b.$nodes[c.expanded?"show":"hide"]()}else if(b.$hitArea){b.$hitArea.remove();b.$hitArea=null;b.element.removeClass("wijmo-wijtree-parent").addClass("wijmo-wijtree-node ui-state-default ui-corner-all")}c.selected&&b.$inner&&b.$inner.addClass("ui-state-active")},_initCheckBox:function(){var a=this,b=a.options;if(a.$checkBox&&b.checkState)switch(b.checkState){case"checked":a.$checkBox.wijtreecheck("option","checkState","check");break;case"indeterminate":a.$checkBox.wijtreecheck("option","checkState","triState");break;case"unChecked":a.$checkBox.wijtreecheck("option","checkState","unCheck");break;default:a.$checkBox.wijtreecheck("option","checkState","unCheck")}},_initNodesUL:function(){var a=this;if(a._tree.options.showExpandCollapse)a._hasChildren&&a.$nodes[a._expanded?"show":"hide"]()},_initNavigateUrl:function(){var a=this,b=a.$navigateUrl.attr("href");a.$navigateUrl.bind("blur."+a.widgetName,a,a._onBlur);if(!this._isTemplate){a._navigateUrl=!!b?b:"";a._setNavigateUrlHref(b)}},_initNodeImg:function(){var b=this,c=b.options,d=b.element;if(b.$nodeImage===null||!b.$nodeImage.length)b.$nodeImage=a("<span>");if(d.attr("expandediconclass")){c.expandedIconClass=d.attr("expandediconclass");d.removeAttr("expandediconclass")}if(d.attr("collapsediconclass")){c.collapsedIconClass=d.attr("collapsediconclass");d.removeAttr("collapsediconclass")}if(d.attr("itemiconclass")){c.itemIconClass=d.attr("itemiconclass");d.removeAttr("itemiconclass")}if(c.collapsedIconClass!==""&&c.expandedIconClass!==""){b.$nodeImage.removeClass().addClass("ui-icon").addClass(c.expanded?c.expandedIconClass:c.collapsedIconClass);!b._tree.options.showExpandCollapse&&b.$nodeImage.addClass(c.expandedIconClass);b.$nodeImage.insertBefore(b.$checkBox)}else if(c.itemIconClass!==""){b.$nodeImage.removeClass().addClass("ui-icon");b.$nodeImage.addClass(c.itemIconClass);b.$nodeImage.insertBefore(b.$checkBox)}},_setNavigateUrlHref:function(a){if(this.$navigateUrl){if(a===""||typeof a==="undefined")a="#";this.$navigateUrl.attr("href",a)}},_editNode:function(){this._tree._editMode=true;this.$navigateUrl.hide();if(!this.$editArea)this.$editArea=a("<input>").wijtextbox();this.$editArea.val(this.$text.html());this.$editArea.insertBefore(this.$navigateUrl);this.$editArea.bind("blur",this,this._editionComplete);this.$editArea.focus()},_editionComplete:function(c){var a=c.data,b;a._tree._editMode=false;if(a.$editArea){b=a.$editArea.val();a.$editArea.remove()}a.$navigateUrl.show();a.$editArea=null;a._changeText(b)},_changeText:function(b){var a=this,c=a.options;if(a.$text!==null&&b!==""){a.$text.text(b);c.text=b;a._tree._trigger("nodeTextChanged",null,a)}},_expandCollapseItem:function(){var a=this,b=a.options;if(!a._tree.options.disabled&&!a._isClosestDisabled())(a._hasChildren||b.hasChildren)&&a._setExpanded(!b.expanded)},_expandNode:function(c){var a=this,b=a._tree.options;if(!b.disabled&&!a._isClosestDisabled())if(c)if(b.expandDelay>0){if(typeof a._expandTimer!=="undefined")a._expandTimer=window.clearTimeout(a._expandTimer);a._expandTimer=window.setTimeout(function(){a._expandNodeVisually()},b.expandDelay)}else a._expandNodeVisually();else if(b.collapseDelay>0){a._collapseTimer=window.clearTimeout(a._collapseTimer);a._collapseTimer=window.setTimeout(function(){a._collapseNodeVisually()},b.collapseDelay)}else a._collapseNodeVisually()},_expandNodeVisually:function(){var b=this,d,c=b.options;if(b._tree.options.autoCollapse){d=b.element.siblings(":"+this.widgetBaseClass);a.each(d,function(c){var a=b._getNodeWidget(d[c]);a.options.expanded&&a._setExpanded(false)})}c.collapsedIconClass!==""&&c.expandedIconClass!==""&&b.$nodeImage.removeClass(c.collapsedIconClass).addClass(c.expandedIconClass);b._internalSetNodeClass(true);b._show()},_collapseNodeVisually:function(){var a=this;a.options.collapsedIconClass!==""&&a.options.expandedIconClass!==""&&a.$nodeImage.removeClass(a.options.expandedIconClass).addClass(a.options.collapsedIconClass);a._internalSetNodeClass(false);a._hide()},_internalSetNodeClass:function(a){this.$hitArea.removeClass("ui-icon ui-icon-triangle-1-se ui-icon-triangle-1-e").addClass("ui-icon "+(a?"ui-icon-triangle-1-se":"ui-icon-triangle-1-e"))},_show:function(){this._animation(true)},_hide:function(){this._animation(false)},_animation:function(d){var b=this,e=b.$nodes,c=d?"expandAnimation":"collapseAnimation",g=d?"nodeExpanded":"nodeCollapsed",f,c=b._tree.options[c];if(e)if(c){f=c.animated||c.effect;if(a.effects&&!!f)e[d?"show":"hide"](f,{},c.duration,function(){b._tree._trigger(g,null,b)});else e[d?"show":"hide"](c.duration,function(){b._tree._trigger(g,null,b)})}else{e[d?"show":"hide"]();b._tree._trigger(g,null,b)}},_getBounds:function(a){var b=a.height(),e=a.width(),d=a.offset().top,c=a.offset().left;return{h:b,w:e,t:d,l:c}},_isMouseInsideRect:function(b,a){return b.x<a.l||b.x>=a.l+a.w?false:b.y<=a.t+1||b.y>=a.t+a.h?false:true},_getNodeByMouseOn:function(b){a("li").each(function(){var c=this._getBounds(a(this));if(a.ui.isOver(b.y,b.x,c.t,c.l,c.h,c.w))return a(this)});return null},_drowTemplate:function(b,e,d){var c="unKnown",f=d.is(".wijmo-wijtree-node")?d:d.children(".wijmo-wijtree-node"),a=this._getBounds(f);e.width(f.width());if(b.y>a.t&&b.y<a.t+a.h/2){e.offset({left:a.l,top:a.t});c="before"}else if(b.y>a.t+a.h/2&&b.y<a.t+a.h){e.offset({left:a.l,top:a.t+a.h});c="after"}return c},_beginDrag:function(i){var b=this,h=b.element,e,g=b._tree.options,d=g.draggable,f={cursor:"point",cursorAt:{top:15,left:-25},helper:function(){return a("<div>"+b.$navigateUrl.html()+"</div>").addClass("ui-widget-header ui-corner-all")},distance:a.browser.msie?1:10,handle:b.$navigateUrl,scope:"tree"},c=a("<div>").addClass("wijmo-wijtree-insertion ui-state-default");if(typeof g.dropVisual==="string"){e=a(g.dropVisual);c=e.length?e:c}else if(a.isFunction(g.dropVisual)){e=a(g.dropVisual.call());c=e.length?e:c}c.hide();a.extend(f,d);f.start=function(e,f){b._tree._isDragging=true;b._tree.widgetDom.prepend(c);b._tree._trigger("nodeDragStarted",e,b);if(d&&a.isFunction(d.start))d.start.call(b.element,e,f);else h.hide()};f.drag=function(e,h){var j=e.srcElement||e.originalEvent.target,g=a(j),f,i={x:e.pageX,y:e.pageY};c&&c.hide();if(g){f=b._getNodeWidget(g);if(f){if(g.closest(".wijmo-wijtree-inner",b.element).length)b._insertPosition="end";else{c.show();b._insertPosition=b._drowTemplate(i,c,f.element)}b._dropTarget=f}}b._tree._trigger("nodeDragging",e,b);d&&a.isFunction(d.drag)&&d.drag.call(b.element,e,h)};f.stop=function(e,f){c.remove();b._dropTarget=null;b._insertPosition="unKnown";if(d&&a.isFunction(d.stop))d.stop.call(b.element,e,f);else{h.show();b._resetDrag()}};h.draggable(f).trigger(i);a.browser.mozilla&&b._setFocused(true)},_resetDrag:function(){var a=this,c,b;!a._tree.options.allowDrag&&a.element.data("draggable")&&a.element.draggable("destroy");c=a._getField("nodes");for(b=0;b<c.length;b++)c[b]._resetDrag()},_checkClick:function(){var a=this,b=a.options;if(!a._tree.options.disabled&&!a._isClosestDisabled()){if(b.checked&&a._checkState==="indeterminate"){a._checkState="checked";a._checkItem()}else{a._checkState=b.checked?"unChecked":"checked";a._setChecked(!b.checked)}a._tree._trigger("nodeCheckChanged",null,a)}},_checkItem:function(){var a=this,c=false,b=a._tree;if(b===null||!b.options.showCheckBoxes)return;if(b.options.autoCheckNodes&&a._checkState!=="indeterminate"){c=true;a._changeCheckState(a.options.checked)}b.options.allowTriState&&a._setParentCheckState();a[a.options.checked?"_checkNode":"_unCheckNode"](c)},_checkNode:function(e){var a=this,d=a.options,c=this._getField("nodes"),b;if(a._checkState==="checked"){a.$checkBox.wijtreecheck("option","checkState","check");d.checkState="checked"}else if(a._checkState==="indeterminate"){a.$checkBox.wijtreecheck("option","checkState","triState");d.checkState="indeterminate"}if(e)for(b=0;b<c.length;b++)c[b]._checkNode(true)},_unCheckNode:function(c){var b=this._getField("nodes"),d=this.options,a;this.$checkBox.wijtreecheck("option","checkState","unCheck");d.checkState="unChecked";if(c)for(a=0;a<b.length;a++)b[a]._unCheckNode(true)},_changeCheckState:function(b){var c=this._getField("nodes");a.each(c,function(c,a){a.options.checked=b;a.$nodeBody.attr("aria-checked",b);a._checkState=b?"checked":"unChecked";a._changeCheckState(b)})},_setParentCheckState:function(){var a=this._getOwner(),c,e=true,d=false,f=false,b,g=this;if(a.element.is(":"+g.options.treeClass))return;c=a._getField("nodes");for(b=0;b<c.length;b++){if(c[b]._checkState==="indeterminate")f=true;if(c[b].options.checked)d=true;else e=false;if(!e&&d)break}if(f){a._checkState="indeterminate";a._setChecked(true)}else if(d){if(e){a._checkState="checked";a._checkNode(false)}else a._checkState="indeterminate";a._setChecked(true)}else{a._checkState="unChecked";a._setChecked(false);a._unCheckNode(false)}a._setParentCheckState()},_onKeyDown:function(b){var d=a(b.target),c=this;d.closest(".wijmo-wijtree-inner",c.element).length>0&&c._keyAction(b)},_onClick:function(b){var d=a(b.target),c=this;if(d.closest(".wijmo-checkbox",c.element).length>0){c._checkClick(b);b.preventDefault();b.stopPropagation()}else if(d.hasClass("ui-icon-triangle-1-se")||d.hasClass("ui-icon-triangle-1-e")){c._expandCollapseItem(b);b.preventDefault();b.stopPropagation()}else d.closest(".wijmo-wijtree-inner",c.element).length>0&&c._click(b)},_onMouseDown:function(b){var d=a(b.target),c=b.data;if(c._tree.options.allowDrag)d.closest(".wijmo-wijtree-node",c.element).length>0&&c._beginDrag(b)},_onMouseOver:function(c){var e=a(c.target),b=this,d=a(c.relatedTarget);if(e.closest(".wijmo-wijtree-inner",b.element).length>0&&(this._tree._overNode!==b||d.is(":"+this.widgetBaseClass))){b._mouseOver(c);this._tree._overNode=b}b._mouseOverHitArea(c)},_onMouseOut:function(b){var f=a(b.target),c=this,e=a(b.relatedTarget),d=this._getNodeWidget(e);if(f.closest(".wijmo-wijtree-inner",c.element).length>0&&(this._tree._overNode!==d||e.is(":"+this.widgetBaseClass))){c._mouseOut(b);if(!d)this._tree._overNode=null}c._mouseOutHitArea(b)},_onFocus:function(d){var c=a(d.target),b=this;if(c.closest(".wijmo-wijtree-inner",b.element).length>0&&!b._tree.options.disabled&&!b._isClosestDisabled()&&!(c.hasClass("ui-icon-triangle-1-se")||c.hasClass("ui-icon-triangle-1-e"))&&!c.closest(".wijmo-checkbox",b.element).length){b._tree._focusNode&&b._tree._focusNode.$navigateUrl.blur();b._focused=true;b._tree._focusNode=this;b.$inner.addClass("ui-state-focus")}},_onBlur:function(c){var d=a(c.target),b=c.data;if(!b._tree.options.disabled&&!b._isClosestDisabled()){b._focused=false;d.closest(".wijmo-wijtree-inner",b.element).length>0&&b.$inner.removeClass("ui-state-focus");b._tree._trigger("nodeBlur",c,b)}},_click:function(c){var a=this,d=a.options,b=a._tree;if(!b.options.disabled&&!a._isClosestDisabled()){if(!/^[#,\s]*$/.test(a._navigateUrl))return;a._isClick=true;b._ctrlKey=c.ctrlKey;if(d.selected&&b._ctrlKey)a._setSelected(false);else if(d.selected&&b.options.allowEdit&&!a._isTemplate)a._editNode();else a._setSelected(!d.selected);if(!a._isTemplate){c.preventDefault();c.stopPropagation()}}else a._setNavigateUrlHref("")},_selectNode:function(e,f){var b=this,d,c;if(!b._tree.options.disabled&&!b._isClosestDisabled()&&!b._tree._isDragging){d=b._tree._ctrlKey;if(d){c=a.inArray(b,b._tree._selectedNodes);if(c!==-1&&!e){b._tree._selectedNodes.splice(c,1);b.$inner.removeClass("ui-state-active")}}else{a.each(b._tree._selectedNodes,function(b,a){a.$inner.removeClass("ui-state-active");a.options.selected=false;a.$nodeBody.attr("aria-selected",false)});b._tree._selectedNodes=[]}if(e){c=a.inArray(b,b._tree._selectedNodes);c===-1&&this._tree._selectedNodes.push(b);b.$inner.addClass("ui-state-active")}else b.$inner.removeClass("ui-state-active");b._isClick&&b._tree._trigger("nodeClick",f,b);b._isClick=false;b._tree._ctrlKey=false;b._tree._trigger("selectedNodeChanged",f,b)}},_keyAction:function(c){var d=c.target,b=this;if(b._tree.options.disabled||b._isClosestDisabled())return;if(d){if(b._tree._editMode&&c.keyCode!==a.ui.keyCode.ENTER)return;switch(c.keyCode){case a.ui.keyCode.UP:b._moveUp();break;case a.ui.keyCode.DOWN:b._moveDown();break;case a.ui.keyCode.RIGHT:b._tree.options.showExpandCollapse&&b._moveRight();break;case a.ui.keyCode.LEFT:b._tree.options.showExpandCollapse&&b._moveLeft();break;case 83:!b._tree._editMode&&b._tree.options.allowSorting&&b.sortNodes();break;case 113:b._tree.options.allowEdit&&b._editNode();break;case 109:b._tree.options.showExpandCollapse&&this._expanded&&b._setExpanded(false);break;case 107:b._tree.options.showExpandCollapse&&!this._expanded&&b._setExpanded(true);break;case a.ui.keyCode.ENTER:if(b._tree._editMode){c.data=b;b._editionComplete(c)}break;case a.ui.keyCode.SPACE:if(b._tree.options.showCheckBoxes){b._checkState=b.options.checked?"unChecked":"checked";b._setChecked(!b.options.checked)}}b._customKeyDown(c.keyCode);if(!b._isTemplate){c.preventDefault();c.stopPropagation()}}},_customKeyDown:function(){},_prevNode:function(a){if(a.element.prev().length>0)return a.element.prev().data(this.widgetName)},_nextNode:function(a){if(a.element.next().length>0)return a.element.next().data(this.widgetName)},_getNextExpandedNode:function(c){var d=c,a=c._getField("nodes"),b;if(c._expanded&&a.length>0){b=a[a.length-1];if(b!==null)d=this._getNextExpandedNode(b)}return d},_getNextNode:function(b){var a=null,c=this;if(b.element.is(":"+c.options.treeClass))return null;a=c._nextNode(b);return a?a:c._getNextNode(b._getOwner())},_moveUp:function(){var b=this._getCurrentLevel(),a=this._prevNode(this);if(!a)b>0&&this._getOwner()._setFocused(true);else this._getNextExpandedNode(a)._setFocused(true)},_moveDown:function(){var c=this._getField("nodes"),b,d,a;if(this._expanded&&c.length>0)c[0]._setFocused(true);else{b=this._nextNode(this);if(b)b._setFocused(true);else{d=this._getOwner();a=this._getNextNode(d);a&&a._setFocused(true)}}},_moveLeft:function(){var a=this._getOwner();if(this._expanded)this._setExpanded(false);else a!==null&&!a.element.is(":"+this.options.treeClass)&&a._setFocused(true)},_moveRight:function(){if(this._hasChildren)if(!this._expanded)this._setExpanded(true);else{var a=this._getField("nodes")[0];a!==null&&a._setFocused(true)}},_mouseOver:function(c){var a=this,b=a._tree;if(!b.options.disabled&&!a._isClosestDisabled()&&!b._editMode){a._mouseOverNode();!b._isDragging&&b._trigger("nodeMouseOver",c,a)}},_mouseOut:function(c){var a=this,b=a._tree;if(!b.options.disabled&&!a._isClosestDisabled()&&!b._editMode){a._mouseOutNode();!b._isDragging&&b._trigger("nodeMouseOut",c,a)}},_mouseOverNode:function(){if(this.$inner!==null&&!this._isOverNode){this.$inner.addClass("ui-state-hover");this._isOverNode=true}},_mouseOutNode:function(){if(this.$inner!==null&&this._isOverNode){this.$inner.removeClass("ui-state-hover");this._isOverNode=false}},_mouseOverHitArea:function(c){var b,e,a=this,d=a._tree;if(!d.options.disabled&&!a._isClosestDisabled())if(d.options.expandCollapseHoverUsed)if(a._hasChildren&&!a._isOverHitArea){b=a._getBounds(a.element);e={x:c.pageX,y:c.pageY};if(a._isMouseInsideRect(e,b)){a._isOverHitArea=true;a._setExpanded(true)}}},_mouseOutHitArea:function(c){var e={x:c.pageX,y:c.pageY},b,a=this,d=a._tree;if(!d.options.disabled&&!a._isClosestDisabled())if(d.options.expandCollapseHoverUsed)if(a._hasChildren&&!!a._isOverHitArea){b=a._getBounds(a.element);if(!a._isMouseInsideRect(e,b)){a._isOverHitArea=false;a._setExpanded(false)}}else if(a._getOwner().element.is(":"+a.widgetBaseClass)){b=a._getBounds(a._getOwner().element);if(!a._isMouseInsideRect(e,b)){a._getOwner()._isOverHitArea=false;a._getOwner()._setExpanded(false)}}},destroy:function(){var b=this,c;b.element.data("draggable")&&b.element.draggable("destroy");b.$hitArea&&b.$hitArea.remove();b.$checkBox&&b.$checkBox.remove();b.$nodeImage&&b.$nodeImage.remove();b.$navigateUrl.unwrap().unwrap().removeClass("ui-state-default ui-state-active").unbind("mousedown").unbind("blur");c=this.element.find("ul:first").show();c.removeClass();c.children("li").each(function(){var c=b._getNodeWidget(a(this));c.destroy()});b.element.removeData("nodes").removeData("owner").removeData("widgetName").removeClass();a.Widget.prototype.destroy.apply(this)},add:function(c,f){var d=null,e,g,b=this,j,h,k="<li><a href='{0}'>{1}</a></li>",i;if(typeof c==="string"){e=a(k.replace(/\{0\}/,"#").replace(/\{1\}/,c));b._createNodeWidget(e);d=e.data(e.data("widgetName"))}else if(c.jquery){!c.data("widgetName")&&b._createNodeWidget(c);d=c.data(c.data("widgetName"))}else if(c.nodeType){e=a(c);b._createNodeWidget(e);d=e.data(e.data("widgetName"))}else if(a.isPlainObject(c)){e=a(k.replace(/\{0\}/,c.url).replace(/\{1\}/,c.text));b._createNodeWidget(e,c);d=e.data(e.data("widgetName"))}if(d===null)return;g=b._getField("nodes");if(!f||f>g.length)if(f!==0)f=g.length;j=d._getField("nodes");d._tree=b._tree;for(h=0;h<j.length;h++)j[h]._tree=b._tree;d._setField("owner",b);i=g.length;if(!b.$nodes){b.$nodes=a("<ul></ul>").addClass("wijmo-wijtree-list ui-helper-reset wijmo-wijtree-child");b.element.append(b.$nodes)}if(i>0&&i!==f)d.element.get(0)!==g[f].element.get(0)&&d.element.insertBefore(g[f].element);else b.$nodes.append(d.element);b._changeCollection(f,d);b._collectionChanged("add")},remove:function(b){var a=-1,c,e=this,d=this._getField("nodes");if(b.jquery)a=b.index();else if(typeof b==="number")a=b;if(a<0||a>=d.length)return;c=d[a];c.element.detach();e._changeCollection(a);e._collectionChanged("remove")},_changeCollection:function(c,a){var b=this._getField("nodes");if(a)b.splice(c,0,a);else b.splice(c,1)},sortNodes:function(){var b=this._getField("nodes");this._sort();a.each(b,function(b,a){a._index=b;a._insertBefore(b)});this._refreshNodesClass()},check:function(a){this._setOption("checked",a)},select:function(a){this._setOption("selected",a)},expand:function(){this._setOption("expanded",true)},collapse:function(){this._setOption("expanded",false)},_insertBefore:function(a){var b=this.element.parent().children("li");this.element.index()!==a&&this.element.insertBefore(b.eq(a))},_sort:function(){var a=this._getField("nodes");if(this._isSorted)if(!this._isDecsSort){a.sort(this._compare2NodeTextAcs);this._isDecsSort=true}else{a.sort(this._compare2NodeTextDesc);this._isDecsSort=false}else{a.sort(this._compare2NodeTextAcs);this._isSorted=true;this._isDecsSort=true}},_compare2NodeTextAcs:function(a,b){if(a!==null&&b!==null)return a._text.localeCompare(b._text)},_compare2NodeTextDesc:function(a,b){if(a!==null&&b!==null)return-1*a._text.localeCompare(b._text)},_collectionChanged:function(){this._hasChildren=this._getChildren();this._initNodeClass();this._refreshNodesClass()},_refreshNodesClass:function(){for(var b=this._getField("nodes"),a=0;a<b.length;a++)b[a]._initNodeClass()},_setChecked:function(b){var a=this;if(a.options.checked===b&&a._checkState!=="indeterminate")return;a.options.checked=b;a.$nodeBody.attr("aria-checked",b);this._checkItem()},_isClosestDisabled:function(){var a=this;return a.element.closest(".wijmo-wijtree-disabled,.wijmo-wijtreenode-disabled",a._tree.element).length?true:false},_setExpanded:function(b){var a=this;if(a._expanded===b)return;if(a._hasChildren){a._expanded=b;a.options.expanded=b;a.$nodeBody.attr("aria-expanded",b);a._expandNode(b)}},_setFocused:function(b){if(b){this.$navigateUrl.focus();(a.browser.msie||a.browser.webkit)&&this._setFocusNode()}else this.$navigateUrl.blur()},_setFocusNode:function(){this._tree._focusNode&&a.browser.webkit&&this._tree._focusNode.$navigateUrl.blur();this._focused=true;this._tree._focusNode=this;this.$inner.addClass("ui-state-focus")},_setToolTip:function(a){if(a.length)this.element.attr("title",a);else this.element.removeAttr("title")},_setText:function(a){if(this._text!==a&&a.length){this._text=a;this._changeText(a)}},_setSelected:function(a){var b=this,c=b.options;if(c.selected!==a){c.selected=a;b.$nodeBody.attr("aria-selected",a);b._selectNode(a);b._setFocused(a)}},_setCheckBoxes:function(c){var b=this;b.$checkBox&&b.$checkBox[c?"show":"hide"]();b.$nodes&&b.$nodes.children("li").each(function(){var d=b._getNodeWidget(a(this));d!==null&&d._setCheckBoxes(c)})},_setHitArea:function(c){var b=this;if(b._hasChildren)if(c){b._initNodeClass();b.$hitArea&&b.$hitArea.show()}else{b._expanded=true;b.options.expanded=true;b.$nodeBody.attr("aria-expanded",true);b.$nodes&&b.$nodes.show();b._initNodeClass();b.$hitArea&&b.$hitArea.hide()}b.$nodes&&b.$nodes.children("li").each(function(){var d=b._getNodeWidget(a(this));d!==null&&d._setHitArea(c)})},_getOwner:function(){return this._getField("owner")},_getTree:function(){var a=this._getOwner();return a?a.element.is(":"+this.options.treeClass)?a:a._getTree():null},_getInitElement:function(){var b=a("<li>"),d=this,e=a("<ul>"),c=d._getField("nodes");b.append(d.$navigateUrl.clone());if(c.length){b.append(e);a.each(c,function(c,b){var a=b._getInitElement();e.append(a)})}return b},_getChildren:function(){return this.element.find(">ul:first>li").length>0&&this.element.children("ul:first")},_getNodeWidget:function(c){var a=this._getNodeByDom(c),b;if(a.length>0){b=a.data(a.data("widgetName"));return b}return null},_createNodeWidget:function(c,b){if(a.fn.wijtreenode){c.data("owner",this);if(!!b&&a.isPlainObject(b)){a.extend(b,{treeClass:this.options.treeClass});c.wijtreenode(b)}else c.wijtreenode({treeClass:this.options.treeClass})}return c},_getNodeByDom:function(b){return a(b).closest(":"+this.widgetBaseClass)},_getCurrentLevel:function(){return this.element.parentsUntil(":"+this.options.treeClass).length-1},_getField:function(a){return this.element.data(a)},_setField:function(b,a){return this.element.data(b,a)}})})(jQuery);(function(a){var c="ui-icon ui-icon-check",b="ui-icon ui-icon-stop";a.widget("wijmo.wijtreecheck",{options:{checkState:"unCheck"},_create:function(){var b=this,c=this.options;if(b.element.is("div")){b.element.addClass("wijmo-checkbox ui-widget");b.$icon=a("<span>");b.$icon.addClass("wijmo-checkbox-icon");if(c.checkState==="check")b.$icon.addClass("ui-icon ui-icon-check");else c.checkState==="triState"&&b.$icon.addClass("ui-icon ui-icon-stop");b.$body=a("<div></div>").addClass("wijmo-checkbox-box ui-widget ui-corner-all ui-state-default").css({position:"relative"}).append(b.$icon);b.element.append(b.$body);b.element.bind("mouseover.wijtreecheck",function(){!b.options.disabled&&b.$body.removeClass("ui-state-default").addClass("ui-state-hover")}).bind("mouseout.wijtreecheck",function(){!b.options.disabled&&b.$body.removeClass("ui-state-hover").not(".ui-state-focus").addClass("ui-state-default")})}},_setOption:function(f,e){var d=this;if(f==="checkState")if(e==="unCheck"){d.$body.removeClass("ui-state-active");d.$icon.removeClass("ui-icon ui-icon-check ui-icon-stop ui-state-active")}else if(e==="check"){d.$body.addClass("ui-state-active");d.$icon.removeClass(b).addClass(c)}else if(e==="triState"){d.$body.addClass("ui-state-active");d.$icon.removeClass(c).addClass(b)}a.Widget.prototype._setOption.apply(d,arguments)},destory:function(){this.element.children().remove();this.element.removeClass("wijmo-checkbox ui-widget");a.Widget.prototype.destroy.apply(this)}})})(jQuery);
(function(a){"use strict";var o="wijmo-wijupload",g="wijmo-wijupload-fileRow",b="."+g,r="wijmo-wijupload-filesList",q="wijmo-wijupload-commandRow",f="wijmo-wijupload-uploadAll",e="wijmo-wijupload-cancelAll",p="wijmo-wijupload-buttonContainer",j="wijmo-wijupload-upload",c="."+j,i="wijmo-wijupload-cancel",k="."+i,s="wijmo-wijupload-file",d="wijmo-wijupload-progress",h="wijmo-wijupload-loading",t="ui-widget-content",l="ui-corner-all",u="ui-state-highlight",n,m;n=function(l,g,h){var f,c=a("input",g),b=new XMLHttpRequest,d=function(a){if(a.indexOf("\\")>-1)a=a.substring(a.lastIndexOf("\\")+1);return a},k=function(a,b){var c=d(b.val());a.open("POST",h,true);a.setRequestHeader("Wijmo-RequestType","XMLHttpRequest");a.setRequestHeader("Cache-Control","no-cache");a.setRequestHeader("Wijmo-FileName",c);a.setRequestHeader("Content-Type","application/octet-stream");a.send(b.get(0).files[0])},j=function(a){if(a){a.abort();a=null}},i=function(a){if(a)a=null},e;e=function(){var e=this;e.fileRow=g;e.xhr=b;e.inputFile=c;e.upload=function(){k(b,c)};e.cancel=function(){j(b);a.isFunction(e.onCancel)&&e.onCancel()};e.destroy=function(){i(b)};e.updateAction=function(a){h=a};e.onCancel=null;e.onComplete=null;e.onProgress=null;b.upload.onprogress=function(b){if(b.lengthComputable){var f;if(a.isFunction(e.onProgress)){f={supportProgress:true,loaded:b.loaded,total:b.total,fileName:d(c.val())};e.onProgress(f)}}};b.onreadystatechange=function(f){if(b.readyState===4){var d=b.responseText,c;if(a.isFunction(e.onComplete)){c={e:f,response:d,supportProgress:true};e.onComplete(c)}}}};f=new e;return f};m=function(n,j,l){var i,d=a("input",j),m=d.attr("id"),e="wijUploadForm_"+n,b=a("#"+e),g="wijUploadIfm_"+m,f=true,c=a('<iframe id="'+g+'" name="'+g+'">'),k=function(c,a){b.empty();b.attr("target",c.attr("name"));if(a){a.parent().append(a.clone());b.append(a)}b.submit()},p=function(a){a.attr("src","javascript".concat(":false;"))},o=function(a,c){if(c&&b){b.remove();b=null}if(a){a.remove();a=null}},h;if(b.length===0){b=a('<form method="post" enctype="multipart/form-data"></form>');b.attr("action",l).attr("id",e).attr("name",e).appendTo("body")}c.css("position","absolute").css("top","-1000px").css("left","-1000px");c.appendTo("body");h=function(){var e=this;e.fileRow=j;e.iframe=c;e.inputFile=d;e.upload=function(){var b;k(c,d);if(a.isFunction(e.onProgress)){b={supportProgress:false,loaded:1,total:1};e.onProgress(b)}};e.doPost=function(){k(c)};e.cancel=function(){p(c);a.isFunction(e.onCancel)&&e.onCancel()};e.updateAction=function(a){l=a;b.attr("action",a)};e.destroy=function(a){o(c,a)};e.onCancel=null;e.onComplete=null;e.onProgress=null;c.bind("load",function(i){if(!a.browser.safari)if(f){f=false;return}if(c.attr("src")==="javascript".concat(":false;"))return;var g=i.target,d,b,h;try{b=g.contentDocument?g.contentDocument:window.frames[0].document;if(b.XMLDocument)d=b.XMLDocument;else if(b.body)d=b.body.innerHTML;else d=b;if(a.isFunction(e.onComplete)){h={e:i,response:d,supportProgress:false};e.onComplete(h)}}catch(j){d=""}})};i=new h;return i};a.widget("wijmo.wijupload",{options:{action:"",autoSubmit:false,change:null,upload:null,totalUpload:null,progress:null,totalProgress:null,complete:null,totalComplete:null},_create:function(){var a=this,d=a.options,c=+new Date,b=a.supportXhr();a.filesLen=0;a.totalUploadFiles=0;a.useXhr=b;a.id=c;a.element.addClass(o);a._createContainers();a._createUploadButton();a._createFileInput();a._bindEvents();d.disabled&&a.disable()},_setOption:function(d,c){var b=this;a.Widget.prototype._setOption.apply(this,arguments);d==="disabled"&&b._handleDisabledOption(c,b.element)},_handleDisabledOption:function(b,c){var a=this;if(b){if(!a.disabledDiv)a.disabledDiv=a._createDisabledDiv(c);a.disabledDiv.appendTo("body")}else if(a.disabledDiv){a.disabledDiv.remove();a.disabledDiv=null}},_createDisabledDiv:function(d){var g=this,b=d?d:g.element,c=b.offset(),f=b.outerWidth(),e=b.outerHeight();return a("<div></div>").addClass("ui-disabled").css({"z-index":"99999",position:"absolute",width:f,height:e,left:c.left,top:c.top})},destroy:function(){var b=this;b.element.removeClass(o);b.element.undelegate(b.widgetName);b.input.remove();b.addBtn.remove();b.filesList.remove();b.commandRow.remove();if(b.uploaders){a.each(b.uploaders,function(b,a){a.destroy&&a.destroy(true);a=null});b.uploaders=null}if(b.disabledDiv){b.disabledDiv.remove();b.disabledDiv=null}},supportXhr:function(){var a=false;if(typeof(new XMLHttpRequest).upload==="undefined")a=false;else a=true;return a},_createContainers:function(){var b=this,d=a("<ul>").addClass(r).appendTo(b.element),c=a("<div>").addClass(q).appendTo(b.element);b.filesList=d;c.hide();b.commandRow=c;b._createCommandRow(c)},_createCommandRow:function(d){var c=a("<a>").attr("href","#").text("uploadAll").addClass(f).button({icons:{primary:"ui-icon-circle-arrow-n"},label:"Upload All"}),b=a("<a>").attr("href","#").text("cancelAll").addClass(e).button({icons:{primary:"ui-icon-cancel"},label:"Cancel All"});d.append(c).append(b)},_createUploadButton:function(){var b=this,c=a("<a>").attr("href","#").button({label:"Upload files"});c.mousemove(function(a){if(b.input){var c=a.pageX,d=a.pageY;b.input.offset({left:c+10-b.input.width(),top:d+10-b.input.height()})}});b.addBtn=c;b.element.prepend(c)},_createFileInput:function(){var b=this,e=b.addBtn,f=e.offset(),g="wijUpload_"+b.id+"_input"+b.filesLen,d=a("<input>").attr("type","file").prependTo(b.element);b.filesLen++;d.attr("id",g).attr("name",g).css("position","absolute").offset({left:f.left+e.width()-d.width(),top:f.top}).css("z-index","9999").css("opacity",0).height(e.height()).css("cursor","pointer");b.input=d;d.bind("change",function(g){var f,e;if(b._trigger("change",g,a(this))===false)return false;b._createFileInput();f=b._createFileRow(a(this));if(b.options.autoSubmit){e=a(c,f);e&&e.click()}d.unbind("change")});b.uploadAll=false},_createFileRow:function(h){var e=this,c=a("<li>"),r=h.val(),n,m,k,f=a("<span>").addClass(p),q=a("<a>").attr("href","#").text("upload").addClass(j).button({text:false,icons:{primary:"ui-icon-circle-arrow-n"},label:"upload"}),o=a("<a>").attr("href","#").text("cancel").addClass(i).button({text:false,icons:{primary:"ui-icon-cancel"},label:"cancel"});c.addClass(g).addClass(t).addClass(l);c.append(h);h.hide();n=a("<span>"+e._getFileName(r)+"</span>").addClass(s).addClass(u).addClass(l);c.append(n);c.append(f);m=a("<span />").addClass(d);f.append(m);f.append(q).append(o);c.appendTo(e.filesList);k=a(b,e.element);if(k.length){e.commandRow.show();e._createUploader(c);e._resetProgressAll()}return c},_createUploader:function(e){var b=this,g=a("input",e),f=b.options.action,c;if(b.useXhr)c=n(b.id,e,f);else c=m(b.id,e,f);c.onCancel=function(){var a=this,c=b.uploaders[a.inputFile.attr("id")];b._trigger("cancel",null,a.inputFile);b.totalUploadFiles--;b.totalUploadFiles===0&&b.uploadAll&&b._trigger("totalComplete")};if(b._wijUpload()){c.onProgress=function(c){var e=a("."+d,this.fileRow);if(c.supportProgress){e.html(Math.round(1e3*c.loaded/c.total)/10+"%");b._trigger("progress",null,{sender:c.fileName,loaded:c.loaded,total:c.total});b._progressTotal(c.fileName,c.loaded)}else e.addClass(h)};c.onComplete=function(f){var c=this,j=b.uploaders[c.inputFile.attr("id")],g=b._getFileName(c.inputFile.val()),i=b._getFileSize(c.inputFile[0]),e=a("."+d,c.fileRow);b._trigger("complete",f.e,c.inputFile);e.removeClass(h);e.html("100%");b._removeFileRow(c.fileRow,j);b._progressTotal(g,i);b.totalUploadFiles--;b.totalUploadFiles===0&&b.uploadAll&&b._trigger("totalComplete",f.e)}}if(typeof b.uploaders==="undefined")b.uploaders={};b.uploaders[g.attr("id")]=c},_progressTotal:function(f,e){var b=this,a=b.progressAll,c,d;if(!b.uploadAll)return;if(a&&a.loadedSize){a.loadedSize[f]=e;c=b._getLoadedSize(a.loadedSize);d=a.totalSize}b._trigger("totalProgress",null,{loaded:c,total:d})},_getLoadedSize:function(c){var b=0;a.each(c,function(c,a){b+=a});return b},_getTotalSize:function(){var b=this,c=0;b.uploaders&&a.each(b.uploaders,function(d,a){c+=b._getFileSize(a.inputFile[0])});return c},_resetProgressAll:function(){this.progressAll={totalSize:0,loadedSize:{}}},_wijUpload:function(){return true},_wijcancel:function(){},_upload:function(){},_bindEvents:function(){var d=this,g=d.progressAll;d.element.delegate(k,"click."+d.widgetName,function(){var h=a(this),f=h.parents(b),c=a("input",f[0]),e=d.uploaders[c.attr("id")];d._wijcancel(c);d._wijUpload()&&e&&e.cancel();if(g){g.totalSize-=d._getFileSize(c[0]);if(g.loadedSize[c.val()])delete g.loadedSize[c.val()]}d._removeFileRow(f,e)});d.element.delegate(c,"click."+d.widgetName,function(h){var g=a(this),f=g.parents(b),c=a("input",f[0]),e=d.uploaders[c.attr("id")];if(d._trigger("upload",h,c)===false)return false;d.totalUploadFiles++;d._upload(f);e&&d._wijUpload()&&e.upload()});d.element.delegate("."+f,"click."+d.widgetName,function(b){d.uploadAll=true;!d.progressAll&&d._resetProgressAll();if(d._trigger("totalUpload",b,null)===false)return false;d.progressAll.totalSize=d._getTotalSize();d._wijuploadAll(a(c,d.filesList[0]));d._wijUpload()&&a(c,d.filesList[0]).each(function(c,b){a(b).click()})});d.element.delegate("."+e,"click."+d.widgetName,function(){d._resetProgressAll();a(k,d.filesList[0]).each(function(c,b){a(b).click()})})},_wijuploadAll:function(){},_wijFileRowRemoved:function(){},_removeFileRow:function(f,c){var d=this,e,g;if(c)e=c.inputFile.attr("id");f.fadeOut(1500,function(){f.remove();d._wijFileRowRemoved(f);if(d.uploaders[e])delete d.uploaders[e];g=a(b,d.element);if(g.length){d.commandRow.show();c&&c.destroy&&c.destroy()}else{d.commandRow.hide();d._resetProgressAll();c&&c.destroy&&c.destroy(true)}})},_getFileName:function(a){if(a.indexOf("\\")>-1)a=a.substring(a.lastIndexOf("\\")+1);return a},_getFileSize:function(a){if(a.files&&a.files.length>0){var b=a.files[0];if(b.size)return b.size}return 0}})})(jQuery);
(function(a){"use strict";a.widget("wijmo.wijwizard",{options:{navButtons:"auto",autoPlay:false,delay:3e3,loop:false,hideOption:{fade:true},showOption:{fade:true,duration:400},ajaxOptions:null,cache:false,cookie:null,stepHeaderTemplate:"",panelTemplate:"",spinner:"",add:null,remove:null,activeIndexChanged:null,show:null,load:null,validating:null},_defaults:{stepHeaderTemplate:"<li><h1>#{title}</h1>#{desc}</li>",panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>"},_create:function(){this._pageLize(true)},_init:function(){var a=this.options;if(a.disabled)this.disable();else a.autoPlay&&this.play()},_setOption:function(c,b){a.Widget.prototype._setOption.apply(this,arguments);switch(c){case"activeIndex":this.show(b);break;case"navButtons":this._createButtons();break;default:this._pageLize()}},play:function(){var b=this.options,a=this;if(!this.element.data("intId.wijwizard")){var c=window.setInterval(function(){var c=b.activeIndex+1;if(c>=a.panels.length)if(b.loop)c=0;else{a.stop();return}a.show(c)},b.delay);this.element.data("intId.wijwizard",c)}},stop:function(){var a=this.element.data("intId.wijwizard");if(a){window.clearInterval(a);this.element.removeData("intId.wijwizard")}},_normalizeBlindOption:function(a){if(a.blind===undefined)a.blind=false;if(a.fade===undefined)a.fade=false;if(a.duration===undefined)a.duration=200;if(typeof a.duration==="string")try{a.duration=parseInt(a.duration,10)}catch(b){a.duration=200}},_createButtons:function(){var d=this,e=this.options;this._removeButtons();if(e.navButtons==="none")return;if(!this.buttons){var f=e.navButtons;if(f==="auto")f=this.list?"common":"edge";this.buttons=a("<div/>");this.buttons.addClass("wijmo-wijwizard-buttons");var c=function(b,a){if(e.disabled)return;a.is(":not(.ui-state-disabled)")&&a.addClass("ui-state-"+b)},b=function(a,b){if(e.disabled)return;b.removeClass("ui-state-"+a)};if(f==="common"){this.backBtn=a("<a href='#'><span class='ui-button-text'>back</span></a>").addClass("ui-widget ui-button ui-button-text-only ui-state-default ui-corner-all").appendTo(this.buttons).bind({click:function(){d.back();return false},mouseover:function(){c("hover",a(this))},mouseout:function(){b("hover",a(this))},mousedown:function(){c("active",a(this))},mouseup:function(){b("active",a(this))}}).attr("role","button");this.nextBtn=a("<a href='#'><span class='ui-button-text'>next</span></a>").addClass("ui-widget ui-button ui-button-text-only ui-state-default ui-corner-all").appendTo(this.buttons).bind({click:function(){d.next();return false},mouseover:function(){c("hover",a(this))},mouseout:function(){b("hover",a(this))},mousedown:function(){c("active",a(this))},mouseup:function(){b("active",a(this))}}).attr("role","button")}else{this.backBtn=a("<a href='#'/>").addClass("wijmo-wijwizard-prev ui-state-default ui-corner-right").append("<span class='ui-icon ui-icon-triangle-1-w'></span>").appendTo(this.buttons).bind({click:function(){d.back();return false},mouseover:function(){c("hover",a(this))},mouseout:function(){b("hover",a(this))},mousedown:function(){c("active",a(this))},mouseup:function(){b("active",a(this))}}).attr("role","button");this.nextBtn=a("<a href='#'/>").addClass("wijmo-wijwizard-next ui-state-default ui-corner-left").append("<span class='ui-icon ui-icon-triangle-1-e'></span>").appendTo(this.buttons).bind({click:function(){d.next();return false},mouseover:function(){c("hover",a(this))},mouseout:function(){b("hover",a(this))},mousedown:function(){c("active",a(this))},mouseup:function(){b("active",a(this))}}).attr("role","button")}this.buttons.appendTo(this.element)}},_removeButtons:function(){if(this.buttons){this.buttons.remove();this.buttons=undefined}},_pageLize:function(d){var e=this,b=this.options;this.list=this.element.find("ol,ul").eq(0);if(this.list&&this.list.length===0)this.list=null;if(this.list)this.lis=a("li",this.list);if(d){this.panels=a("> div",this.element);var c=/^#.+/;this.panels.each(function(e,d){var b=a(d).attr("src");b&&!c.test(b)&&a.data(d,"load.wijwizard",b.replace(/#.*$/,""))});this.element.addClass("wijmo-wijwizard ui-widget ui-helper-clearfix");if(this.list){this.list.addClass("ui-widget ui-helper-reset wijmo-wijwizard-steps ui-helper-clearfix").attr("role","tablist");this.lis.addClass("ui-widget-header ui-corner-all").attr("role","tab")}this.container=a("<div/>");this.container.addClass("wijmo-wijwizard-content ui-widget ui-widget-content ui-corner-all");this.container.append(this.panels);this.container.appendTo(this.element);this.panels.addClass("wijmo-wijwizard-panel ui-widget-content").attr("role","tabpanel");if(b.activeIndex===undefined){if(typeof b.activeIndex!="number"&&b.cookie)b.activeIndex=parseInt(e._cookie(),10);if(typeof b.activeIndex!="number"&&this.panels.filter(".wijmo-wijwizard-actived").length)b.activeIndex=this.panels.index(this.panels.filter(".wijmo-wijwizard-actived"));b.activeIndex=b.activeIndex||(this.panels.length?0:-1)}else if(b.activeIndex===null)b.activeIndex=-1;b.activeIndex=b.activeIndex>=0&&this.panels[b.activeIndex]||b.activeIndex<0?b.activeIndex:0;this.panels.addClass("wijmo-wijwizard-hide").attr("aria-hidden",true);if(b.activeIndex>=0&&this.panels.length){this.panels.eq(b.activeIndex).removeClass("wijmo-wijwizard-hide").addClass("wijmo-wijwizard-actived").attr("aria-hidden",false);this.load(b.activeIndex)}this._createButtons()}else{this.panels=a("> div",this.container);b.activeIndex=this.panels.index(this.panels.filter(".wijmo-wijwizard-actived"))}this._refreshStep();this._initScroller();b.cookie&&this._cookie(b.activeIndex,b.cookie);b.cache===false&&this.panels.removeData("cache.wijwizard");if(b.showOption===undefined||b.showOption===null)b.showOption={};this._normalizeBlindOption(b.showOption);if(b.hideOption===undefined||b.hideOption===null)b.hideOption={};this._normalizeBlindOption(b.hideOption);this.panels.unbind(".wijwizard")},_initScroller:function(){if(!this.lis)return;var b=0;this.lis.each(function(){b+=a(this).outerWidth(true)});if(this.element.innerWidth()<b){if(this.scrollWrap===undefined){this.list.wrap("<div class='scrollWrap'></div>");this.scrollWrap=this.list.parent();a.effects.save(this.list,["width","height","overflow"])}this.list.width(b+8);this.scrollWrap.height(this.list.outerHeight(true));this.scrollWrap.wijsuperpanel({allowResize:false,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollBarVisibility:"hidden"}})}else this._removeScroller()},_removeScroller:function(){if(this.scrollWrap){this.scrollWrap.wijsuperpanel("destroy").replaceWith(this.scrollWrap.contents());this.scrollWrap=undefined;a.effects.restore(this.list,["width","height","overflow"])}},_refreshStep:function(){var a=this.options;if(this.lis){this.lis.removeClass("ui-priority-primary").addClass("ui-priority-secondary").attr("aria-selected",false);if(a.activeIndex>=0&&a.activeIndex<=this.lis.length-1){this.lis&&this.lis.eq(a.activeIndex).removeClass("ui-priority-secondary").addClass("ui-priority-primary").attr("aria-selected",true);this.scrollWrap&&this.scrollWrap.wijsuperpanel("scrollChildIntoView",this.lis.eq(a.activeIndex))}}if(this.buttons&&!a.loop){this.backBtn[a.activeIndex<=0?"addClass":"removeClass"]("ui-state-disabled").attr("aria-disabled",a.activeIndex===0);this.nextBtn[a.activeIndex>=this.panels.length-1?"addClass":"removeClass"]("ui-state-disabled").attr("aria-disabled",a.activeIndex>=this.panels.length-1)}},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name);return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a){return{panel:a,index:this.panels.index(a)}},_removeSpinner:function(){this.element.removeClass("ui-state-processing");var a=this.element.data("spinner.wijwizard");if(a){this.element.removeData("spinner.wijwizard");a.remove()}},_resetStyle:function(b){b.css({display:""});!a.support.opacity&&b[0].style.removeAttribute("filter")},destroy:function(){var b=this.options;this.abort();this.stop();this._removeScroller();this._removeButtons();this.element.unbind(".wijwizard").removeClass(["wijmo-wijwizard","ui-widget","ui-helper-clearfix"].join(" ")).removeData("wijwizard");this.list&&this.list.removeClass("ui-widget ui-helper-reset wijmo-wijwizard-steps ui-helper-clearfix").removeAttr("role");if(this.lis){this.lis.removeClass("ui-widget-header ui-corner-all ui-priority-primary ui-priority-secondary").removeAttr("role");this.lis.each(function(){if(a.data(this,"destroy.wijwizard"))a(this).remove();else a(this).removeAttr("aria-selected")})}this.panels.each(function(){var b=a(this).unbind(".wijwizard");a.each(["load","cache"],function(c,a){b.removeData(a+".wijwizard")});if(a.data(this,"destroy.wijwizard"))a(this).remove();else a(this).removeClass(["ui-state-default","wijmo-wijwizard-actived","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","wijmo-wijwizard-panel","ui-widget-content","wijmo-wijwizard-hide"].join(" ")).css({position:"",left:"",top:""}).removeAttr("aria-hidden")});this.container.replaceWith(this.container.contents());b.cookie&&this._cookie(null,b.cookie);return this},add:function(b,f,h){if(b===undefined)b=this.panels.length;if(f===undefined)f="Step "+b;var d=this,g=this.options,c=a(g.panelTemplate||d._defaults.panelTemplate).data("destroy.wijwizard",true),e;c.addClass("wijmo-wijwizard-panel ui-widget-content ui-corner-all wijmo-wijwizard-hide").attr("aria-hidden",true);if(b>=this.panels.length)if(this.panels.length>0)c.insertAfter(this.panels[this.panels.length-1]);else c.appendTo(this.container);else c.insertBefore(this.panels[b]);if(this.list&&this.lis){e=a((g.stepHeaderTemplate||d._defaults.stepHeaderTemplate).replace(/#\{title\}/g,f).replace(/#\{desc\}/g,h));e.addClass("ui-widget-header ui-corner-all ui-priority-secondary").data("destroy.wijwizard",true);if(b>=this.lis.length)e.appendTo(this.list);else e.insertBefore(this.lis[b])}this._pageLize();if(this.panels.length==1){g.activeIndex=0;e.addClass("ui-priority-primary");c.removeClass("wijmo-wijwizard-hide").addClass("wijmo-wijwizard-actived").attr("aria-hidden",false);this.element.queue("wijwizard",function(){d._trigger("show",null,d._ui(d.panels[0]))});this._refreshStep();this.load(0)}this._trigger("add",null,this._ui(this.panels[b]));return this},remove:function(a){var c=this.options,d=this.lis.eq(a).remove(),b=this.panels.eq(a).remove();if(a<c.activeIndex)c.activeIndex--;this._pageLize();b.hasClass("wijmo-wijwizard-actived")&&this.panels.length>=1&&this.show(a+(a<this.panels.length?0:-1));this._trigger("remove",null,this._ui(b[0]));return this},_showPanel:function(f){var b=this,d=this.options,c=a(f);c.addClass("wijmo-wijwizard-actived");if((d.showOption.blind||d.showOption.fade)&&d.showOption.duration>0){var e={duration:d.showOption.duration};if(d.showOption.blind)e.height="toggle";if(d.showOption.fade)e.opacity="toggle";c.hide().removeClass("wijmo-wijwizard-hide").animate(e,d.showOption.duration||"normal",function(){b._resetStyle(c);b._trigger("show",null,b._ui(c[0]));b._removeSpinner();c.attr("aria-hidden",false);b._trigger("activeIndexChanged",null,b._ui(c[0]))})}else{c.removeClass("wijmo-wijwizard-hide").attr("aria-hidden",false);b._trigger("show",null,b._ui(c[0]));b._removeSpinner();b._trigger("activeIndexChanged",null,b._ui(c[0]))}},_hidePanel:function(f){var e=this,b=this.options,c=a(f);c.removeClass("wijmo-wijwizard-actived");if((b.hideOption.blind||b.hideOption.fade)&&b.hideOption.duration>0){var d={duration:b.hideOption.duration};if(b.hideOption.blind)d.height="toggle";if(b.hideOption.fade)d.opacity="toggle";c.animate(d,b.hideOption.duration||"normal",function(){c.addClass("wijmo-wijwizard-hide").attr("aria-hidden",true);e._resetStyle(c);e.element.dequeue("wijwizard")})}else{c.addClass("wijmo-wijwizard-hide").attr("aria-hidden",true);this.element.dequeue("wijwizard")}},show:function(b){if(b<0||b>=this.panels.length)return this;if(this.element.queue("wijwizard").length>0)return this;var g=this,c=this.options,d=a.extend({},this._ui(this.panels[c.activeIndex]));d.nextIndex=b;d.nextPanel=this.panels[b];if(this._trigger("validating",null,d)===false)return this;var e=this.panels.filter(":not(.wijmo-wijwizard-hide)"),f=this.panels.eq(b);c.activeIndex=b;this.abort();c.cookie&&this._cookie(c.activeIndex,c.cookie);this._refreshStep();if(f.length){e.length&&this.element.queue("wijwizard",function(){g._hidePanel(e)});this.element.queue("wijwizard",function(){g._showPanel(f)});this.load(b)}else throw"jQuery UI wijwizard: Mismatching fragment identifier.";return this},next:function(){var b=this.options;if(b.disabled)return false;var a=b.activeIndex+1;if(b.loop)a=a%this.panels.length;if(a<this.panels.length){this.show(a);return true}return false},back:function(){var b=this.options;if(b.disabled)return false;var a=b.activeIndex-1;if(b.loop)a=a<0?this.panels.length-1:a;if(a>=0){this.show(a);return true}return false},load:function(f){var d=this,b=this.options,e=this.panels.eq(f)[0],g=a.data(e,"load.wijwizard");this.abort();if(!g||this.element.queue("wijwizard").length!==0&&a.data(e,"cache.wijwizard")){this.element.dequeue("wijwizard");return}this.element.addClass("ui-state-processing");if(b.spinner){var c=this.element.data("spinner.wijwizard");if(!c){c=a("<div/>");c.addClass("wijmo-wijwizard-spinner");c.html(b.spinner||d._defaults.spinner);c.appendTo(document.body);this.element.data("spinner.wijwizard",c);c.wijpopup({showEffect:"blind",hideEffect:"blind"})}c.wijpopup("show",{of:this.element,my:"center center",at:"center center"})}this.xhr=a.ajax(a.extend({},b.ajaxOptions,{url:g,dataType:"html",success:function(c,g){a(e).html(c);b.cache&&a.data(e,"cache.wijwizard",true);d._trigger("load",null,d._ui(d.panels[f]));try{b.ajaxOptions&&b.ajaxOptions.success&&b.ajaxOptions.success(c,g)}catch(h){}},error:function(a,c){d._trigger("load",null,d._ui(d.panels[f]));try{b.ajaxOptions&&b.ajaxOptions.error&&b.ajaxOptions.error(a,c,f,e)}catch(g){}}}));d.element.dequeue("wijwizard");return this},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("wijwizard",this.element.queue("wijwizard").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._removeSpinner();return this},url:function(a,b){this.panels.eq(a).removeData("cache.wijwizard").data("load.wijwizard",b);return this},count:function(){return this.panels.length}})})(jQuery);
